var suki=module.exports={},node_modules={fs:require("node:fs"),url_utils:require("node:url"),querystring:require("node:querystring"),os:require("node:os"),path:require("node:path")};
(function(f,Y){async function qa(h,q,t,g,b,e,c,a){var d;try{var m=await Deno.open(t);var l=await m.stat()}catch(k){m=l=null}if(d=l&&l.isFile&&l.size){h[1][h[2]]&&(h[1][h[2]]=null);h=t.substr(t.lastIndexOf(".")+1);b=b["if-modified-since"];h=f.mime.types[h]||f.mime.defaultType;b=b&&(new Date(b)).getTime();t="1.1"===g;e=(new Date).toUTCString();c=l.mtime;if(b===c.getTime())q[t?"write":"end"]("HTTP/"+g+" 304 Not Modified\r\nDate: "+e+"\r\nServer: "+f.server+"\r\nCache-Control: max-age=864000\r\nLast-Modified: "+
c.toUTCString()+"\r\nConnection: "+(t?"keep-alive":"close")+"\r\n\r\n");else q.write("HTTP/"+g+" 200\r\nDate: "+e+"\r\nContent-Type: "+h+"\r\nContent-Length: "+l.size+"\r\nAccept-Ranges: none\r\nServer: "+f.server+"\r\nCache-Control: max-age=864000\r\nLast-Modified: "+c.toUTCString()+"\r\nConnection: "+(t?"keep-alive":"close")+"\r\n\r\n").streamFrom(m);return!0}0===d&&m.close();if(a)return h[0](),!0;try{m=await Deno.open(t+e),l=await m.stat()}catch(k){m=l=null}if(d=l&&l.isFile&&l.size)return h[0](m,
l,!1),!0;0===d&&m.close();try{m=await Deno.open(t+c),l=await m.stat()}catch(k){m=l=null}if(d=l&&l.isFile&&l.size)return h[0](m,l,!0),!0;0===d&&m.close();(q=h[1][4][h[2]])&&(q.ck=!1);h[6].error("No such file(1).",404);return!0}async function ra(h,q,t){var g=this[3],b=this[1],e=this[2],c=this[6],a=this[5],d=this[7],m=b[4],l=m[e],k;if(!h)try{h=await Deno.open(e+g),q=await h.stat()}catch(n){h=q=null}if(!t){var p=q&&q.isFile&&q.size?q.mtime.getTime():0;if(l&&p===l.ts[0])return l.ck=!1,l.ts[1]=(new Date).getTime(),
a(l,c),h&&h.close(),!0;if(p){try{await h.read(k=new Uint8Array(q.size)),l=m[e]=this[8](Z.decode(k),d,aa(e+g)),l.ts=[p,(new Date).getTime()],c._r[6]=!1,a(l,c)}catch(n){c.error("Updating script failed(1).",500)}h.close();return!0}}h&&h.close();l=m[e]={cs:b[16]};l.ts=[p,(new Date).getTime()];c._r[6]=!1;c.flush();return!0}async function sa(){var h=this[3],q=this[1],t=this[2],g=this[6],b=this[5],e=this[7],c=q[4],a=c[t];try{var d=await fetch(t+h)}catch(m){return g.error("NCS network error.")}if(h=d.ok&&
(d.headers.get("Last-Modified")||1)||0){if(a&&h===a.ts[0])a.ck=!1,a.ts[1]=(new Date).getTime(),b(a,g);else try{a=c[t]=this[8](await d.text(),e),a.ts=[h,(new Date).getTime()],g._r[6]=!1,b(a,g)}catch(m){g.error("Updating script failed(2).",500)}return!0}this[0]=ha;b=await this[0]();b.fn?(a=c[t]={cs:q[16]},a.ts=[h,(new Date).getTime()],g._r[6]=!1,g.flush()):b.error?g.error("View renderring error.\n"+b.error,500):g.error("View file not exists.",404);return!0}async function ta(h,q){var t=this[1],g=this[6];
h=h||g._r[5];g=t[18];var b,e;try{var c=await Deno.open(h);var a=await c.stat()}catch(m){c=a=null}var d=a&&a.isFile&&a.size?a.mtime.getTime():0;if((b=g[h])&&d===b.mtime)return c.close(),q&&("function"===typeof q?q(b):q[0](b)),b;if(d){b={mtime:d};try{await c.read(e=new Uint8Array(a.size)),b.fn=t[19](Z.decode(e)),g[h]=b}catch(m){b.error=m.stack}}else b={};c&&c.close();q&&("function"===typeof q?q(b):q[0](b));return b}async function ha(h,q){var t=this[1],g=this[6];h=h||g._r[5];var b=t[18];try{var e=await fetch(h.replace("#",
"%23"))}catch(a){return g.error("NCS network error(view).")}var c=e.ok&&(e.headers.get("Last-Modified")||1)||0;if((g=b[h])&&c===g.mtime)return q&&("function"===typeof q?q(g):q[0](g)),!0;if(c){g={mtime:c};try{g.fn=t[19](await e.text()),b[h]=g}catch(a){g.error=a.stack}}else g={};q&&("function"===typeof q?q(g):q[0](g));return!0}function ua(){function h(r,u,v,z){var B=w,F=B[0],y=u[1],E=y.indexOf("?"),I=~E&&y.substr(E+1);y=~E&&y.substr(0,E)||y;E=v.host||"*";var L;if(!(L=B[9][E])){L=E.indexOf(":");var J=
~L&&E.substr(0,L)||E;L=J.substr(0,J.indexOf("."));J=w[9][J]||w[9][J.replace(L,"*")]||w[9]["*"];~J.indexOf("*")&&(J=J.replace(G,L));D===A?(A=0,w[9]={},w[9][E]=J):D>A++&&(w[9][E]=J);L=J}E=L;var M=E.indexOf(" ");L=0===M?"":E.substring(M+1);J=B[15];var K=J.length,U=B[1],O=(new Date).getTime(),N=u[2].substr(5);E=0===M?E.trimLeft():E.substring(0,M);this._args=[u,v,z];if(~y.indexOf("%"))try{y=decodeURIComponent(y)}catch(V){return this._r=C(r,"",N),this.error("Invalid unicode character in URL.",400)}"/"===
y.charAt(y.length-1)&&(y=y+"index"+J);u=y.slice(-K);if(B[2]&&F._defend(F.getIP(v),B[2]))return this._r=C(r,"",N),this.error("Block settings taking effect to prevent insecurity access.",404);K=(u=J===u)?y.substr(0,y.length-K):y;M=E+K;if(I){v.querystring=I;try{var Q=B[5](I,"&")}catch(V){f.log("HTTP QUERYSTRING parsing error: \n"+I+"\n"+V.stack,"e"),Q=B[10]}}if(v.cookie)try{var R=B[5](v.cookie,"; ")}catch(V){f.log("HTTP COOKIE parsing error: \n"+v.cookie+"\n"+V.stack,"e"),R=B[10]}if(z&&fa(z))if(v["content-type"]&&
~v["content-type"].indexOf("application/dns-message"))var P={dns:z};else try{P=Z.decode(z),P="{"===P.charAt(0)||"["===P.charAt(0)?JSON.parse(P):B[5](P)}catch(V){P=z}z=[Q||B[10],R||B[10],P||B[10],v];this._r=[r,"",N,O,K,M+B[1],!0,{suki:F,_server:v,_get:z[0],_post:z[2],_cookie:z[1]},!1,!0,!0,[null,B,M,J,U,q,this,L||E,n]];if(F=B[4][M]){z=F.ts;if(F.ck||B[3]>O-z[1]){q(F,this);return}F.ck=!0}this._r[9]=!1;if("/"===y.slice(-1)||~y.replace("\\","..").indexOf("..")||~y.indexOf(".sjs."))this.error("Please examine the config of WebServer to prevent this issue of security(1).",
404);else if(F=this._r[11],~F[7].indexOf("://")&&(F[7]=""),(z=~E.indexOf("://"))?(E=L,F[0]=sa):F[0]=ra,u)F[0]();else if(B[1]===y.slice(-J.length-5)||B[17]===y.slice(-B[17].length)||B[11].test(y))this.error("Please examine the config of WebServer to prevent this issue of security(2).",404);else if(E)qa(F,r,E+y,N,v,J,U,z);else F[0]()}function q(r,u){var v=u._r[7];r.cs(u,v,v._get,v._post,v._cookie,v._server)}function t(r,u){var v=x;void 0!==this.skid||(this.skid=v[0].id?"-"+v[0].id:"-suki");if(void 0===
r||r)e(this,r,[g,this]);else if(fa(u)){r=this._r;v=x;var z=new Date;var B=r[2];var F="1.1"===B;var y=this.contentType;var E=z.getTime()-r[3];try{r[0].write("HTTP/"+B+" "+this.status+"\r\nDate: "+z.toUTCString()+(r[10]?"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache":"")+"\r\nContent-Type: "+y+(this.hasOwnProperty("charset")?"; charset="+this.charset:"text"===y.substr(0,4)&&"; charset="+this.charset||"")+"\r\nContent-Length: "+u.byteLength+"\r\nServer: "+v[0].server+
r[1]+(this.sendET&&isNaN(E)&&"\r\nX"+this.skid+": N/A"||"\r\nX"+this.skid+": "+E)+(r[6]&&", 1"||", -1")+"\r\nConnection: "+(F?"keep-alive":"close")+"\r\n\r\n",this.encoding),r[0][F&&"write"||"end"](u),this._r=null}catch(I){f.log("Socket Writing Error.\n"+(I.stack||I),"e")}}else b("string"===typeof u?u:u&&String(u)||"",!0,this)}function g(r){var u=this[1];r.fn?b(r,!0,u):u.error("view file not exists.(1)",404)}function b(r,u,v){var z=v._r,B=x,F=new Date;try{var y="string"===typeof r?r:r.fn(z[7])}catch(K){return v.error("[template renderring error]\n"+
(K.stack||K),500)}r=z[2];var E="1.1"===r;if("string"===typeof y){var I=v.contentType;var L=""!==y&&v.eid;var J=v.json;var M=F.getTime()-z[3];L&&"text/javascript"!==I&&(I="text/javascript",J.html=~y.indexOf("\n")?y.replace(B[9],""):y,y='window["'+L+'"]='+JSON.stringify(J)+";");try{z[0][E&&"write"||"end"]("HTTP/"+r+" "+v.status+"\r\nDate: "+F.toUTCString()+(z[10]?"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache":"")+"\r\nContent-Type: "+I+(v.hasOwnProperty("charset")?
"; charset="+v.charset:"text"===I.substr(0,4)&&"; charset="+v.charset||"")+"\r\nContent-Length: "+ba.encode(y).length+"\r\nServer: "+B[0].server+z[1]+(v.sendET&&isNaN(M)&&"\r\nX"+v.skid+": N/A"||"\r\nX"+v.skid+": "+M)+(u&&z[6]&&", 1"||(u?", -1":", -2"))+"\r\nConnection: "+(E?"keep-alive":"close")+"\r\n\r\n"+y,v.encoding),v._r=null}catch(K){console.log("Socket Writing Error.\n"+(K.stack||K))}return v}return v.error("template rendering error",500)}function e(r,u,v){var z=r._r;if(void 0===u)r=z[5];else if("string"===
typeof u)r=~u.indexOf("://")?u:u.isAbs()?ia(z[5],u):z[5].replace(r.tpE,"#"+u+r.tpE);else return v[1].error("Invalid template branch: "+String(u)+", omit or set to {undefined} for main template rendering.");if(k[r]&&z[9])v[0](k[r]);else z=z[11],z[0]=~r.indexOf("://")?ha:ta,z[0](r,v)}function c(r){if(r.error)this[1].error(r.error);else{a:{try{var u=r.fn(this[1]._r[7])}catch(v){r=[void 0,"template rendering error"+(v.stack||v)];break a}r=[u,null]}r[0]?"function"===typeof this[2]?this[2](r[0],this[1]):
this[2][0](r[0],this[1]):this[1].error(r[1])}}function a(){return""}var d=h.prototype,m=ja,l=1E4,k={},p=ka,n;da=h;W=function(r,u){var v=la;r&&("aliasHostHeader"===r?(v.preferAliasHost=!0,v.aliasHostHeader=String(u).trim().toLowerCase()):"checkInterval"===r?l=w[3]=u:"csBuilder"===r?n=u:(d[r]=u,"_f"===r&&(w[2]=u)));return da};d.tpE=f.init[2];d.csE=f.init[3];d.status="200";d.charset="UTF-8";d.encoding="utf8";d.contentType="text/html";d.sendET=d._g=d._f=!1;d.eso="";d.proxy="";d.cacheProxy=d.proxyCache=
"";d.error="";d.proxySendFile=!1;d.sendFileDir="";d.sendFileHeader="X-Accel-Redirect";d.buffer="";d.getTplVals=function(){return this._r[7]};d.setContentType=function(r){this.contentType=r;return this};d.flush=t;d.header=function(r){var u=this._r;u[1]+="\r\n"+r;u[10]&&(~r.indexOf("xpires:")||~r.indexOf("ontrol:"))&&(u[10]=!1);return this};d.redirect=function(r,u){var v=this.eid;this._r[1]+="\r\nLocation: "+(v?r+(~r.indexOf("?")?"&":"?")+"__eso="+v.substr(1):r);this.status=u||"302";return this.flush(!1)};
d.setCookie=function(r){if(this.eid){var u=this.json;var v=u.cookie;r=f.creatCookieHeader(r);v?"string"===typeof v?u.cookie=[v,r]:v.push(r):u.cookie=r}else this._r[1]+="\r\n"+f.creatCookieHeader(r);return this};d.deleteCookie=function(r,u){r="Set-Cookie: "+r+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT"+(u?"; domain="+u:"");var v;this.eid?(u=this.json,(v=u.cookie)?"string"===typeof v?u.cookie=[v,r]:v.push(r):u.cookie=r):this._r[1]+="\r\n"+r;return this};d.deleteCookies=function(r,u){var v="Set-Cookie: "+
r+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT"+(u?"; domain="+u:"");r="Set-Cookie: "+r+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT; path=/"+(u?"; domain="+u:"");var z;this.eid?(u=this.json,(z=u.cookie)?"string"===typeof z?u.cookie=[z,v,r]:z.push(v,r):u.cookie=[v,r]):this._r[1]+="\r\n"+v+"\r\n"+r;return this};d.next=function(){arguments.R=arguments.r=this;return arguments};d.session=function(r,u){var v;if(this.eid)return this;u||=!0===r;(v=this._r[7]._cookie.SJSSESSIONID)?this.session=v:
(v=this.session=f.MD5(this._r[3]+Math.random().toString()),this.setCookie({name:"SJSSESSIONID",value:v,hours:!0!==r&&0<r&&r,secure:u,http:!0}));return this};d.sendFile=function(r,u){var v=this._r,z=new Date,B=v[2],F="1.1"===B;if(!v)return void 0===v?this.error("flush(): invalid 'this'."):this;if(r.isAbs()&&p(r)){u||="application/force-download";if(!~u.indexOf("/")){var y=u;u="application/force-download"}v[0][F&&"write"||"end"]("HTTP/"+B+" 200\r\nDate: "+z.toUTCString()+"\r\nContent-Type: "+u+"\r\nContent-Length: "+
fs.statSync(r).size+("application/force-download"===u?"\r\nContent-Disposition: attachment; filename="+(y||path.basename(r)):"")+"\r\nServer: "+f.server+v[1]+(this.sendET?"\r\nX-SR: "+(z-v[3]):"\r\nX-SR: N/A")+(v[6]?", 1":", -1")+"\r\nConnection: "+(F?"keep-alive":"closed")+"\r\n\r\n",this.encoding);fs.createReadStream(r).pipe(v[0]);this._r=null}else return this.error("No such file : "+r,404);return this};var w=[f,d.tpE,d._f,l,{},ma,null,t,f.init[0],f.init[1],f.nullObj,RegExp("\\.\\.|\\\\|\\/\\/|\\/_suki"),
p,null,RegExp("\\/","g"),d.csE,function(r){r.flush()},f.moduleExtention,k,m],x=Array(9);x[0]=f;x[9]=/[\f\n\r\t\v]/g;d.getFlush=function(r,u){void 0===u?e(this,u,[c,this,r]):e(this,r,[c,this,u]);return this};f.getRender=function(r){try{var u=x[6](r)}catch(v){u=a}return u};f.render=function(r,u){try{var v=u(r)}catch(z){v=""}return v};var A=0,D=3E3,G=RegExp("\\*","g");try{var C=new Function("...a","return a")}catch(r){C=function(){return arguments}}}function va(){function h(a){var d=a.length,m=1,l;this.got=
[!1,null,0,[],0,0,!1];for(this.post={};m<d;m++){var k=a[m].indexOf("\r\n\r\n");if(!~k){this.got[0]=!0;break}var p=a[m].substring(0,k);k=a[m].substr(k+4);this.got[2]++;var n=p.indexOf("name=")+6;var w=p.indexOf('"',n);n=p.substring(n,w);var x=p.indexOf("filename=");w=~x;var A=this.post;(l="[]"===n.slice(-2))&&(n=n.slice(0,-2));if(w){this.got[4]++;var D=p.indexOf('"',x+10);p=p.substring(x+10,D);p={name:p,size:k.length-2,error:!1,purge:t};p.tmpName=path.normalize(c+"/sukijs_"+n+"."+f.random(10)+"."+
(new Date).getTime());c&&k?(p._fs=fs.createWriteStream(p.tmpName,e),q(p,this.got),this.got[3].push(p._fs),"\r\n"===k.slice(-2)?(k=k.slice(0,-2),p._fs.end(k,"binary")):p._fs.write(k,"binary")):(p.tmpName="",p.error=!0);k=p}else k=k.slice(0,-2),k=65537>k.length&&this.binaryToUTF8(k)||"";l?(A[n]||(A[n]=[]),A[n].push(k)):A[n]=k;m===d-1&&(this.last=[n,w])}}function q(a,d){setTimeout(function(){a._finished?fs.unlink(a.tmpName,b):(a.error=!0,a.tmpName="",a.size=0,a._fs.end())},3E4);a._fs.on("error",function(){a.error||
(a.error=!0,a.tmpName="",a.size=0,a._fs.end())});a._fs.on("finish",function(){a._finished=!0;a.error&&(d[6]=!0,fs.unlink(a.tmpName,b));++d[5]===d[4]&&d[0]&&(d[3].length=0,d[1]&&d[1](),d.length=0)})}function t(){fs.unlink(this.tmpName,b)}var g=na={},b=f.nullFunc,e={mode:438,flag:"r+"},c=f.init[4];g.initPost=function(a,d,m,l,k,p,n,w){var x=Number(k["content-length"]),A=k["content-type"]||"",D;A=(0===A.indexOf("application/x-www-form-urlencoded")||0===A.indexOf("application/json")||0===A.indexOf("application/dns-message"))&&
0<x||"multipart/form-data"===A.substr(0,19)&&(D=A.split("="))&&2===D.length&&D[1];p=w-(p.length||0);n=n-p-4;p=-1<n&&d.slice(p+4);n=x===n;if(A&&x)if(!0===A&&n)a._b=0,new m(a,l,k,p);else if(n){var G=new h(d.toString("binary").split("--"+A));a._b=0;G.got[1]=function(){new m(a,l,k,G.post)}}else a.raw=p,a._p=[l,k],D?(a.maxUploadSize=104857600,a.__b=A,a._b=65537):a._b=x;else a._b=-1,a.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : Not support for This so called 'HTTP-POST'..."),f.log("Net socket denied.(Not support for This so called 'HTTP-POST'...)",
"n")};g.post=function(a,d,m,l){var k=a.raw,p=k.length,n=f.creatBuffer(d.length+p);if(void 0!==k.length&&0<l&&65537>l)k.copy(n,0,0),d.copy(n,p,0),l===n.length?(a._b=0,new m(a,a._p[0],a._p[1],n)):a.raw=n;else if(65537===l)g._upload(a,d,m);else{a.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : BAD POSTING REQUEST.");try{d.length=0,a.destroy()}catch{}}};g._upload=function(a,d,m){var l=a._uploader;if(l)if(100<l.got[2]||a._uploaderL>a.maxUploadSize)a._b=-1,a.end("HTTP POST too Large!"),l.got[1]=null,console.log("HTTP POST too Large!\nForbidden for ever on this actived socket.");
else{var k=d.toString("binary");l.add(k.split("--"+a.__b),d);l.got[0]?(a._b=0,a._uploader=null,l.got[4]?l.got[1]=function(){new m(a,a._p[0],a._p[1],l.post)}:new m(a,a._p[0],a._p[1],l.post)):a._uploaderL+=d.length}else{var p=a.raw;var n=p.length;k=f.creatBuffer(d.length+n);p.copy(k,0,0);d.copy(k,n,0);d=a.__b;p=k.toString("binary");l=new h(p.split("--"+d));l.got[0]?(a._b=0,l.got[4]?l.got[1]=function(){new m(a,a._p[0],a._p[1],l.post)}:new m(a,a._p[0],a._p[1],l.post)):(a._uploaderL=k.length,a._uploader=
l)}};h.prototype.add=function(a,d){var m=a.length,l=this.last[0],k;if(1<m){if(this.last[1]&&a[0]){var p=this.post[l];Array.isArray(p)&&(p=p[p.length-1]);p.size+=a[0].length;c&&("\r\n"===a[0].slice(-2)&&(a[0]=a[0].slice(0,-2)),p._fs.end(a[0],"binary"))}for(l=1;l<m;l++){d=a[l].indexOf("\r\n\r\n");if(!~d){this.got[0]=!0;break}p=a[l].substring(0,d);d=a[l].substr(d+4);this.got[2]++;var n=p.indexOf("name=")+6;var w=p.indexOf('"',n);n=p.substring(n,w);var x=p.indexOf("filename=");w=~x;var A=this.post;(k=
"[]"===n.slice(-2))&&(n=n.slice(0,-2));if(w){this.got[4]++;var D=p.indexOf('"',x+10);p=p.substring(x+10,D);p={name:p,size:d.length-2,error:!1,purge:t};p.tmpName=path.normalize(c+"/sukijs_"+n+"."+f.random(10)+"."+(new Date).getTime());c&&d?(p._fs=fs.createWriteStream(p.tmpName,e),q(p,this.got),this.got[3].push(p._fs),"\r\n"===d.slice(-2)?(d=d.slice(0,-2),p._fs.end(d,"binary")):p._fs.write(d,"binary")):(p.tmpName="",p.error=!0);d=p}else d=d.slice(0,-2),d=65537>d.length&&this.binaryToUTF8(d)||"";k?(A[n]||
(A[n]=[]),A[n].push(d)):A[n]=d;l===m-1&&(this.last=[n,w])}}else p=this.post[l],this.last[1]?(Array.isArray(p)&&(p=p[p.length-1]),p.size+=d.length,c&&p._fs.write(d)):(a=p+a[0],this.post[l]=65537>a.length&&this.binaryToUTF8(a)||"")};h.prototype.binaryToUTF8=f.binaryToUTF8}function wa(){var h=la={},q={GET:!0,POST:!0};oa=function(t,g){var b=g._b,e=1,c=da,a=na,d,m;if(Number(b))a.post(g,t,c,b);else{var l=t.length;var k=(b||"")+Z.decode(t);var p=k.indexOf("\r\n\r\n");var n=k.substring(0,4).trim();var w=
f.rewriteRules;if(q[n])if(~p){var x=k.substring(0,p).trim();var A=ba.encode(x).length;var D=x.length===A;var G=x.split("\r\n");var C=G.length;if((m=1<C&&G[0].trim().split(" "))&&3===m.length){for(k={};e<C;e++){var r=G[e];var u=r.indexOf(":");if(~u)k[r.substring(0,u).trim().toLowerCase()]=r.substring(u+1).trim();else{k=null;break}}h.preferAliasHost&&k[h.aliasHostHeader]&&(k["x-real-host"]=k.host)&&(k.host=k[h.aliasHostHeader]);w&&(m[1]=f.rewriteURL(m[1]))}else k=null;k&&D||k.referer&&x.length-k.referer.length===
A-(d=ba.encode(k.referer).length)?(k["remote-addr"]=g.remoteAddr,k.url=m[1],k.method=n,d&&d!==k.referer.length&&(k.referer=encodeURIComponent(k.referer)),"GET"===n?(g._b=0,new c(g,m,k,null)):a.initPost(g,t,c,m,k,b,l,p)):_reInit(g,k&&m[2],k&&m[1],!D)}else 8192<k.length?(g._b=-1,g.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : HTTP header too long! limited "+k.length+"."),console.log("HTTP header too long!"+k.length+"\nForbidden for ever on this actived socket.")):g._b=k;else g._b=-1,g.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : Not support for this method.\r\nSituation is logged."),
console.log("\r\nNot support for this method ("+n+").\r\n"+g.remoteAddr.hostname+"\r\n",k)}}}function xa(){var h=f.less,q=h?new h.Parser:!1,t={};h=b=>{t[b]=!0};var g=[/[\s;]*$/,/\/\*.*?\*\/|'[^']*'|"[^"]*"|\.[\$\w]+/g,/[^\$\w\d]+/,/^\d/,/[\f\n\r\t\v]/g,/<(script.*?>)([\s\S]*?)<\/(script)/gi,RegExp("\x3c!--.*?--\x3e","g"),/(`\{|\{)[\s]*?\[[\s]*?#[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})(.*)(\1)[\s]*?\[[\s]*?\/[\s]*?(\2)[\s]*?\][\s]*?(\3)/g,/(`\{|\{)[\s]*?\[[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})/g,/\\'/g,/s\+='s\+=/g,
/(`\{|\{)[\s]*?\[[\s]*?(\.|this)[\s]*?\][\s]*?(\}`|\})/g,/(`\{|\{)[\s]*?\[[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})/g,/<(style[^>]+?less|style)(.*?)<\/style>/gi,/\/\/.*/g,RegExp("\\/\\*[\\s\\S]*?\\*\\/","g"),function(b,e,c,a){b=g;c=c.replace(b[19],"</scri_pt>>").replace(b[20],"<<scri_pt>");return"<"+e+c.replace(b[24],":\\/\\/").replace(b[14],"").replace(b[15],"").replace(b[25],b[28])+"</"+a},function(b,e,c,a){var d=c.indexOf(">");b=g;c=c.replace(g[23],"");if(q&&~e.toLowerCase().indexOf("less")&&~d){var m=
c.substr(d+1);e=e.replace(" less","");q.parse(m,function(l,k){c=c.substr(0,d)+">"+(l?m:k.toCSS({compress:!0}))})}return"<"+e+c.replace(b[25],b[28])+"</style>"},function(b,e,c,a,d){return"';var i=0,l=o."+c+".length,d=o."+c+";for(;i<l;i++){s+='"+d.replace(g[11],"'+d[i]+'").replace(g[12],"'+(d[i]['$1']||('undefined'===typeof $1?'':$1))+'")+"'}s+='"},RegExp("\x3c!--","g"),RegExp("--\x3e","g"),/<\/scri_pt>>/g,/<<scri_pt>/g,RegExp("\\/\\*.*?\\*\\/","g"),RegExp(":\\/\\/","g"),/([^\\])\\([^\\])/g,/<style|<less/i,
/<script/i,function(b,e,c){return e+"\\\\"+c},/^[a-zA-Z0-9_$]+$/,/s\+='';/g,/^[\s]*?=[\s]*?/];"Math JSON encodeURI encodeURIComponent decodeURI decodeURIComponent escape unescape eval isNaN isFinite parseInt parseFloat null undefined NaN Infinity Object Array Function Boolean String Number Date RegExp Error".split(" ").forEach(h);"break case catch continue debugger default delete do else false finally for function if in instanceof new return switch this throw true try typeof var void while with const".split(" ").forEach(h);
"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile arguments let yield".split(" ").forEach(h);ja=function(b){b=b.replace(/\\/g,"\\\\");var e={},c="",a=g,d=function(l){if(l&&!t[l]&&!a[3].test(l)&&!e[l]){if("s"===l||"o"===l)throw"There must not be '"+l+"' in template as it is taken internally.";e[l]=!0;c+=","+l+"=o."+l+"||(0===o."+l+"?'0':'')"}},
m=a[27].exec(b);(m&&=b.indexOf(m[0]))&&(b=b.substr(0,m)+b.substr(m).replace(a[5],a[16]));b=b.replace(a[4],"");(m=a[26].exec(b))&&(m=b.indexOf(m[0]))&&(b=b.substr(0,m)+b.substr(m).replace(a[13],a[17]));m=b.indexOf("\x3c!--");~m&&(b=b.substr(0,m)+b.substr(m).replace(a[6],"").replace(a[21],"\x3c!--").replace(a[22],"<<scri_pt>"));b=b.split("'").join("\\'").replace(a[7],a[18]).replace(a[8],function(l,k,p){k=p.replace(a[9],"'");k=k.trim();l="="===k.charAt(0)||a[29].test(k)?"';s+="+k.replace(a[31],"").replace(a[0],
"")+";s+='":"';"+k+";s+='";k=k.replace(a[1],"");k.split(a[2]).forEach(d);return l})+"';return s;";b="var s=''"+c+";"+("s+='"+b).replace(a[10],"s+=");return new Function("o",b.replace(a[30],""))}}function ya(){var h={500:["500 Internal Server Error","Current service is temporarily unavailable."],502:["502 Bad gateway","Networking is temporarily unavailable."],503:["503 Service Unavailable","Server is busy, pleas try again later."],400:["400 Bad Request","Invalid HTTP request."],403:["403 Forbidden",
"Access Denied."],404:["404 Not Found","The requested URL is not found on this server."]};da.prototype.error=function(q,t){var g=this._r;if(g&&g.length){this.status=t||"500";this.contentType="text/html";t=this.flush;q=String(q||"");var b=String(this.status),e=h[b];q=e&&"<!DOCTYPE HTML><html><head><title>"+(e&&e[0]||b)+'</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><style>html, body{margin:0 16px;padding:0;font-family:Varela Round,Helvetica,Arial,sans-serif;font-size:16px;line-height:26px}body{background:#fff;color:#222}h1{color:#205080;font-size:20px;font-weight:100;letter-spacing:0.2ex;text-shadow:#d0e0ea 0 1px;line-height:40px;border-bottom:2px solid #c0d0e0}h1:before{content:"";content:"\\203a\\2002"}div{font-size:12px;background:#cccccc;padding:5px;padding-left:10px}</style></head><body><h1>'+
(e&&e[0]||b)+"</h1><p>"+(e&&e[1]||"")+"</p><div><p><strong>Detail:</strong></p><p>"+q.replace("<","&lt;").replace(">","&gt;").replace(/\n|\r\n/g,"<br>")+"</p><div></body></html>"||q;t.call(this,null,q);g.length=0}else q=String(q).replace(/<br>/gi,"\r\n"),f.log("a sync error occured after REST.flush() SO it would not display on webpage: \r\n"+q,"c");return this}}var ca=class{static parse=null;static listen(h,q){ca._connLoop(Deno.listen({port:h,hostname:q,transport:"tcp"}))}static async _connLoop(h){for await(let q of h)ca._packetLoop(q)}static async _packetLoop(h){var q=
new za(h);for await(let t of h.readable)ca.parse(t,q)}};var za=class{_sock=null;_textEncoder=ba;remoteAddr="";_b=0;constructor(h){this._sock=h;this.remoteAddr=h.remoteAddr.hostname}write(h){"string"===typeof h?this._sock.write(this._textEncoder.encode(h)):this._sock.write(h);return this}async end(h){h&&await ("string"===typeof h?this._sock.write(this._textEncoder.encode(h)):this._sock.write(h));this._sock.close()}streamFrom(h){h.readable.pipeTo(this._sock.writable,{preventClose:!0})}};var aa,ka,ma,
fa,ia,Z,ba,pa,T;!async function(){if("undefined"===typeof require){var h=(await MODULE).createRequire;T=h(IMU)}else T=require;h=Y.fs;var q=Y.url_utils,t=Y.querystring,g=Y.os;aa=Y.path.normalize;ka=h.existsSync;ma=t.parse;ia=q.resolve;pa=g.tmpdir();fa=ArrayBuffer.isView;Z=new TextDecoder;ba=new TextEncoder;!0;"function"===typeof f.init&&f.init()}();f.MIME=f.mime={types:{html:"text/html",htm:"text/html",shtml:"text/html",css:"text/css",xml:"text/xml",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",
js:"application/javascript",atom:"application/atom+xml",rss:"application/rss+xml",mml:"text/mathml",txt:"text/plain",jad:"text/vnd.sun.j2me.app-descriptor",wml:"text/vnd.wap.wml",htc:"text/x-component",png:"image/png",tif:"image/tiff",tiff:"image/tiff",wbmp:"image/vnd.wap.wbmp",ico:"image/x-icon",jng:"image/x-jng",bmp:"image/x-ms-bmp",svg:"image/svg+xml",svgz:"image/svg+xml",webp:"image/webp",woff:"application/font-woff",jar:"application/java-archive",war:"application/java-archive",ear:"application/java-archive",
json:"application/json",hqx:"application/mac-binhex40",doc:"application/msword",pdf:"application/pdf",ps:"application/postscript",eps:"application/postscript",ai:"application/postscript",rtf:"application/rtf",m3u8:"application/vnd.apple.mpegurl",xls:"application/vnd.ms-excel",eot:"application/vnd.ms-fontobject",ppt:"application/vnd.ms-powerpoint",wmlc:"application/vnd.wap.wmlc",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz","7z":"application/x-7z-compressed",cco:"application/x-cocoa",
jardiff:"application/x-java-archive-diff",jnlp:"application/x-java-jnlp-file",run:"application/x-makeself",pl:"application/x-perl",pm:"application/x-perl",prc:"application/x-pilot",pdb:"application/x-pilot",rar:"application/x-rar-compressed",rpm:"application/x-redhat-package-manager",sea:"application/x-sea",swf:"application/x-shockwave-flash",sit:"application/x-stuffit",tcl:"application/x-tcl",tk:"application/x-tcl",der:"application/x-x509-ca-cert",pem:"application/x-x509-ca-cert",crt:"application/x-x509-ca-cert",
xpi:"application/x-xpinstall",xhtml:"application/xhtml+xml",xspf:"application/xspf+xml",zip:"application/zip",msi:"application/octet-stream",msp:"application/octet-stream",msm:"application/octet-stream",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",mid:"audio/midi",midi:"audio/midi",kar:"audio/midi",mp3:"audio/mpeg",
ogg:"audio/ogg",m4a:"audio/x-m4a",ra:"audio/x-realaudio","3gpp":"video/3gpp","3gp":"video/3gpp",ts:"video/mp2t",mp4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",mov:"video/quicktime",webm:"video/webm",flv:"video/x-flv",m4v:"video/x-m4v",mng:"video/x-mng",asx:"video/x-ms-asf",asf:"video/x-ms-asf",wmv:"video/x-ms-wmv",avi:"video/x-msvideo"},defaultType:"application/octet-stream"};var da,W,na,oa,la,ja;f.server="suki";f.extention=".sjs";f.moduleExtention=".sjs.js";f.nullObj=Object.freeze({});f.nullFunc=
function(){}.bind(f.nullObj);f.platform=Y.os.platform();f.strlen=Buffer.byteLength;f.isLinux="linux"===f.platform;f.isWindows="win"===f.platform.substring(0,3);(function(){function h(n){n=n||{};var w=Number(n.ports||n.port),x=w&&"port"||"",A=f.root=n.webRoot?t(n.webRoot):{"*":"*"},D=f.extention+".html",G;var C=0;var r=[!1,["127.0.0.1","10.8.*.*"]];if(c)return a.log("Duplicated initialization ignored."),this;c=!0;f.version||(f.version="");f.password="public-defualt-8NJzmhSCpQutF7EY6E6WdxrRy9txtN93";
f.salt="8NJzmhSCpQutF7EY6E6WdxrRy9txtN93";C=Math.floor(Number(C));f.timeZoneString=-12<C&&12>C?("+0"+String(C)).replace("0-","-0").replace("00","0").replace("010","10").replace("011","11").replace("+-","-")+":00":"+00:00";f.timeZoneOffset=0<C<12?3600*C||0:0;if(x&&null===f.root)f.log("Invalid webRoot config.","e");else{f.unlocked=!0;f._locker=0;if(!A["*"]){C=Object.keys(A)[0];var u=A[C];if(u)A["*"]=u,a.log("no [*] sets, specify "+u+" (which hosts "+C+") as default webRoot.");else return f.log("Invalid config on webRoot.",
"c"),this}f.init=["",A,D,f.extention,n.tmp&&aa(n.tmp)||pa,null];f.tmpdir=f.init[4];f.logfile=f.init[5]=n.logfile&&path.normalize(n.logfile)||null;for(v of Aa)v();r[0]&&f.nextTick(function(){f.allow(r[1]);a.log("built-in firewall initialized;")});for(G of Ba)G();va();wa();xa();ua();ya();W("sendET",!0);W("csBuilder",g);n._sendFileDir&&W("sendFileDir",n._sendFileDir);n._sendFileHeader&&W("sendFileHeader",n._sendFileHeader);n._proxySendFile&&W("proxySendFile",n._proxySendFile);var v=n._hotCodeDelaySeconds;
"number"===typeof v&&(Infinity===v||/^[0-9]+$/.test(v.toString()))&&W("checkInterval",1E3*v);n._aliasHostHeader&&W("aliasHostHeader",n._aliasHostHeader);f.version||(f.version="suki.js_v11.0.20");"port"===x&&(ca.listen(w,n.bind||"::"),ca.parse=oa,f.log(f.dateFormat(new Date)+" UTC\ndeno_v"+Deno.version.deno.replace("v","")+"\n"+f.version+" Javascript Application Server (HTTP listening on "+(n.bind||"::")+":"+w+")  \r\n"));return q}}function q(n){n(f)}function t(n){function w(G){var C="",r="",u="undefined"===
typeof fetch;Array.isArray(G)&&("string"===typeof G[0]&&(C=G[0]),"string"===typeof G[1]&&(r=G[1]));"string"===typeof G&&(C=G);if("http://"===C.substring(0,7)||"https://"===C.substring(0,8)){if(u)return f.log("Invalid remote webRoot: "+C+" (runtime has no fetch api so networking webRoot could not be used)","e"),null;"/"===C.slice(-1)&&(C=C.slice(0,-1));if(~C.indexOf(" "))return f.log("Invalid remote webRoot: "+C,"e"),null;r&&=aa(r);return C+" "+r}if(C)return C=aa(C)," "+C;f.log("Invalid webRoot: "+
C,"e");return null}var x=n,A,D=!0;if("string"===typeof n||Array.isArray(n))x={"*":n};for(A in x)x[A]=w(x[A]),D&&x[A]&&(D=!1);return D?null:x}function g(n,w,x){n=n.trim();var A={},D=l[0].test(n),G={app:function(F){return F&&"string"===typeof F?this.app=f._setAC(F,{_name:F}):null}},C=/\\/g;x="var __filename='"+(x||"").replace(C,"\\\\")+"',__dirname='"+(w||"").replace(C,"\\\\")+"';";var r;try{if(D){var u=n.match(l[1]);var v=u.length;var z=u.join("").replace(l[2],"");for(r=0;r<v;r++)n=n.replace(u[r],
"");var B=x+"try{"+z+"\n}catch(e){return function (R){return R.error('CS AREA A HAS AN ERROR.\\n'+(e.stack||e),'500');};}return "+m+"function (R,tplVals,_get,_post,_cookie,_server){if(!suki.unlocked){return R.error('Server is too busy due to [Critical Error: uncaughtException(see logs)].','500.13');}try{"+n+"\n}catch(e){R.error('CS AREA B HAS AN ERRROR.\\n'+(e.stack||e),500)};};"}else B=x+"return "+m+"function (R,tplVals,_get,_post,_cookie,_server){if(!suki.unlocked){return R.error('Server is too busy due to [Critical Error: uncaughtException(see logs)].','500.13');}try{"+
n+"\n}catch(e){return R.error('CS AREA B HAS AN ERROR.\\n'+(e.stack||e),500);}};";A.cs=(new d("require,suki",B)).bind(G)(b(w),f)}catch(F){A.cs=function(y){y.error("["+f.extention.substring(1)+" init error] "+(F.stack||F),500)}}return A}function b(n){function w(x){var A=!String(x).isAbs()&&!~x.indexOf("node:")&&(~x.indexOf("/")||~x.indexOf("\\"));return e(A?n+"/"+x:x,T)||e(n+"/"+x,T)}w.cache=T.cache;w.extensions=T.extensions;w.resolve=function(x){var A=!String(x).isAbs()&&!~x.indexOf("node:")&&(~x.indexOf("/")||
~x.indexOf("\\"));try{var D=T.resolve(A?n+"/"+x:x)}catch(G){D=""}return D||T.resolve(n+"/"+x)};return w}function e(n,w){w||=T;try{var x=w(n)}catch(A){if(n.isAbs()||~n.indexOf("node:"))f.log("'libExists()' Pre Loading Failed: "+n,"w"),console.log(A.stack||A)}return x}var c=!1,a={log:function(n){console.log(n)}},d=Object.getPrototypeOf(function(){}).constructor,m="async ";try{new d("(async function(){})")}catch(n){m=""}var l=[RegExp("\\/\\/\\<\\!\\-\\-([\\s\\S]*?)\\/\\/\\-\\-\\>"),RegExp("\\/\\/\\<\\!\\-\\-[\\s\\S]*?\\/\\/\\-\\-\\>",
"g"),RegExp("\\/\\/\\<\\!\\-\\-|\\/\\/\\-\\-\\>","g")],k,p=[];f.init=function(n){var w;void 0===k&&(k=n||{});setTimeout(function(){if(T&&k){h(k);k=null;for(w of p)w(f);p.length=0}},0);return function(x){"function"===typeof x&&p.push(x)}}})();(function(){String.prototype.isAbs=function(){return"/"===this.charAt(0)||"\\"===this.charAt(0)||":"===this.charAt(1)};String.prototype.toContextString=function(){return JSON.stringify([this]).slice(1,-1)};var h=function(q){return"\\"+q};String.prototype.escapeMarkdown=
function(q){var t="[\\.\\`\\*\\_\\{\\}\\[\\]\\<\\>\\(\\)\\#\\+\\-\\!\\|\\\\]",g;if(q){q=q.split("");var b=q.length;for(g=0;g<b;g++)t=t.replace("\\"+q[g],"")}return this.replace(new RegExp(t,"g"),h)}})();(function(){function h(c,a,d){var m=a.replace(/set-cookie/g,"Set-Cookie"),l=encodeURIComponent(c)+"=",k=m.indexOf(l);if(~k){k+=l.length;var p=m.indexOf(";",k);~p||(p=m.length);a=m.substr(p);if(~a.indexOf(l))return h(c,a);try{var n=decodeURIComponent(m.substring(k,p))}catch{return}if(!0===d){p=m.indexOf("Set-Cookie",
k);p=~p?p:m.length;a=m.substring(k+n.length,p);c={name:c,value:n};d=a.split(";");n=d.length;for(a=0;a<n;a++)m=d[a].trim(),""!==m&&(l=m.indexOf("="),~l?c[m.substr(0,l)]=m.substr(l+1):c[m]=!0);return c}return n}}function q(c,a){return"~"+a.toUpperCase()+":"}function t(c,a){return"object"===typeof c?a?c:JSON.stringify(c,g,"\t"):"^"+typeof c+":\\{: "+String(c)}function g(c,a){return t(a,Array.isArray(a)?"^array:\\{: ":"^"+typeof a+":\\{: ")}f.objectToArray=function(c){return Array.prototype.slice.call(c,
0)};f.next=new Function("...a","return a");var b=[/\\|%5c/gi,/&(?!\w+;)/g,/</g,/>/g,/"/g,/'/g,/%26/g,/%3c/gi,/%3e/gi,/&#37;22/g,/%/g];f.clean=function(c){if(!c)return 0===c?"0":"";c=String(c).replace(b[0],"").replace(b[1],"&amp;").replace(b[2],"&lt;").replace(b[3],"&gt;").replace(b[4],"&quot;").replace(b[5],"&#39;");try{var a=decodeURIComponent(c)}catch{return c.replace(b[0],"&#37;5C").replace(b[6],"&#37;26").replace(b[7],"&#37;3C").replace(b[8],"&#37;3E").replace(b[9],"&#37;22")}return c===a?c:c.replace(b[10],
"&#37;")};f.passAgentHeaders=function(c){return{accept:"text/html, application/xhtml+xml, */*","accept-language":"zh-CN,zh;q=0.8,en;q=0.6","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87."+(c?Math.random().toFixed(4):"2883")+".87 Safari/537.36","cache-control":"max-age=0",dnt:"1",connection:"keep-alive"}};f.randomArray=function(c,a,d){return c instanceof Array?(a=a&&d?Math.floor(Math.random()*(d-a+1)+a):Math.floor(Math.random()*c.length),c[a]):
null};f.parseCookieHeader=h;f.creatCookieHeader=function(c){var a,d=c.hours;(a=c.expires)?a="; expires="+a:d&&(a=new Date,a.setTime(a.getTime()+Math.floor(36E5*d)),a=a.toUTCString(),a="; expires="+a);return"Set-Cookie: "+c.name+"="+encodeURIComponent(c.value)+(a||"")+(c.domain&&"; domain="+c.domain||"")+(c.path&&"; path="+c.path||"")+(c.secure&&"; secure"||"")+(c.http&&"; HttpOnly"||"")};f.getIP=function(c,a){var d;if("object"!==typeof c)return"";switch(a){case "real":return c["x-real-ip"]||c["remote-addr"]||
"";case "user":return a=(c["x-forwarded-for"]||"").split(","),(d=a.length)?a[d-1].trim():c["remote-addr"]||"";case "proxy":return a=(c["x-forwarded-for"]||"").split(","),a[0]?a[0].trim():c["remote-addr"]||"";default:return c["remote-addr"]||""}};f.log=function(c,a){switch(a){case "n":f.logfile?f.writeMore(f.logfile,"\r\n[NOTE]"+c+"\r\n"):console.log("\r\n[NOTE]"+c+"\r\n");break;case "w":f.logfile?f.writeMore(f.logfile,"\r\n[WARN]"+c+"\r\n"):console.log("\r\n[WARN]"+c+"\r\n");break;case "e":f.logfile?
f.writeMore(f.logfile,"\r\n[ERRO]"+c+"\r\n"):console.log("\r\n[ERRO]"+c+"\r\n");break;case "c":f.logfile?f.writeMore(f.logfile,"\r\n[CRIT]"+c+"\r\n"):console.log("\r\n[CRIT]"+c+"\r\n");break;default:f.logfile?f.writeMore(f.logfile,"\r\n"+c+"\r\n"):console.log("\r\n"+c+"\r\n")}};var e=[/: "\^([a-z]+):\\\\{:/g,/"(,?)$/gm];f.obj2str=function(c){try{var a="object"===typeof c?t(c).replace(e[0],q).replace(e[1],"$1"):"^"+(typeof c).toUpperCase()+": "+String(c)}catch{return util.inspect(c)}return a};f.parseJSON=
function(c,a){try{return JSON.parse(c)}catch{return a||null}};f.signature=function(c,a){var d=(c=String(c)).substr(0,c.indexOf("."));a=a||"";if(64===d.length){var m=c.substr(65);return d===f.sha256(m+f.salt+a)?c:f.sha256(c+f.salt+a)+"."+c}return f.sha256(c+f.salt+a)+"."+c};f.rewriteURL=function(c){var a=0,d=f.rewriteRules,m=d.length,l=c.indexOf("?"),k=~l?c.substr(l+1):"";for(k&&(c=c.substr(0,l));a<m;a++)if(l=d[a],l=c.replace(l[0],l[1]),l!==c)return l.substr(1)+(k?(~l.indexOf("?")?"&":"?")+k:"");return k?
c+"?"+k:c}})();(function(){var h=require("node:fs"),q=require("node:dns");f.dnsTTL=3E5;f.dnsCache={_length:0};f.dnsHosts={};f.dnsInitHosts=function(t){t=Array.isArray(t)?t:h.readFileSync(t).toString("utf8").replace(/[\r\t]/g," ").replace(/[ ]+/g," ").split("\n");var g=t.length,b=0,e,c,a;if(0<g)for(e=this.dnsHosts={};b<g;b++)if((c=t[b].trim())&&"#"!==c.charAt(0)){c=c.replace(/[ ]+?#.*/g,"").split(" ");var d=c.length;if(1<d)for(a=1;a<d;a++)e[c[a]]=c[0]}return this};f.dnsPurgeCache=function(){this.dnsCache=
{_length:0};return this};f.dnsLookup4=function(t,g){var b=this.dnsCache,e=this.dnsHosts,c="object"===typeof g;1E3<b._length&&this.dnsPurgeCache();if(e=e[t]||e["*"])if(c)g[0](e);else g(e);else if((e=b[t])&&this.dnsTTL>(new Date).getTime()-e[1])if(c)g[0](e);else g(e);else q.resolve4(t,function(a,d){a?a=t:(a=d[0],b._length++,b[t]=[a,(new Date).getTime()]);if(c)g[0](a);else g(a)})}})();(function(){var h={};f.getAC=function(q){return h[q]||null};f.setAC=function(q,t){return"_"===q.charAt(0)?null:h[q]||
(h[q]=t)};f._setAC=function(q,t){return h["_"+q]||(h["_"+q]=t)};f.resetAC=function(q,t){return h[q]=t}})();(function(){f.isAllowed=function(h,q,t,g){q=Array.isArray(q)?q:String(q).split(",");return q[h]||q[h.substr(0,h.indexOf(".",4))+".*.*"]||q[h.substr(0,h.lastIndexOf("."))+".*"]||q[h.substr(0,h.indexOf("."))+".*.*.*"]?!1:t&&!!t.error(g||"Only valid agent can access.",404)||!0};f._defend=function(h,q){return q[h]||q[h.substr(0,h.indexOf(".",4))+".*.*"]||q[h.substr(0,h.lastIndexOf("."))+".*"]||q[h.substr(0,
h.indexOf("."))+".*.*.*"]?!1:!0};f.allow=function(h){if(_unblocked){var q={};h=Array.isArray(h)?h:String(h).split(",");h.forEach(t=>q[t]=!0);_unblocked=!1;REST.config("_f",q)}};f.unblock=function(){_unblocked=!0;REST.config("_f",!1)}})();(function(){var h=f.nullFunc,q=f.isWindows,t=f.isLinux||q,g={},b=require("node:child_process");f.shell=g;g.deamon=t?function(e,c,a){var d=e.cmd||e,m=Array.isArray(d)?d:q?String(d).split(" "):["sh","-c",String(d)],l=m.shift(),k=e.cwd?b.spawn(l,m,{cwd:e.cwd}):b.spawn(l,
m),p=(e="boolean"==typeof c)?c:!1,n=e?a||5E3:"number"==typeof c?c:5E3,w=this,x=function(){this.resume&&(this.resume=h);k=b.spawn(l,m);k.on("exit",A);k.on("error",h)},A=function(D){0==D||p&&setTimeout(x,n)};k.on("exit",A);k.on("error",h);return{stop:function(D){p=!1;w.kill(k);D||(this.stop=this.pause=this.resume=k=x=A=null)},pause:function(){this.stop(!0);this.resume=x}}}:h;g.exec=t?function(e,c,a){var d=e.cmd||e;d=Array.isArray(d)?d:q?String(d).split(" "):["sh","-c",String(d)];var m=e.cwd?b.spawn(d.shift(),
d,{cwd:e.cwd}):b.spawn(d.shift(),d),l=this,k,p,n,w,x;a||=c;c=Number(c)||9E4;if(p=(k="object"===typeof a)||"function"===typeof a){var A=w="";e=function(G){x=!0;w+=G?G.toString("utf8"):"shell.exec error(no msg)"};m.stdout.on("data",function(G){A+=G.toString("utf8")});m.stderr.on("data",e);m.on("error",e)}if(c){m.on("exit",function(G){if(!n){x||=0!=G;if(k)a[0](A||void 0,x?w:void 0);else p&&a(A||void 0,x?w:void 0);clearTimeout(D)}});var D=setTimeout(function(){if(!n){if(k)a[0](A||void 0,x?w+"[TIMEOUT("+
c+"ms)]":"[TIMEOUT("+c+"ms)]");else p&&a(A||void 0,x?w+"[TIMEOUT("+c+"ms)]":"[TIMEOUT("+c+"ms)]");l.kill(m);n=!0}},c)}}:h;g.kill=t?function(e){var c="object"===typeof e?e.pid:"number"===typeof e&&e;q?b.spawn("taskkill",["/f","/t",c?"/pid":"/im",c||e]):b.spawn(c&&"kill"||"pkill",c?["-9",c]:[e])}:h})();var Aa=[function(){try{f.sync=new Function("object","methed","next","return (...args)=>new Promise((resolve,reject)=>{var callback=(r,e,E)=>e&&undefined===r?reject(E||e):resolve(r);next&&(next.callback=callback);return 'string'===typeof methed?object[methed](...args,next?undefined:callback):(methed?methed.call(object,...args,next?undefined:callback):object(...args,next?undefined:callback))})"),
f.sync.mute=new Function("object","methed","next","return (...args)=>new Promise(resolve=>{var callback=r=>resolve(r);next&&(next.callback=callback);return 'string'===typeof methed?object[methed](...args,next?undefined:callback):(methed?methed.call(object,...args,next?undefined:callback):object(...args,next?undefined:callback))})")}catch(h){f.sync=null}},function(){var h=f.timeZoneOffset,q=f.timeZoneString,t=/[+\-][0-9]{2}:00$/;f.time=function(){return Math.floor((new Date).getTime()/1E3)+h};f.GMT=
f.UTC=function(g){return void 0===g||-12<g&&12>g?Math.floor((new Date).getTime()/1E3)+3600*(g||0):Date.parse(t.test(String(g).trimRight())?g:g+q)/1E3||0};f.getGMT=f.getUTC=function(g){var b=new Date;g&&b.setTime(b.getTime()+1E3*(Number(g)||0));return b.toUTCString()};f.dateFormat=function(g,b){g||="{YYYY}-{MM}-{dd} {hh}:{mm}:{ss}";b||"string"!==typeof g?("object"===typeof g||(g=new Date(1E3*g)),b||="{YYYY}-{MM}-{dd} {hh}:{mm}:{ss}"):(b=g,g=new Date,g.setTime(g.getTime()+1E3*h));return b.replace("{YYYY}",
g.getUTCFullYear()).replace("{MM}",g.getUTCMonth()+1).replace("{dd}",g.getUTCDate()).replace("{hh}",("0"+g.getUTCHours()).slice(-2)).replace("{mm}",("0"+g.getUTCMinutes()).slice(-2)).replace("{ss}",("0"+g.getUTCSeconds()).slice(-2))};f.timePassed=function(g,b){var e=b?new Date(Number(g+"000")):new Date;g=Math.floor(e.getTime()/1E3)-(b||g);b=Math.floor(g/3600);return 1>b?Math.floor(g/60)+"\u5206\u949f\u524d":24>b?b+"\u5c0f\u65f6\u524d":168>b?(e=60*(60*e.getHours()+e.getMinutes())+e.getSeconds()-(g-
86400*Math.floor(g/86400)),e=Math.floor((g+(0>e?86400+e:e))/86400),1===e?"\u6628\u5929":2===e?"\u524d\u5929":e+"\u5929\u524d"):5040>b?Math.floor(g/604800)+"\u5468\u524d":61320>b?Math.floor(g/2592E3)+"\u4e2a\u6708\u524d":b?Math.floor(g/31536E3)+"\u5e74\u524d":"\u65e5\u671f\u4e0d\u8be6"};f.calendar="".calendar;f.richCalendar="".richCalendar},function(){function h(b){var e=this._q;if(1>this._pendingTaskLength){this.dismiss(b);var c=e.length;if(0<c){for(b=0;b<c;b++)this.dismiss(e[b]);e.length=0;clearTimeout(this.tid)}}else e.push(b),
c=e.length,1===c?this.tid=setTimeout(g,this.patience,this):e.length>this.max&&this.expel(b)}function q(b){var e=this._pendingTask[b];this._pendingTaskLength++;e||(this._pendingTask[b]=!0);return e}function t(b){var e;this._pendingTask[b]=!1;if(1>--this._pendingTaskLength){b=this._q;var c=b.length;for(e=0;e<c;e++)this.dismiss(b[e]);b.length=0;clearTimeout(this.tid)}}function g(b){for(var e=0,c=b._q,a=b._q.length;e<a;e++)b.expel(c[e]);c.length=0}f.queue=function(){return{_q:[],_tid:0,_pendingTaskLength:0,
_pendingTask:{},max:10,patience:3E4,moreTask:q,lessTask:t,add:h,dismiss:f.nullFunc,expel:f.nullFunc}}},function(){function h(g){for(var b="",e=q;0<g;)b=e[g%62]+b,g=Math.floor(g/62);return b||String(g)}var q="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),t=[,48,29,87];f.int62=h.encode=h;h.decode=function(g){for(var b=String(g),e=0,c=0,a=b.charCodeAt(0);a;)e=62*e+a-t[a>>5],a=b.charCodeAt(++c);return g?e||NaN:NaN}},function(){var h=/MSIE ([^;]+)/;f.isSmartBrowser=function(b){return h.test("object"===
typeof b?b["user-agent"]:b)?10>Number(RegExp.$1):!0};var q=/mobile|android|ucweb|fennec|iphone|blackberry|symbian|windows phone/i;f.isPhone=function(b){return q.test("object"===typeof b?b["user-agent"]:b)};f.long2ip=function(b){b=Number(b);return 12>String(b).length&&Math.floor(b)===b&&0<b?(b>>24&255)+"."+(b>>16&255)+"."+(b>>8&255)+"."+(b&255):""};var t=/^[0-9]+$/;f.ip2long=function(b){b=String(b).split(".").filter(Boolean);return 4===b.length&&t.test(b.join(""))&&0<b[0]&&-1<b[1]&&-1<b[2]&&-1<b[3]&&
256>b[0]&&256>b[1]&&256>b[2]&&256>b[3]?16777216*b[0]+65536*b[1]+256*b[2]+Number(b[3]):0};f.isIp4InCidrs=function(b,e){var c=f.ip2long;return Array.isArray(e)&&e.length&&e.some(function(a){var d=a.indexOf("/"),m=~(Math.pow(2,32-a.substr(d+1))-1);return~d?(c(b)&m)===(c(a.substr(0,d))&m):!1})||!1};f.ip4internals=[["10.0.0.0/8","172.16.0.0/12","192.168.0.0/16"],"0.0.0.0/8 100.64.0.0/10 127.0.0.0/8 169.254.0.0/16 192.0.0.0/24 192.0.2.0/24 198.18.0.0/15 198.51.100.0/24 203.0.113.0/24 255.255.255.255/32".split(" ")];
f.forInArray=function(b,e){var c=b.length;b=Math.floor(c/8);var a=c%8;c=0;if(0<a)for(;0<a;a--)e(c++);for(a=b;0<a;a--)e(c++),e(c++),e(c++),e(c++),e(c++),e(c++),e(c++),e(c++)};var g=[/^\S+@(\S+)$/,/^(?:[A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/];f.isEmail=function(b){var e=String(b).trim();return b===e&&255>b.length&&g[0].test(b)&&g[1].test(RegExp.$1)};f.random=function(b,e){var c="",a=Math.random;if(!b)return"";for(;;){var d=a().toString(36).substr(2);if(c.length+d.length>b){c+=d.substr(0,b-c.length);break}c+=
d}if(e){e=Math.round;for(var m="",l=0;l<b;l++)d=c.charAt(l),m+=isNaN(Number(d))&&(e(a())?d.toUpperCase():d.toLowerCase())||d;return m}return c};f.hot=function(b){return{h:{},l:0,c:Number(b)||500,cache:function(e,c){var a;if(void 0===c||void 0===e)return e?this.h[e]:void 0;if(this.l>this.c){var d={};var m=0;for(a in this.h)void 0===this.h[a]||++m&&(d[a]=this.h[a]);if(m===this.c)return;this.h=d;this.l=m}this.h[e]||this.l++;return this.h[e]=c},delete:function(e){return e&&(this.h[e]=void 0)}}}}];var Ba=
[function(){var h=f.nullFunc,q=require("node:fs"),t=require("node:buffer").Buffer;f.write=function(g,b,e,c){c?q.writeFile(g,"string"===typeof b?t.from(b,c):b,function(a){var d="object"===typeof e;try{if(d)e[0](a?!1:!0,a);else e(a?!1:!0,a)}catch(m){(a=d&&e.r)?a.error("[file-callback-func-crit]\n"+(m.stack||m),500):f.log("[file-callback-func-crit]\n"+(m.stack||m))}}):e?"object"===typeof e&&e[0]?q.writeFile(g,"string"===typeof b?t.from(b):b,function(a){try{e[0](a?!1:!0,a)}catch(d){e.r?e.r.error("[file-callback-func-crit]\n"+
(d.stack||d),500):f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):"function"===typeof e?q.writeFile(g,"string"===typeof b?t.from(b):b,function(a){try{e(a?!1:!0,a)}catch(d){f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):q.writeFile(g,"string"===typeof b?t.from(b,e):b,h):q.writeFile(g,"string"===typeof b?t.from(b):b,h)};f.read=function(g,b,e){q.readFile(g,function(c,a){var d="object"===typeof b;try{if(d)b[0](c?void 0:e?a.toString(e):a,c);else b(c?void 0:e?a.toString(e):a,c)}catch(m){(c=d&&
b.r)&&c.error("[file-callback-func-crit]\n"+(m.stack||m),500)}})};f.writeMore=function(g,b,e,c){c?q.appendFile(g,"string"===typeof b?t.from(b,c):b,function(a){var d="object"===typeof e;try{if(d)e[0](a?!1:!0,a);else e(a?!1:!0,a)}catch(m){(a=d&&e.r)?a.error("[file-callback-func-crit]\n"+(m.stack||m),500):f.log("[file-callback-func-crit]\n"+(m.stack||m))}}):e?"object"===typeof e&&e[0]?q.appendFile(g,"string"===typeof b?t.from(b):b,function(a){try{e[0](a?!1:!0,a)}catch(d){e.r?e.r.error("[file-callback-func-crit]\n"+
(d.stack||d),500):f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):"function"===typeof e?q.appendFile(g,"string"===typeof b?t.from(b):b,function(a){try{e(a?!1:!0,a)}catch(d){f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):q.appendFile(g,"string"===typeof b?t.from(b,e):b,h):q.appendFile(g,"string"===typeof b?t.from(b):b,h)};f.delete=function(g,b){q.unlink(g,function(e){var c="object"===typeof b;try{if(c)b[0](e?!1:!0,e);else"function"===typeof b&&b(e?!1:!0,e)}catch(a){(e=c&&b.r)?e.error("[file-callback-func-crit]\n"+
(a.stack||a),500):f.log("[file-callback-func-crit]\n"+(a.stack||a))}})}},function(){function h(d,m,l,k){var p=!1,n,w,x,A;if(this[0]===h){var D=this[1];D.hostname=d;d=D;m=this[2];l=this[3];k=this[4]}D="https"===d.protocol.substr(0,5)?g:t;var G=(A=m&&"function"===typeof m[0])||"function"===typeof m;var C=d.host;var r=C.indexOf(":");C=~r?C.substr(0,r):C;d.path||(d.path=d.pathname+(d.search||""));d.host=d.hostname;d.hostname=C;G?(r="object"===typeof l,k||!r&&(k=l),l=r&&l||f.passAgentHeaders()):l="object"===
typeof m&&m||f.passAgentHeaders();G&&"identity"!==l["accept-encoding"]&&(l["accept-encoding"]="gzip, deflate");l.host||(l.host=C);d.headers=l;d=D.request(d,function(y){var E=y;if(n)if(z)if(200!=y.statusCode)z(404);else{E=n;var I=w;var L=x,J=L[2],M="1.1"===J,K=y.headers,U=I.hasOwnProperty("charset"),O=K["content-type"].split(";"),N=K["content-length"],Q=(new Date).toUTCString();I._mtime=f.UTC(Q);I.hasOwnProperty("contentType")||(I.contentType=O[0].trim());!U&&O[1]&&(I.charset=O[1].trim());I.hasOwnProperty("status")||
(I.status=200);try{E.write("HTTP/"+J+" "+I.status+"\r\nDate: "+Q+"\r\nContent-Type: "+I.contentType+(U?"; charset="+I.charset:"")+(N?"\r\nContent-Length: "+K["content-length"]:"")+"\r\nAccept-Ranges: none\r\nCache-Control: max-age=864000\r\nExpires: "+f.getGMT(864E3)+"\r\nLast-Modified: "+Q+"\r\nServer: "+f.server+L[1]+"\r\nConnection: "+(M&&"keep-alive"||"close")+"\r\n\r\n")}catch(R){console.log("suki.get: proxyCache error\n"+(R.stack||R))}z("length",Number(y.headers["content-length"]));y.on("data",
B);y.on("end",z)}else q(y,n,w,x),y.on("data",B);else G&&("gzip"===y.headers["content-encoding"]?(I=e.createGunzip(),I.on("error",u),y.pipe(I),y=I):"deflate"===y.headers["content-encoding"]&&(I=e.createInflate(),I.on("error",u),y.pipe(I),y=I),k&&y.setEncoding(k),y.on("data",B)),z&&(z.res=E,y.on("end",z))});var u=function(y){var E;if(p)n&&(z?(z(404),console.log(y)):(y=w,y._r=x,y.error("proxy: destination network unreachable.",404)));else try{if(A)m[0](void 0,y.stack||y);else m(void 0,y.stack||y)}catch(I){(E=
A&&m.r)?E.error("[get-_callback-func-crit]\n"+(I.stack||I),500):f.log("[get-_callback-func-crit]\n"+(I.stack||I),"e")}p=!0};d.on("error",u);if(G){var v="";var z=function(){if(!p){var y=z.res;y[200==y.statusCode?"data":"errorData"]=v;try{if(A)m[0](y);else m(y)}catch(E){(y=A&&m.r)?y.error("[get-_callback-func-crit]\n"+(E.stack||E),500):f.log("[get-_callback-func-crit]\n"+(E.stack||E),"e")}}p=!0};var B=function(y){"string"===typeof y?v+=y:v=v?a.concat([v,y]):y}}else{var F=function(y){n=y._r[0];w=y;x=
y._r;B=F.ed;y._file&&(z=F.ee);return!0};p=!0}d.end();return F}function q(d,m,l,k){var p=k[2],n="1.1"===p,w=d.headers,x=l.hasOwnProperty("charset"),A=w["content-type"].split(";"),D=w["content-length"],G=!D,C=w["set-cookie"],r=w.location,u=w["content-encoding"],v=w["cache-control:"],z=w.etag,B=w.expires;l.hasOwnProperty("contentType")||(l.contentType=A[0].trim());!x&&A[1]&&(l.charset=A[1].trim());l.hasOwnProperty("status")||(l.status=d.statusCode);if(G)d.on("end",function(){m.end()});try{m.write("HTTP/"+
p+" "+l.status+"\r\nDate: "+(w.date||(new Date).toUTCString())+"\r\nContent-Type: "+l.contentType+(x?"; charset="+l.charset:"")+(G?"":"\r\nContent-Length: "+D)+(r?"\r\nLocation: "+r:"")+(u?"\r\nContent-Encoding: "+u:"")+(C?"\r\nSet-Cookie: "+(Array.isArray(C)?C.join(""):C):"")+(v||"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache")+(z?z:"")+(B?B:"")+"\r\nServer: "+(w.server||f.server)+k[1]+"\r\nConnection: "+(n&&"keep-alive"||"close")+"\r\n\r\n")}catch(F){console.log("suki.get: proxy error\n"+
(F.stack||F))}}var t=require("node:http"),g=require("node:https"),b=require("node:url"),e=require("node:zlib"),c,a=require("node:buffer").Buffer;t.globalAgent&&(t.globalAgent.maxSockets=g.globalAgent.maxSockets=Infinity,g.globalAgent.options.rejectUnauthorized=!1);f.get=c=function(d,m,l,k){var p=b.parse(d);d=String(p.hostname||p.host&&p.host.split(":")[0]||"");var n,w;if(!d)throw"suki.get: invalid hostname";if(/^[0-9.]+$/.test(d)||~d.indexOf("["))return h(p,m,l,k);if((w=(n=f.dnsCache[d])&&n[0])&&
f.dnsTTL>(new Date).getTime()-n[1])return p.hostname=w,h(p,m,l,k);m=f.next(h,p,m,l,k);f.dnsLookup4(d,m);return m};c.async=function(d,m,l){c(d,l,m)}},function(){function h(k,p,n,w,x){this[0]===h&&(p=this[1],p.hostname=k,k=p,p=this[2],n=this[3],w=this[4],x=this[5]);p||="__=";var A="https"===k.protocol.substr(0,5),D=n&&"function"===typeof n[0],G=D||"function"===typeof n;A=A?g:t;var C=!1,r="object"===typeof p,u=r&&"------WebKitFormBoundary"+f.random(16),v=u?u+"--\r\n":"",z=k.host;var B=z.indexOf(":");
z=~B?z.substr(0,B):z;k.path||(k.path=k.pathname+(k.search||""));k.host=k.hostname;k.hostname=z;G?(B="object"===typeof w,x||!B&&(x=w),w=B&&w||f.passAgentHeaders()):w="object"===typeof n&&n||f.passAgentHeaders();w["content-type"]=r?"multipart/form-data; boundary="+u.substr(2):"{"===p.charAt(0)||"["===p.charAt(0)?"application/json":"application/x-www-form-urlencoded";w.host||(w.host=z);if(r){var F="",y=0,E=[],I=[];B=null;var L=0,J,M=function(H){"isBuffer"===H?K.write(E[L]):E[L].unpipe(K);++L<E.length?
(K.write("\r\n"+I[L]),l.isBuffer(E[L])?M("isBuffer"):E[L].pipe(K,a)):K.end("\r\n"+v)};for(J in p)z=p[J],"string"===typeof z?F+=u+'\r\nContent-Disposition: form-data; name="'+J+'"\r\n\r\n'+z+"\r\n":Array.isArray(z)?F+=u+'\r\nContent-Disposition: form-data; name="'+J+'[]"\r\n\r\n'+z.join("\r\n"+u+'\r\nContent-Disposition: form-data; name="'+J+'[]"\r\n\r\n')+"\r\n":"object"===typeof z&&(l.isBuffer(z.raw)?(E.push(z.raw),B=u+'\r\nContent-Disposition: form-data; name="'+J+'"; filename="'+(z.name||J)+'"\r\n\r\n',
I.push(B),y+=l.byteLength(B)+z.raw.byteLength+1):z.tmp_name&&(B=b.createReadStream(z.tmp_name,d),B.on("end",M),E.push(B),B=u+'\r\nContent-Disposition: form-data; name="'+J+'"; filename="'+(z.name||J)+'"\r\n\r\n',I.push(B),y+=l.byteLength(B)+z.size+1));y+=l.byteLength(F)+v.length}w["content-length"]=r?y:l.byteLength(p);G&&"identity"!==w["accept-encoding"]&&(w["accept-encoding"]="gzip, deflate");k.headers=w;k.method="POST";var K=A.request(k,function(H){var S=H;if(R)N?N(404):(q(H,R,P,V),H.on("data",
Q));else{if(G){if("gzip"===H.headers["content-encoding"]){var X=c.createGunzip();X.on("error",U);H.pipe(X);H=X}else"deflate"===H.headers["content-encoding"]&&(X=c.createInflate(),X.on("error",U),H.pipe(X),H=X);x&&H.setEncoding(x);H.on("data",Q)}N&&(N.res=S,H.on("end",N))}});var U=function(H){if(C)R&&(N?N(404):(H=P,H._r=V,H.error("proxy: destination network unreachable.",404)));else try{if(D)n[0](void 0,H.stack||H);else n(void 0,H.stack||H)}catch(S){(H=D&&n.r)?H.error("[post-_callback-func-crit]\n"+
(S.stack||S),500):f.log("[post-_callback-func-crit]\n"+(S.stack||S),"e")}C=!0};K.on("error",U);if(G){var O="";var N=function(){if(!C){var H=N.res;H[200==H.statusCode?"data":"errorData"]=O;try{if(D)n[0](H);else n(H)}catch(S){(H=D&&n.r)?H.error("[post-_callback-func-crit]\n"+(S.stack||S),500):f.log("[post-_callback-func-crit]\n"+(S.stack||S),"e")}}C=!0};var Q=function(H){"string"===typeof H?O+=H:O=O?l.concat([O,H]):H}}else{var R,P,V,ea=function(H){H._file?(H=ea,Q=H.ed,N=H.ee,R=!0):(R=H._r[0],P=H,V=
H._r,Q=ea.ed);return!0};C=!0}if(r)return K.write(F),E.length?(K.write(I[0]),l.isBuffer(E[0])?M("isBuffer"):E[0].pipe(K,a)):K.end(v),ea;K.write(p);K.end();return ea}function q(k,p,n,w){var x=w[2],A="1.1"===x,D=k.headers,G=n.hasOwnProperty("charset"),C=D["content-type"].split(";"),r=D["content-length"],u=!r,v=D["set-cookie"],z=D.location,B=D["content-encoding"];n.hasOwnProperty("contentType")||(n.contentType=C[0].trim());!G&&C[1]&&(n.charset=C[1].trim());n.hasOwnProperty("status")||(n.status=k.statusCode);
if(!n._file){if(u)k.on("end",function(){p.end()});try{p.write("HTTP/"+x+" "+n.status+"\r\nDate: "+(D.date||(new Date).toUTCString())+"\r\nContent-Type: "+n.contentType+(G?"; charset="+n.charset:"")+(u?"":"\r\nContent-Length: "+r)+(z?"\r\nLocation: "+z:"")+(B?"\r\nContent-Encoding: "+B:"")+(v?"\r\nSet-Cookie: "+(Array.isArray(v)?v.join(""):v):"")+"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache\r\nServer: "+(D.server||"Node.js")+w[1]+"\r\nConnection: "+(A&&
"keep-alive"||"close")+"\r\n\r\n")}catch(F){console.log("suki.get: proxy error\n"+(F.stack||F))}}}var t=require("node:http"),g=require("node:https"),b=require("node:fs"),e=require("node:url"),c=require("node:zlib"),a={end:!1},d={flags:"r",encoding:null,fd:null,mode:438},m,l=require("node:buffer").Buffer;t.globalAgent&&(t.globalAgent.maxSockets=g.globalAgent.maxSockets=Infinity,g.globalAgent.options.rejectUnauthorized=!1);f.post=m=function(k,p,n,w,x){var A=e.parse(k);k=String(A.hostname||A.host&&A.host.split(":")[0]||
"");var D,G;if(!k)throw"suki.get: invalid hostname";if(/^[0-9.]+$/.test(k)||~k.indexOf("["))return h(A,p,n,w,x);if((G=(D=f.dnsCache[k])&&D[0])&&f.dnsTTL>(new Date).getTime()-D[1])return A.hostname=G,h(A,p,n,w,x);if(k)return p=f.next(h,A,p,n,w,x),f.dnsLookup4(k,p),p};m.async=function(k,p,n,w){m(k,p,w,n)}},function(){f.binaryToHex=function(h){var q=h.length,t="",g=0;try{if(8<q){var b=Math.floor(q/8);var e=q%8;var c=0;if(0<e)for(;0<e;e--)t+=("0"+h.charCodeAt(c++).toString(16)).slice(-2);for(;0<b;b--)t+=
("0"+h.charCodeAt(c).toString(16)).slice(-2)+("0"+h.charCodeAt(c+1).toString(16)).slice(-2)+("0"+h.charCodeAt(c+2).toString(16)).slice(-2)+("0"+h.charCodeAt(c+3).toString(16)).slice(-2)+("0"+h.charCodeAt(c+4).toString(16)).slice(-2)+("0"+h.charCodeAt(c+5).toString(16)).slice(-2)+("0"+h.charCodeAt(c+6).toString(16)).slice(-2)+("0"+h.charCodeAt(c+7).toString(16)).slice(-2),c+=8}else for(;g<q;g++)t+=("0"+h.charCodeAt(g).toString(16)).slice(-2);return t}catch{}}},function(){f.binaryToUTF8=function(h){var q=
"",t=0,g=0,b=h.length,e=String.fromCharCode,c=0;try{for(;c<b;++c){var a=h.charCodeAt(c);128==(a&192)?0<g&&(t=t<<6|a&63,--g):(0==g&&(q+=e(t)),128>a?(t=a,g=0):192==(a&224)?(t=a&31,g=1):224==(a&240)?(t=a&15,g=2):240==(a&248)&&(t=a&7,g=3))}0==g&&(q+=e(t));return q.substring(1)}catch{}}},function(){f.bufferToBinary=function(h){h=h.length;var q="",t=String.fromCharCode,g=0;try{if(8<h){var b=Math.floor(h/8);var e=h%8;var c=0;if(0<e)for(;0<e;e--)q+=t(data[c++]);for(;0<b;b--)q+=t(data[c],data[c+1],data[c+
2],data[c+3],data[c+4],data[c+5],data[c+6],data[c+7]),c+=8}else for(;g<h;g++)q+=t(data[g]);return q}catch{}}}]})(suki,node_modules);
