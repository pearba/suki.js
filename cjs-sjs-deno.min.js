var suki=module.exports={},node_modules={fs:require("node:fs"),url_utils:require("node:url"),querystring:require("node:querystring"),os:require("node:os"),path:require("node:path")};
(function(f,Y){async function qa(h,p,t,g,b,e,c,a){var d;try{var q=await Deno.open(t);var l=await q.stat()}catch(k){q=l=null}if(d=l&&l.isFile&&l.size){h[1][h[2]]&&(h[1][h[2]]=null);h=t.substr(t.lastIndexOf(".")+1);b=b["if-modified-since"];h=f.mime.types[h]||f.mime.defaultType;b=b&&(new Date(b)).getTime();t="1.1"===g;e=(new Date).toUTCString();c=l.mtime;if(b===c.getTime())p[t?"write":"end"]("HTTP/"+g+" 304 Not Modified\r\nDate: "+e+"\r\nServer: "+f.server+"\r\nCache-Control: max-age=864000\r\nLast-Modified: "+
c.toUTCString()+"\r\nConnection: "+(t?"keep-alive":"close")+"\r\n\r\n");else p.write("HTTP/"+g+" 200\r\nDate: "+e+"\r\nContent-Type: "+h+"\r\nContent-Length: "+l.size+"\r\nAccept-Ranges: none\r\nServer: "+f.server+"\r\nCache-Control: max-age=864000\r\nLast-Modified: "+c.toUTCString()+"\r\nConnection: "+(t?"keep-alive":"close")+"\r\n\r\n").streamFrom(q);return!0}0===d&&q.close();if(a)return h[0](),!0;try{q=await Deno.open(t+e),l=await q.stat()}catch(k){q=l=null}if(d=l&&l.isFile&&l.size)return h[0](q,
l,!1),!0;0===d&&q.close();try{q=await Deno.open(t+c),l=await q.stat()}catch(k){q=l=null}if(d=l&&l.isFile&&l.size)return h[0](q,l,!0),!0;0===d&&q.close();(p=h[1][4][h[2]])&&(p.ck=!1);h[6].error("No such file(1).",404);return!0}async function ra(h,p,t){var g=this[3],b=this[1],e=this[2],c=this[6],a=this[5],d=this[7],q=b[4],l=q[e],k;if(!h)try{h=await Deno.open(e+g),p=await h.stat()}catch(m){h=p=null}if(!t){var n=p&&p.isFile&&p.size?p.mtime.getTime():0;if(l&&n===l.ts[0])return l.ck=!1,l.ts[1]=(new Date).getTime(),
a(l,c),h&&h.close(),!0;if(n){try{await h.read(k=new Uint8Array(p.size)),l=q[e]=this[8](Z.decode(k),d,aa(e+g)),l.ts=[n,(new Date).getTime()],c._r[6]=!1,a(l,c)}catch(m){c.error("Updating script failed(1).",500)}h.close();return!0}}h&&h.close();l=q[e]={cs:b[16]};l.ts=[n,(new Date).getTime()];c._r[6]=!1;c.flush();return!0}async function sa(){var h=this[3],p=this[1],t=this[2],g=this[6],b=this[5],e=this[7],c=p[4],a=c[t];try{var d=await fetch(t+h)}catch(q){return g.error("NCS network error.")}if(h=d.ok&&
(d.headers.get("Last-Modified")||1)||0){if(a&&h===a.ts[0])a.ck=!1,a.ts[1]=(new Date).getTime(),b(a,g);else try{a=c[t]=this[8](await d.text(),e),a.ts=[h,(new Date).getTime()],g._r[6]=!1,b(a,g)}catch(q){g.error("Updating script failed(2).",500)}return!0}this[0]=ha;b=await this[0]();b.fn?(a=c[t]={cs:p[16]},a.ts=[h,(new Date).getTime()],g._r[6]=!1,g.flush()):b.error?g.error("View renderring error.\n"+b.error,500):g.error("View file not exists.",404);return!0}async function ta(h,p){var t=this[1],g=this[6];
h=h||g._r[5];g=t[18];var b,e;try{var c=await Deno.open(h);var a=await c.stat()}catch(q){c=a=null}var d=a&&a.isFile&&a.size?a.mtime.getTime():0;if((b=g[h])&&d===b.mtime)return c.close(),p&&("function"===typeof p?p(b):p[0](b)),b;if(d){b={mtime:d};try{await c.read(e=new Uint8Array(a.size)),b.fn=t[19](Z.decode(e)),g[h]=b}catch(q){b.error=q.stack}}else b={};c&&c.close();p&&("function"===typeof p?p(b):p[0](b));return b}async function ha(h,p){var t=this[1],g=this[6];h=h||g._r[5];var b=t[18];try{var e=await fetch(h.replace("#",
"%23"))}catch(a){return g.error("NCS network error(view).")}var c=e.ok&&(e.headers.get("Last-Modified")||1)||0;if((g=b[h])&&c===g.mtime)return p&&("function"===typeof p?p(g):p[0](g)),!0;if(c){g={mtime:c};try{g.fn=t[19](await e.text()),b[h]=g}catch(a){g.error=a.stack}}else g={};p&&("function"===typeof p?p(g):p[0](g));return!0}function ua(){function h(r,u,v,z){var B=w,F=B[0],y=u[1],E=y.indexOf("?"),I=~E&&y.substr(E+1);y=~E&&y.substr(0,E)||y;E=v.host||"*";var L;if(!(L=B[9][E])){L=E.indexOf(":");var J=
~L&&E.substr(0,L)||E;L=J.substr(0,J.indexOf("."));J=w[9][J]||w[9][J.replace(L,"*")]||w[9]["*"];~J.indexOf("*")&&(J=J.replace(G,L));D===A?(A=0,w[9]={},w[9][E]=J):D>A++&&(w[9][E]=J);L=J}E=L;var M=E.indexOf(" ");L=0===M?"":E.substring(M+1);J=B[15];var K=J.length,U=B[1],O=(new Date).getTime(),N=u[2].substr(5);E=0===M?E.trimLeft():E.substring(0,M);this._args=[u,v,z];if(~y.indexOf("%"))try{y=decodeURIComponent(y)}catch(V){return this._r=C(r,"",N),this.error("Invalid unicode character in URL.",400)}"/"===
y.charAt(y.length-1)&&(y=y+"index"+J);u=y.slice(-K);if(B[2]&&F._defend(F.getIP(v),B[2]))return this._r=C(r,"",N),this.error("Block settings taking effect to prevent insecurity access.",404);K=(u=J===u)?y.substr(0,y.length-K):y;M=E+K;if(I){v.querystring=I;try{var Q=B[5](I,"&")}catch(V){f.log("HTTP QUERYSTRING parsing error: \n"+I+"\n"+V.stack,"e"),Q=B[10]}}if(v.cookie)try{var R=B[5](v.cookie,"; ")}catch(V){f.log("HTTP COOKIE parsing error: \n"+v.cookie+"\n"+V.stack,"e"),R=B[10]}if(z&&fa(z))if(v["content-type"]&&
~v["content-type"].indexOf("application/dns-message"))var P={dns:z};else try{P=Z.decode(z),P="{"===P.charAt(0)||"["===P.charAt(0)?JSON.parse(P):B[5](P)}catch(V){P=z}z=[Q||B[10],R||B[10],P||B[10],v];this._r=[r,"",N,O,K,M+B[1],!0,{suki:F,_server:v,_get:z[0],_post:z[2],_cookie:z[1]},!1,!0,!0,[null,B,M,J,U,p,this,L||E,m]];if(F=B[4][M]){z=F.ts;if(F.ck||B[3]>O-z[1]){p(F,this);return}F.ck=!0}this._r[9]=!1;if("/"===y.slice(-1)||~y.replace("\\","..").indexOf("..")||~y.indexOf(".sjs."))this.error("Please examine the config of WebServer to prevent this issue of security(1).",
404);else if(F=this._r[11],~F[7].indexOf("://")&&(F[7]=""),(z=~E.indexOf("://"))?(E=L,F[0]=sa):F[0]=ra,u)F[0]();else if(B[1]===y.slice(-J.length-5)||B[17]===y.slice(-B[17].length)||B[11].test(y))this.error("Please examine the config of WebServer to prevent this issue of security(2).",404);else if(E)qa(F,r,E+y,N,v,J,U,z);else F[0]()}function p(r,u){var v=u._r[7];r.cs(u,v,v._get,v._post,v._cookie,v._server)}function t(r,u){var v=x;void 0!==this.skid||(this.skid=v[0].id?"-"+v[0].id:"-suki");if(void 0===
r||r)e(this,r,[g,this]);else if(fa(u)){r=this._r;v=x;var z=new Date;var B=r[2];var F="1.1"===B;var y=this.contentType;var E=z.getTime()-r[3];try{r[0].write("HTTP/"+B+" "+this.status+"\r\nDate: "+z.toUTCString()+(r[10]?"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache":"")+"\r\nContent-Type: "+y+(this.hasOwnProperty("charset")?"; charset="+this.charset:"text"===y.substr(0,4)&&"; charset="+this.charset||"")+"\r\nContent-Length: "+u.byteLength+"\r\nServer: "+v[0].server+
r[1]+(this.sendET&&isNaN(E)&&"\r\nX"+this.skid+": N/A"||"\r\nX"+this.skid+": "+E)+(r[6]&&", 1"||", -1")+"\r\nConnection: "+(F?"keep-alive":"close")+"\r\n\r\n",this.encoding),r[0][F&&"write"||"end"](u),this._r=null}catch(I){f.log("Socket Writing Error.\n"+(I.stack||I),"e")}}else b("string"===typeof u?u:u&&String(u)||"",!0,this)}function g(r){var u=this[1];r.fn?b(r,!0,u):u.error("view file not exists.(1)",404)}function b(r,u,v){var z=v._r,B=x,F=new Date;try{var y="string"===typeof r?r:r.fn(z[7])}catch(K){return v.error("[template renderring error]\n"+
(K.stack||K),500)}r=z[2];var E="1.1"===r;if("string"===typeof y){var I=v.contentType;var L=""!==y&&v.eid;var J=v.json;var M=F.getTime()-z[3];L&&"text/javascript"!==I&&(I="text/javascript",J.html=~y.indexOf("\n")?y.replace(B[9],""):y,y='window["'+L+'"]='+JSON.stringify(J)+";");try{z[0][E&&"write"||"end"]("HTTP/"+r+" "+v.status+"\r\nDate: "+F.toUTCString()+(z[10]?"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache":"")+"\r\nContent-Type: "+I+(v.hasOwnProperty("charset")?
"; charset="+v.charset:"text"===I.substr(0,4)&&"; charset="+v.charset||"")+"\r\nContent-Length: "+ba.encode(y).length+"\r\nServer: "+B[0].server+z[1]+(v.sendET&&isNaN(M)&&"\r\nX"+v.skid+": N/A"||"\r\nX"+v.skid+": "+M)+(u&&z[6]&&", 1"||(u?", -1":", -2"))+"\r\nConnection: "+(E?"keep-alive":"close")+"\r\n\r\n"+y,v.encoding),v._r=null}catch(K){console.log("Socket Writing Error.\n"+(K.stack||K))}return v}return v.error("template rendering error",500)}function e(r,u,v){var z=r._r;if(void 0===u)r=z[5];else if("string"===
typeof u)r=~u.indexOf("://")?u:u.isAbs()?ia(z[5],u):z[5].replace(r.tpE,"#"+u+r.tpE);else return v[1].error("Invalid template branch: "+String(u)+", omit or set to {undefined} for main template rendering.");if(k[r]&&z[9])v[0](k[r]);else z=z[11],z[0]=~r.indexOf("://")?ha:ta,z[0](r,v)}function c(r){if(r.error)this[1].error(r.error);else{a:{try{var u=r.fn(this[1]._r[7])}catch(v){r=[void 0,"template rendering error"+(v.stack||v)];break a}r=[u,null]}r[0]?"function"===typeof this[2]?this[2](r[0],this[1]):
this[2][0](r[0],this[1]):this[1].error(r[1])}}function a(){return""}var d=h.prototype,q=ja,l=1E4,k={},n=ka,m;da=h;W=function(r,u){var v=la;r&&("aliasHostHeader"===r?(v.preferAliasHost=!0,v.aliasHostHeader=String(u).trim().toLowerCase()):"checkInterval"===r?l=w[3]=u:"csBuilder"===r?m=u:(d[r]=u,"_f"===r&&(w[2]=u)));return da};d.tpE=f.init[2];d.csE=f.init[3];d.status="200";d.charset="UTF-8";d.encoding="utf8";d.contentType="text/html";d.sendET=d._g=d._f=!1;d.eso="";d.proxy="";d.cacheProxy=d.proxyCache=
"";d.error="";d.proxySendFile=!1;d.sendFileDir="";d.sendFileHeader="X-Accel-Redirect";d.buffer="";d.getTplVals=function(){return this._r[7]};d.setContentType=function(r){this.contentType=r;return this};d.flush=t;d.header=function(r){var u=this._r;u[1]+="\r\n"+r;u[10]&&(~r.indexOf("xpires:")||~r.indexOf("ontrol:"))&&(u[10]=!1);return this};d.redirect=function(r,u){var v=this.eid;this._r[1]+="\r\nLocation: "+(v?r+(~r.indexOf("?")?"&":"?")+"__eso="+v.substr(1):r);this.status=u||"302";return this.flush(!1)};
d.setCookie=function(r){if(this.eid){var u=this.json;var v=u.cookie;r=f.creatCookieHeader(r);v?"string"===typeof v?u.cookie=[v,r]:v.push(r):u.cookie=r}else this._r[1]+="\r\n"+f.creatCookieHeader(r);return this};d.deleteCookie=function(r,u){r="Set-Cookie: "+r+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT"+(u?"; domain="+u:"");var v;this.eid?(u=this.json,(v=u.cookie)?"string"===typeof v?u.cookie=[v,r]:v.push(r):u.cookie=r):this._r[1]+="\r\n"+r;return this};d.deleteCookies=function(r,u){var v="Set-Cookie: "+
r+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT"+(u?"; domain="+u:"");r="Set-Cookie: "+r+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT; path=/"+(u?"; domain="+u:"");var z;this.eid?(u=this.json,(z=u.cookie)?"string"===typeof z?u.cookie=[z,v,r]:z.push(v,r):u.cookie=[v,r]):this._r[1]+="\r\n"+v+"\r\n"+r;return this};d.next=function(){arguments.R=arguments.r=this;return arguments};d.session=function(r,u){var v;if(this.eid)return this;u||=!0===r;(v=this._r[7]._cookie.SJSSESSIONID)?this.session=v:
(v=this.session=f.MD5(this._r[3]+Math.random().toString()),this.setCookie({name:"SJSSESSIONID",value:v,hours:!0!==r&&0<r&&r,secure:u,http:!0}));return this};d.sendFile=function(r,u){var v=this._r,z=new Date,B=v[2],F="1.1"===B;if(!v)return void 0===v?this.error("flush(): invalid 'this'."):this;if(r.isAbs()&&n(r)){u||="application/force-download";if(!~u.indexOf("/")){var y=u;u="application/force-download"}v[0][F&&"write"||"end"]("HTTP/"+B+" 200\r\nDate: "+z.toUTCString()+"\r\nContent-Type: "+u+"\r\nContent-Length: "+
fs.statSync(r).size+("application/force-download"===u?"\r\nContent-Disposition: attachment; filename="+(y||path.basename(r)):"")+"\r\nServer: "+f.server+v[1]+(this.sendET?"\r\nX-SR: "+(z-v[3]):"\r\nX-SR: N/A")+(v[6]?", 1":", -1")+"\r\nConnection: "+(F?"keep-alive":"closed")+"\r\n\r\n",this.encoding);fs.createReadStream(r).pipe(v[0]);this._r=null}else return this.error("No such file : "+r,404);return this};var w=[f,d.tpE,d._f,l,{},ma,null,t,f.init[0],f.init[1],f.nullObj,RegExp("\\.\\.|\\\\|\\/\\/|\\/_suki"),
n,null,RegExp("\\/","g"),d.csE,function(r){r.flush()},f.moduleExtention,k,q],x=Array(9);x[0]=f;x[9]=/[\f\n\r\t\v]/g;d.getFlush=function(r,u){void 0===u?e(this,u,[c,this,r]):e(this,r,[c,this,u]);return this};f.getRender=function(r){try{var u=x[6](r)}catch(v){u=a}return u};f.render=function(r,u){try{var v=u(r)}catch(z){v=""}return v};var A=0,D=3E3,G=RegExp("\\*","g");try{var C=new Function("...a","return a")}catch(r){C=function(){return arguments}}}function va(){function h(a){var d=a.length,q=1,l;this.got=
[!1,null,0,[],0,0,!1];for(this.post={};q<d;q++){var k=a[q].indexOf("\r\n\r\n");if(!~k){this.got[0]=!0;break}var n=a[q].substring(0,k);k=a[q].substr(k+4);this.got[2]++;var m=n.indexOf("name=")+6;var w=n.indexOf('"',m);m=n.substring(m,w);var x=n.indexOf("filename=");w=~x;var A=this.post;(l="[]"===m.slice(-2))&&(m=m.slice(0,-2));if(w){this.got[4]++;var D=n.indexOf('"',x+10);n=n.substring(x+10,D);n={name:n,size:k.length-2,error:!1,purge:t};n.tmpName=path.normalize(c+"/sukijs_"+m+"."+f.random(10)+"."+
(new Date).getTime());c&&k?(n._fs=fs.createWriteStream(n.tmpName,e),p(n,this.got),this.got[3].push(n._fs),"\r\n"===k.slice(-2)?(k=k.slice(0,-2),n._fs.end(k,"binary")):n._fs.write(k,"binary")):(n.tmpName="",n.error=!0);k=n}else k=k.slice(0,-2),k=65537>k.length&&this.binaryToUTF8(k)||"";l?(A[m]||(A[m]=[]),A[m].push(k)):A[m]=k;q===d-1&&(this.last=[m,w])}}function p(a,d){setTimeout(function(){a._finished?fs.unlink(a.tmpName,b):(a.error=!0,a.tmpName="",a.size=0,a._fs.end())},3E4);a._fs.on("error",function(){a.error||
(a.error=!0,a.tmpName="",a.size=0,a._fs.end())});a._fs.on("finish",function(){a._finished=!0;a.error&&(d[6]=!0,fs.unlink(a.tmpName,b));++d[5]===d[4]&&d[0]&&(d[3].length=0,d[1]&&d[1](),d.length=0)})}function t(){fs.unlink(this.tmpName,b)}var g=na={},b=f.nullFunc,e={mode:438,flag:"r+"},c=f.init[4];g.initPost=function(a,d,q,l,k,n,m,w){var x=Number(k["content-length"]),A=k["content-type"]||"",D;A=(0===A.indexOf("application/x-www-form-urlencoded")||0===A.indexOf("application/json")||0===A.indexOf("application/dns-message"))&&
0<x||"multipart/form-data"===A.substr(0,19)&&(D=A.split("="))&&2===D.length&&D[1];n=w-(n.length||0);m=m-n-4;n=-1<m&&d.slice(n+4);m=x===m;if(A&&x)if(!0===A&&m)a._b=0,new q(a,l,k,n);else if(m){var G=new h(d.toString("binary").split("--"+A));a._b=0;G.got[1]=function(){new q(a,l,k,G.post)}}else a.raw=n,a._p=[l,k],D?(a.maxUploadSize=104857600,a.__b=A,a._b=65537):a._b=x;else a._b=-1,a.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : Not support for This so called 'HTTP-POST'..."),f.log("Net socket denied.(Not support for This so called 'HTTP-POST'...)",
"n")};g.post=function(a,d,q,l){var k=a.raw,n=k.length,m=f.creatBuffer(d.length+n);if(void 0!==k.length&&0<l&&65537>l)k.copy(m,0,0),d.copy(m,n,0),l===m.length?(a._b=0,new q(a,a._p[0],a._p[1],m)):a.raw=m;else if(65537===l)g._upload(a,d,q);else{a.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : BAD POSTING REQUEST.");try{d.length=0,a.destroy()}catch{}}};g._upload=function(a,d,q){var l=a._uploader;if(l)if(100<l.got[2]||a._uploaderL>a.maxUploadSize)a._b=-1,a.end("HTTP POST too Large!"),l.got[1]=null,console.log("HTTP POST too Large!\nForbidden for ever on this actived socket.");
else{var k=d.toString("binary");l.add(k.split("--"+a.__b),d);l.got[0]?(a._b=0,a._uploader=null,l.got[4]?l.got[1]=function(){new q(a,a._p[0],a._p[1],l.post)}:new q(a,a._p[0],a._p[1],l.post)):a._uploaderL+=d.length}else{var n=a.raw;var m=n.length;k=f.creatBuffer(d.length+m);n.copy(k,0,0);d.copy(k,m,0);d=a.__b;n=k.toString("binary");l=new h(n.split("--"+d));l.got[0]?(a._b=0,l.got[4]?l.got[1]=function(){new q(a,a._p[0],a._p[1],l.post)}:new q(a,a._p[0],a._p[1],l.post)):(a._uploaderL=k.length,a._uploader=
l)}};h.prototype.add=function(a,d){var q=a.length,l=this.last[0],k;if(1<q){if(this.last[1]&&a[0]){var n=this.post[l];Array.isArray(n)&&(n=n[n.length-1]);n.size+=a[0].length;c&&("\r\n"===a[0].slice(-2)&&(a[0]=a[0].slice(0,-2)),n._fs.end(a[0],"binary"))}for(l=1;l<q;l++){d=a[l].indexOf("\r\n\r\n");if(!~d){this.got[0]=!0;break}n=a[l].substring(0,d);d=a[l].substr(d+4);this.got[2]++;var m=n.indexOf("name=")+6;var w=n.indexOf('"',m);m=n.substring(m,w);var x=n.indexOf("filename=");w=~x;var A=this.post;(k=
"[]"===m.slice(-2))&&(m=m.slice(0,-2));if(w){this.got[4]++;var D=n.indexOf('"',x+10);n=n.substring(x+10,D);n={name:n,size:d.length-2,error:!1,purge:t};n.tmpName=path.normalize(c+"/sukijs_"+m+"."+f.random(10)+"."+(new Date).getTime());c&&d?(n._fs=fs.createWriteStream(n.tmpName,e),p(n,this.got),this.got[3].push(n._fs),"\r\n"===d.slice(-2)?(d=d.slice(0,-2),n._fs.end(d,"binary")):n._fs.write(d,"binary")):(n.tmpName="",n.error=!0);d=n}else d=d.slice(0,-2),d=65537>d.length&&this.binaryToUTF8(d)||"";k?(A[m]||
(A[m]=[]),A[m].push(d)):A[m]=d;l===q-1&&(this.last=[m,w])}}else n=this.post[l],this.last[1]?(Array.isArray(n)&&(n=n[n.length-1]),n.size+=d.length,c&&n._fs.write(d)):(a=n+a[0],this.post[l]=65537>a.length&&this.binaryToUTF8(a)||"")};h.prototype.binaryToUTF8=f.binaryToUTF8}function wa(){var h=la={},p={GET:!0,POST:!0};oa=function(t,g){var b=g._b,e=1,c=da,a=na,d,q;if(Number(b))a.post(g,t,c,b);else{var l=t.length;var k=(b||"")+Z.decode(t);var n=k.indexOf("\r\n\r\n");var m=k.substring(0,4).trim();var w=
f.rewriteRules;if(p[m])if(~n){var x=k.substring(0,n).trim();var A=ba.encode(x).length;var D=x.length===A;var G=x.split("\r\n");var C=G.length;if((q=1<C&&G[0].trim().split(" "))&&3===q.length){for(k={};e<C;e++){var r=G[e];var u=r.indexOf(":");if(~u)k[r.substring(0,u).trim().toLowerCase()]=r.substring(u+1).trim();else{k=null;break}}h.preferAliasHost&&k[h.aliasHostHeader]&&(k["x-real-host"]=k.host)&&(k.host=k[h.aliasHostHeader]);w&&(q[1]=f.rewriteURL(q[1]))}else k=null;k&&D||k.referer&&x.length-k.referer.length===
A-(d=ba.encode(k.referer).length)?(k["remote-addr"]=g.remoteAddr,k.url=q[1],k.method=m,d&&d!==k.referer.length&&(k.referer=encodeURIComponent(k.referer)),"GET"===m?(g._b=0,new c(g,q,k,null)):a.initPost(g,t,c,q,k,b,l,n)):_reInit(g,k&&q[2],k&&q[1],!D)}else 8192<k.length?(g._b=-1,g.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : HTTP header too long! limited "+k.length+"."),console.log("HTTP header too long!"+k.length+"\nForbidden for ever on this actived socket.")):g._b=k;else g._b=-1,g.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : Not support for this method.\r\nSituation is logged."),
console.log("\r\nNot support for this method ("+m+").\r\n"+g.remoteAddr.hostname+"\r\n",k)}}}function xa(){var h=f.less,p=h?new h.Parser:!1,t={};h=b=>{t[b]=!0};var g=[/[\s;]*$/,/\/\*.*?\*\/|'[^']*'|"[^"]*"|\.[\$\w]+/g,/[^\$\w\d]+/,/^\d/,null,/<(script.*?>)([\s\S]*?)<\/(script)/gi,RegExp("\x3c!--.*?--\x3e","g"),/(`\{|\{)[\s]*?\[[\s]*?#[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})(.*)(\1)[\s]*?\[[\s]*?\/[\s]*?(\2)[\s]*?\][\s]*?(\3)/g,/(`\{|\{)[\s]*?\[[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})/g,/\\'/g,/s\+='s\+=/g,/(`\{|\{)[\s]*?\[[\s]*?(\.|this)[\s]*?\][\s]*?(\}`|\})/g,
/(`\{|\{)[\s]*?\[[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})/g,/<(style[^>]+?less|style)(.*?)<\/style>/gi,/\/\/.*/g,RegExp("\\/\\*[\\s\\S]*?\\*\\/","g"),function(b,e,c,a){b=g;c=c.replace(b[19],"</scri_pt>>").replace(b[20],"<<scri_pt>");return"<"+e+c.replace(b[24],":\\/\\/").replace(b[14],"").replace(b[15],"").replace(b[25],b[28])+"</"+a},function(b,e,c,a){var d=c.indexOf(">");b=g;c=c.replace(g[23],"");if(p&&~e.toLowerCase().indexOf("less")&&~d){var q=c.substr(d+1);e=e.replace(" less","");p.parse(q,function(l,
k){c=c.substr(0,d)+">"+(l?q:k.toCSS({compress:!0}))})}return"<"+e+c.replace(b[25],b[28])+"</style>"},function(b,e,c,a,d){return"';var i=0,l=o."+c+".length,d=o."+c+";for(;i<l;i++){s+='"+d.replace(g[11],"'+d[i]+'").replace(g[12],"'+(d[i]['$1']||('undefined'===typeof $1?'':$1))+'")+"'}s+='"},RegExp("\x3c!--","g"),RegExp("--\x3e","g"),/<\/scri_pt>>/g,/<<scri_pt>/g,RegExp("\\/\\*.*?\\*\\/","g"),RegExp(":\\/\\/","g"),/([^\\])\\([^\\])/g,/<style|<less/i,/<script/i,function(b,e,c){return e+"\\\\"+c},/^[a-zA-Z0-9_$]+$/,
/s\+='';/g,/^[\s]*?=[\s]*?/];"Math JSON encodeURI encodeURIComponent decodeURI decodeURIComponent escape unescape eval isNaN isFinite parseInt parseFloat null undefined NaN Infinity Object Array Function Boolean String Number Date RegExp Error".split(" ").forEach(h);"break case catch continue debugger default delete do else false finally for function if in instanceof new return switch this throw true try typeof var void while with const".split(" ").forEach(h);"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile arguments let yield".split(" ").forEach(h);
ja=function(b,e){b=b.replace(/\\/g,"\\\\");var c={},a="",d=g,q=function(l){if(l&&!t[l]&&!d[3].test(l)&&!c[l]){if("s"===l||"o"===l)throw"There must not be '"+l+"' in template as it is taken internally.";c[l]=!0;a+=","+l+"=o."+l+"||(0===o."+l+"?'0':'')"}};(e=d[27].exec(b))&&(e=b.indexOf(e[0]))&&(b=b.substr(0,e)+b.substr(e).replace(d[5],d[16]));(e=d[26].exec(b))&&(e=b.indexOf(e[0]))&&(b=b.substr(0,e)+b.substr(e).replace(d[13],d[17]));e=b.indexOf("\x3c!--");~e&&(b=b.substr(0,e)+b.substr(e).replace(d[6],
"").replace(d[21],"\x3c!--").replace(d[22],"<<scri_pt>"));b=b.split("'").join("\\'").replace(d[7],d[18]).replace(d[8],function(l,k,n){k=n.replace(d[9],"'");k=k.trim();l="="===k.charAt(0)||d[29].test(k)?"';s+="+k.replace(d[31],"").replace(d[0],"")+";s+='":"';"+k+";s+='";k=k.replace(d[1],"");k.split(d[2]).forEach(q);return l})+"';return s;";b="var s=''"+a+";"+("s+='"+b).replace(d[10],"s+=");return new Function("o",b.replace(d[30],""))}}function ya(){var h={500:["500 Internal Server Error","Current service is temporarily unavailable."],
502:["502 Bad gateway","Networking is temporarily unavailable."],503:["503 Service Unavailable","Server is busy, pleas try again later."],400:["400 Bad Request","Invalid HTTP request."],403:["403 Forbidden","Access Denied."],404:["404 Not Found","The requested URL is not found on this server."]};da.prototype.error=function(p,t){var g=this._r;if(g&&g.length){this.status=t||"500";this.contentType="text/html";t=this.flush;p=String(p||"");var b=String(this.status),e=h[b];p=e&&"<!DOCTYPE HTML><html><head><title>"+
(e&&e[0]||b)+'</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><style>html, body{margin:0 16px;padding:0;font-family:Varela Round,Helvetica,Arial,sans-serif;font-size:16px;line-height:26px}body{background:#fff;color:#222}h1{color:#205080;font-size:20px;font-weight:100;letter-spacing:0.2ex;text-shadow:#d0e0ea 0 1px;line-height:40px;border-bottom:2px solid #c0d0e0}h1:before{content:"";content:"\\203a\\2002"}div{font-size:12px;background:#cccccc;padding:5px;padding-left:10px}</style></head><body><h1>'+
(e&&e[0]||b)+"</h1><p>"+(e&&e[1]||"")+"</p><div><p><strong>Detail:</strong></p><p>"+p.replace("<","&lt;").replace(">","&gt;").replace(/\n|\r\n/g,"<br>")+"</p><div></body></html>"||p;t.call(this,null,p);g.length=0}else p=String(p).replace(/<br>/gi,"\r\n"),f.log("a sync error occured after REST.flush() SO it would not display on webpage: \r\n"+p,"c");return this}}var ca=class{static parse=null;static listen(h,p){ca._connLoop(Deno.listen({port:h,hostname:p,transport:"tcp"}))}static async _connLoop(h){for await(let p of h)ca._packetLoop(p)}static async _packetLoop(h){var p=
new za(h);for await(let t of h.readable)ca.parse(t,p)}};var za=class{_sock=null;_textEncoder=ba;remoteAddr="";_b=0;constructor(h){this._sock=h;this.remoteAddr=h.remoteAddr.hostname}write(h){"string"===typeof h?this._sock.write(this._textEncoder.encode(h)):this._sock.write(h);return this}async end(h){h&&await ("string"===typeof h?this._sock.write(this._textEncoder.encode(h)):this._sock.write(h));this._sock.close()}streamFrom(h){h.readable.pipeTo(this._sock.writable,{preventClose:!0})}};var aa,ka,ma,
fa,ia,Z,ba,pa,T;!async function(){if("undefined"===typeof require){var h=(await MODULE).createRequire;T=h(IMU)}else T=require;h=Y.fs;var p=Y.url_utils,t=Y.querystring,g=Y.os;aa=Y.path.normalize;ka=h.existsSync;ma=t.parse;ia=p.resolve;pa=g.tmpdir();fa=ArrayBuffer.isView;Z=new TextDecoder;ba=new TextEncoder;!0;"function"===typeof f.init&&f.init()}();f.MIME=f.mime={types:{html:"text/html",htm:"text/html",shtml:"text/html",css:"text/css",xml:"text/xml",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",
js:"application/javascript",atom:"application/atom+xml",rss:"application/rss+xml",mml:"text/mathml",txt:"text/plain",jad:"text/vnd.sun.j2me.app-descriptor",wml:"text/vnd.wap.wml",htc:"text/x-component",avif:"image/avif",png:"image/png",svg:"image/svg+xml",svgz:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",wbmp:"image/vnd.wap.wbmp",webp:"image/webp",ico:"image/x-icon",jng:"image/x-jng",bmp:"image/x-ms-bmp",woff:"font/woff",woff2:"font/woff2",jar:"application/java-archive",war:"application/java-archive",
ear:"application/java-archive",json:"application/json",hqx:"application/mac-binhex40",doc:"application/msword",pdf:"application/pdf",ps:"application/postscript",eps:"application/postscript",ai:"application/postscript",rtf:"application/rtf",m3u8:"application/vnd.apple.mpegurl",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz",xls:"application/vnd.ms-excel",eot:"application/vnd.ms-fontobject",ppt:"application/vnd.ms-powerpoint",odg:"application/vnd.oasis.opendocument.graphics",
odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",wmlc:"application/vnd.wap.wmlc",wasm:"application/wasm","7z":"application/x-7z-compressed",cco:"application/x-cocoa",
jardiff:"application/x-java-archive-diff",jnlp:"application/x-java-jnlp-file",run:"application/x-makeself",pl:"application/x-perl",pm:"application/x-perl",prc:"application/x-pilot",pdb:"application/x-pilot",rar:"application/x-rar-compressed",rpm:"application/x-redhat-package-manager",sea:"application/x-sea",swf:"application/x-shockwave-flash",sit:"application/x-stuffit",tcl:"application/x-tcl",tk:"application/x-tcl",der:"application/x-x509-ca-cert",pem:"application/x-x509-ca-cert",crt:"application/x-x509-ca-cert",
xpi:"application/x-xpinstall",xhtml:"application/xhtml+xml",xspf:"application/xspf+xml",zip:"application/zip",msi:"application/octet-stream",msp:"application/octet-stream",msm:"application/octet-stream",mid:"audio/midi",midi:"audio/midi",kar:"audio/midi",mp3:"audio/mpeg",ogg:"audio/ogg",m4a:"audio/x-m4a",ra:"audio/x-realaudio","3gpp":"video/3gpp","3gp":"video/3gpp",ts:"video/mp2t",mp4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",mov:"video/quicktime",webm:"video/webm",flv:"video/x-flv",m4v:"video/x-m4v",
mng:"video/x-mng",asx:"video/x-ms-asf",asf:"video/x-ms-asf",wmv:"video/x-ms-wmv",avi:"video/x-msvideo"},defaultType:"application/octet-stream"};var da,W,na,oa,la,ja;f.server="suki";f.extention=".sjs";f.moduleExtention=".sjs.js";f.nullObj=Object.freeze({});f.nullFunc=function(){}.bind(f.nullObj);f.platform=Y.os.platform();f.strlen=Buffer.byteLength;f.isLinux="linux"===f.platform;f.isWindows="win"===f.platform.substring(0,3);(function(){function h(m){m=m||{};var w=Number(m.ports||m.port),x=w&&"port"||
"",A=f.root=m.webRoot?t(m.webRoot):{"*":"*"},D=f.extention+".html",G;var C=0;var r=[!1,["127.0.0.1","10.8.*.*"]];if(c)return a.log("Duplicated initialization ignored."),this;c=!0;f.version||(f.version="");f.password="public-defualt-8NJzmhSCpQutF7EY6E6WdxrRy9txtN93";f.salt="8NJzmhSCpQutF7EY6E6WdxrRy9txtN93";C=Math.floor(Number(C));f.timeZoneString=-12<C&&12>C?("+0"+String(C)).replace("0-","-0").replace("00","0").replace("010","10").replace("011","11").replace("+-","-")+":00":"+00:00";f.timeZoneOffset=
0<C<12?3600*C||0:0;if(x&&null===f.root)f.log("Invalid webRoot config.","e");else{f.unlocked=!0;f._locker=0;if(!A["*"]){C=Object.keys(A)[0];var u=A[C];if(u)A["*"]=u,a.log("no [*] sets, specify "+u+" (which hosts "+C+") as default webRoot.");else return f.log("Invalid config on webRoot.","c"),this}f.init=["",A,D,f.extention,m.tmp&&aa(m.tmp)||pa,null];f.tmpdir=f.init[4];f.logfile=f.init[5]=m.logfile&&path.normalize(m.logfile)||null;for(v of Aa)v();r[0]&&f.nextTick(function(){f.allow(r[1]);a.log("built-in firewall initialized;")});
for(G of Ba)G();va();wa();xa();ua();ya();W("sendET",!0);W("csBuilder",g);m._sendFileDir&&W("sendFileDir",m._sendFileDir);m._sendFileHeader&&W("sendFileHeader",m._sendFileHeader);m._proxySendFile&&W("proxySendFile",m._proxySendFile);var v=m._hotCodeDelaySeconds;"number"===typeof v&&(Infinity===v||/^[0-9]+$/.test(v.toString()))&&W("checkInterval",1E3*v);m._aliasHostHeader&&W("aliasHostHeader",m._aliasHostHeader);f.version||(f.version="suki.js_v11.0.22");"port"===x&&(ca.listen(w,m.bind||"::"),ca.parse=
oa,f.log(f.dateFormat(new Date)+" UTC\ndeno_v"+Deno.version.deno.replace("v","")+"\n"+f.version+" Javascript Application Server (HTTP listening on "+(m.bind||"::")+":"+w+")  \r\n"));return p}}function p(m){m(f)}function t(m){function w(G){var C="",r="",u="undefined"===typeof fetch;Array.isArray(G)&&("string"===typeof G[0]&&(C=G[0]),"string"===typeof G[1]&&(r=G[1]));"string"===typeof G&&(C=G);if("http://"===C.substring(0,7)||"https://"===C.substring(0,8)){if(u)return f.log("Invalid remote webRoot: "+
C+" (runtime has no fetch api so networking webRoot could not be used)","e"),null;"/"===C.slice(-1)&&(C=C.slice(0,-1));if(~C.indexOf(" "))return f.log("Invalid remote webRoot: "+C,"e"),null;r&&=aa(r);return C+" "+r}if(C)return C=aa(C)," "+C;f.log("Invalid webRoot: "+C,"e");return null}var x=m,A,D=!0;if("string"===typeof m||Array.isArray(m))x={"*":m};for(A in x)x[A]=w(x[A]),D&&x[A]&&(D=!1);return D?null:x}function g(m,w,x){m=m.trim();var A={},D=l[0].test(m),G={app:function(F){return F&&"string"===
typeof F?this.app=f._setAC(F,{_name:F}):null}},C=/\\/g;x="var __filename='"+(x||"").replace(C,"\\\\")+"',__dirname='"+(w||"").replace(C,"\\\\")+"';";var r;try{if(D){var u=m.match(l[1]);var v=u.length;var z=u.join("").replace(l[2],"");for(r=0;r<v;r++)m=m.replace(u[r],"");var B=x+"try{"+z+"\n}catch(e){return function (R){return R.error('CS AREA A HAS AN ERROR.\\n'+(e.stack||e),'500');};}return "+q+"function (R,tplVals,_get,_post,_cookie,_server){if(!suki.unlocked){return R.error('Server is too busy due to [Critical Error: uncaughtException(see logs)].','500.13');}try{"+
m+"\n}catch(e){R.error('CS AREA B HAS AN ERRROR.\\n'+(e.stack||e),500)};};"}else B=x+"return "+q+"function (R,tplVals,_get,_post,_cookie,_server){if(!suki.unlocked){return R.error('Server is too busy due to [Critical Error: uncaughtException(see logs)].','500.13');}try{"+m+"\n}catch(e){return R.error('CS AREA B HAS AN ERROR.\\n'+(e.stack||e),500);}};";A.cs=(new d("require,suki",B)).bind(G)(b(w),f)}catch(F){A.cs=function(y){y.error("["+f.extention.substring(1)+" init error] "+(F.stack||F),500)}}return A}
function b(m){function w(x){var A=!String(x).isAbs()&&!~x.indexOf("node:")&&(~x.indexOf("/")||~x.indexOf("\\"));return e(A?m+"/"+x:x,T)||e(m+"/"+x,T)}w.cache=T.cache;w.extensions=T.extensions;w.resolve=function(x){var A=!String(x).isAbs()&&!~x.indexOf("node:")&&(~x.indexOf("/")||~x.indexOf("\\"));try{var D=T.resolve(A?m+"/"+x:x)}catch(G){D=""}return D||T.resolve(m+"/"+x)};return w}function e(m,w){w||=T;try{var x=w(m)}catch(A){if(m.isAbs()||~m.indexOf("node:"))f.log("'libExists()' Pre Loading Failed: "+
m,"w"),console.log(A.stack||A)}return x}var c=!1,a={log:function(m){console.log(m)}},d=Object.getPrototypeOf(function(){}).constructor,q="async ";try{new d("(async function(){})")}catch(m){q=""}var l=[RegExp("\\/\\/\\<\\!\\-\\-([\\s\\S]*?)\\/\\/\\-\\-\\>"),RegExp("\\/\\/\\<\\!\\-\\-[\\s\\S]*?\\/\\/\\-\\-\\>","g"),RegExp("\\/\\/\\<\\!\\-\\-|\\/\\/\\-\\-\\>","g")],k,n=[];f.init=function(m){var w;void 0===k&&(k=m||{});setTimeout(function(){if(T&&k){h(k);k=null;for(w of n)w(f);n.length=0}},0);return function(x){"function"===
typeof x&&n.push(x)}}})();(function(){String.prototype.isAbs=function(){return"/"===this.charAt(0)||"\\"===this.charAt(0)||":"===this.charAt(1)};String.prototype.toContextString=function(){return JSON.stringify([this]).slice(1,-1)};var h=function(p){return"\\"+p};String.prototype.escapeMarkdown=function(p){var t="[\\.\\`\\*\\_\\{\\}\\[\\]\\<\\>\\(\\)\\#\\+\\-\\!\\|\\\\]",g;if(p){p=p.split("");var b=p.length;for(g=0;g<b;g++)t=t.replace("\\"+p[g],"")}return this.replace(new RegExp(t,"g"),h)}})();(function(){function h(c,
a,d){var q=a.replace(/set-cookie/g,"Set-Cookie"),l=encodeURIComponent(c)+"=",k=q.indexOf(l);if(~k){k+=l.length;var n=q.indexOf(";",k);~n||(n=q.length);a=q.substr(n);if(~a.indexOf(l))return h(c,a);try{var m=decodeURIComponent(q.substring(k,n))}catch{return}if(!0===d){n=q.indexOf("Set-Cookie",k);n=~n?n:q.length;a=q.substring(k+m.length,n);c={name:c,value:m};d=a.split(";");m=d.length;for(a=0;a<m;a++)q=d[a].trim(),""!==q&&(l=q.indexOf("="),~l?c[q.substr(0,l)]=q.substr(l+1):c[q]=!0);return c}return m}}
function p(c,a){return"~"+a.toUpperCase()+":"}function t(c,a){return"object"===typeof c?a?c:JSON.stringify(c,g,"\t"):"^"+typeof c+":\\{: "+String(c)}function g(c,a){return t(a,Array.isArray(a)?"^array:\\{: ":"^"+typeof a+":\\{: ")}f.objectToArray=function(c){return Array.prototype.slice.call(c,0)};f.next=new Function("...a","return a");var b=[/\\|%5c/gi,/&(?!\w+;)/g,/</g,/>/g,/"/g,/'/g,/%26/g,/%3c/gi,/%3e/gi,/&#37;22/g,/%/g];f.clean=function(c){if(!c)return 0===c?"0":"";c=String(c).replace(b[0],"").replace(b[1],
"&amp;").replace(b[2],"&lt;").replace(b[3],"&gt;").replace(b[4],"&quot;").replace(b[5],"&#39;");try{var a=decodeURIComponent(c)}catch{return c.replace(b[0],"&#37;5C").replace(b[6],"&#37;26").replace(b[7],"&#37;3C").replace(b[8],"&#37;3E").replace(b[9],"&#37;22")}return c===a?c:c.replace(b[10],"&#37;")};f.passAgentHeaders=function(c){return{accept:"text/html, application/xhtml+xml, */*","accept-language":"zh-CN,zh;q=0.8,en;q=0.6","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87."+
(c?Math.random().toFixed(4):"2883")+".87 Safari/537.36","cache-control":"max-age=0",dnt:"1",connection:"keep-alive"}};f.randomArray=function(c,a,d){return c instanceof Array?(a=a&&d?Math.floor(Math.random()*(d-a+1)+a):Math.floor(Math.random()*c.length),c[a]):null};f.parseCookieHeader=h;f.creatCookieHeader=function(c){var a,d=c.hours;(a=c.expires)?a="; expires="+a:d&&(a=new Date,a.setTime(a.getTime()+Math.floor(36E5*d)),a=a.toUTCString(),a="; expires="+a);return"Set-Cookie: "+c.name+"="+encodeURIComponent(c.value)+
(a||"")+(c.domain&&"; domain="+c.domain||"")+(c.path&&"; path="+c.path||"")+(c.secure&&"; secure"||"")+(c.http&&"; HttpOnly"||"")};f.getIP=function(c,a){var d;if("object"!==typeof c)return"";switch(a){case "real":return c["x-real-ip"]||c["remote-addr"]||"";case "user":return a=(c["x-forwarded-for"]||"").split(","),(d=a.length)?a[d-1].trim():c["remote-addr"]||"";case "proxy":return a=(c["x-forwarded-for"]||"").split(","),a[0]?a[0].trim():c["remote-addr"]||"";default:return c["remote-addr"]||""}};f.log=
function(c,a){switch(a){case "n":f.logfile?f.writeMore(f.logfile,"\r\n[NOTE]"+c+"\r\n"):console.log("\r\n[NOTE]"+c+"\r\n");break;case "w":f.logfile?f.writeMore(f.logfile,"\r\n[WARN]"+c+"\r\n"):console.log("\r\n[WARN]"+c+"\r\n");break;case "e":f.logfile?f.writeMore(f.logfile,"\r\n[ERRO]"+c+"\r\n"):console.log("\r\n[ERRO]"+c+"\r\n");break;case "c":f.logfile?f.writeMore(f.logfile,"\r\n[CRIT]"+c+"\r\n"):console.log("\r\n[CRIT]"+c+"\r\n");break;default:f.logfile?f.writeMore(f.logfile,"\r\n"+c+"\r\n"):
console.log("\r\n"+c+"\r\n")}};var e=[/: "\^([a-z]+):\\\\{:/g,/"(,?)$/gm];f.obj2str=function(c){try{var a="object"===typeof c?t(c).replace(e[0],p).replace(e[1],"$1"):"^"+(typeof c).toUpperCase()+": "+String(c)}catch{return util.inspect(c)}return a};f.parseJSON=function(c,a){try{return JSON.parse(c)}catch{return a||null}};f.signature=function(c,a){var d=(c=String(c)).substr(0,c.indexOf("."));a=a||"";if(64===d.length){var q=c.substr(65);return d===f.sha256(q+f.salt+a)?c:f.sha256(c+f.salt+a)+"."+c}return f.sha256(c+
f.salt+a)+"."+c};f.rewriteURL=function(c){var a=0,d=f.rewriteRules,q=d.length,l=c.indexOf("?"),k=~l?c.substr(l+1):"";for(k&&(c=c.substr(0,l));a<q;a++)if(l=d[a],l=c.replace(l[0],l[1]),l!==c)return l.substr(1)+(k?(~l.indexOf("?")?"&":"?")+k:"");return k?c+"?"+k:c}})();(function(){var h=require("node:fs"),p=require("node:dns");f.dnsTTL=3E5;f.dnsCache={_length:0};f.dnsHosts={};f.dnsInitHosts=function(t){t=Array.isArray(t)?t:h.readFileSync(t).toString("utf8").replace(/[\r\t]/g," ").replace(/[ ]+/g," ").split("\n");
var g=t.length,b=0,e,c,a;if(0<g)for(e=this.dnsHosts={};b<g;b++)if((c=t[b].trim())&&"#"!==c.charAt(0)){c=c.replace(/[ ]+?#.*/g,"").split(" ");var d=c.length;if(1<d)for(a=1;a<d;a++)e[c[a]]=c[0]}return this};f.dnsPurgeCache=function(){this.dnsCache={_length:0};return this};f.dnsLookup4=function(t,g){var b=this.dnsCache,e=this.dnsHosts,c="object"===typeof g;1E3<b._length&&this.dnsPurgeCache();if(e=e[t]||e["*"])if(c)g[0](e);else g(e);else if((e=b[t])&&this.dnsTTL>(new Date).getTime()-e[1])if(c)g[0](e);
else g(e);else p.resolve4(t,function(a,d){a?a=t:(a=d[0],b._length++,b[t]=[a,(new Date).getTime()]);if(c)g[0](a);else g(a)})}})();(function(){var h={};f.getAC=function(p){return h[p]||null};f.setAC=function(p,t){return"_"===p.charAt(0)?null:h[p]||(h[p]=t)};f._setAC=function(p,t){return h["_"+p]||(h["_"+p]=t)};f.resetAC=function(p,t){return h[p]=t}})();(function(){f.isAllowed=function(h,p,t,g){p=Array.isArray(p)?p:String(p).split(",");return p[h]||p[h.substr(0,h.indexOf(".",4))+".*.*"]||p[h.substr(0,
h.lastIndexOf("."))+".*"]||p[h.substr(0,h.indexOf("."))+".*.*.*"]?!1:t&&!!t.error(g||"Only valid agent can access.",404)||!0};f._defend=function(h,p){return p[h]||p[h.substr(0,h.indexOf(".",4))+".*.*"]||p[h.substr(0,h.lastIndexOf("."))+".*"]||p[h.substr(0,h.indexOf("."))+".*.*.*"]?!1:!0};f.allow=function(h){if(_unblocked){var p={};h=Array.isArray(h)?h:String(h).split(",");h.forEach(t=>p[t]=!0);_unblocked=!1;REST.config("_f",p)}};f.unblock=function(){_unblocked=!0;REST.config("_f",!1)}})();(function(){var h=
f.nullFunc,p=f.isWindows,t=f.isLinux||p,g={},b=require("node:child_process");f.shell=g;g.deamon=t?function(e,c,a){var d=e.cmd||e,q=Array.isArray(d)?d:p?String(d).split(" "):["sh","-c",String(d)],l=q.shift(),k=e.cwd?b.spawn(l,q,{cwd:e.cwd}):b.spawn(l,q),n=(e="boolean"==typeof c)?c:!1,m=e?a||5E3:"number"==typeof c?c:5E3,w=this,x=function(){this.resume&&(this.resume=h);k=b.spawn(l,q);k.on("exit",A);k.on("error",h)},A=function(D){0==D||n&&setTimeout(x,m)};k.on("exit",A);k.on("error",h);return{stop:function(D){n=
!1;w.kill(k);D||(this.stop=this.pause=this.resume=k=x=A=null)},pause:function(){this.stop(!0);this.resume=x}}}:h;g.exec=t?function(e,c,a){var d=e.cmd||e;d=Array.isArray(d)?d:p?String(d).split(" "):["sh","-c",String(d)];var q=e.cwd?b.spawn(d.shift(),d,{cwd:e.cwd}):b.spawn(d.shift(),d),l=this,k,n,m,w,x;a||=c;c=Number(c)||9E4;if(n=(k="object"===typeof a)||"function"===typeof a){var A=w="";e=function(G){x=!0;w+=G?G.toString("utf8"):"shell.exec error(no msg)"};q.stdout.on("data",function(G){A+=G.toString("utf8")});
q.stderr.on("data",e);q.on("error",e)}if(c){q.on("exit",function(G){if(!m){x||=0!=G;if(k)a[0](A||void 0,x?w:void 0);else n&&a(A||void 0,x?w:void 0);clearTimeout(D)}});var D=setTimeout(function(){if(!m){if(k)a[0](A||void 0,x?w+"[TIMEOUT("+c+"ms)]":"[TIMEOUT("+c+"ms)]");else n&&a(A||void 0,x?w+"[TIMEOUT("+c+"ms)]":"[TIMEOUT("+c+"ms)]");l.kill(q);m=!0}},c)}}:h;g.kill=t?function(e){var c="object"===typeof e?e.pid:"number"===typeof e&&e;p?b.spawn("taskkill",["/f","/t",c?"/pid":"/im",c||e]):b.spawn(c&&
"kill"||"pkill",c?["-9",c]:[e])}:h})();var Aa=[function(){try{f.sync=new Function("object","methed","next","return (...args)=>new Promise((resolve,reject)=>{var callback=(r,e,E)=>e&&undefined===r?reject(E||e):resolve(r);next&&(next.callback=callback);return 'string'===typeof methed?object[methed](...args,next?undefined:callback):(methed?methed.call(object,...args,next?undefined:callback):object(...args,next?undefined:callback))})"),f.sync.mute=new Function("object","methed","next","return (...args)=>new Promise(resolve=>{var callback=r=>resolve(r);next&&(next.callback=callback);return 'string'===typeof methed?object[methed](...args,next?undefined:callback):(methed?methed.call(object,...args,next?undefined:callback):object(...args,next?undefined:callback))})")}catch(h){f.sync=
null}},function(){var h=f.timeZoneOffset,p=f.timeZoneString,t=/[+\-][0-9]{2}:00$/;f.time=function(){return Math.floor((new Date).getTime()/1E3)+h};f.GMT=f.UTC=function(g){return void 0===g||-12<g&&12>g?Math.floor((new Date).getTime()/1E3)+3600*(g||0):Date.parse(t.test(String(g).trimRight())?g:g+p)/1E3||0};f.getGMT=f.getUTC=function(g){var b=new Date;g&&b.setTime(b.getTime()+1E3*(Number(g)||0));return b.toUTCString()};f.dateFormat=function(g,b){g||="{YYYY}-{MM}-{dd} {hh}:{mm}:{ss}";b||"string"!==typeof g?
("object"===typeof g||(g=new Date(1E3*g)),b||="{YYYY}-{MM}-{dd} {hh}:{mm}:{ss}"):(b=g,g=new Date,g.setTime(g.getTime()+1E3*h));return b.replace("{YYYY}",g.getUTCFullYear()).replace("{MM}",g.getUTCMonth()+1).replace("{dd}",g.getUTCDate()).replace("{hh}",("0"+g.getUTCHours()).slice(-2)).replace("{mm}",("0"+g.getUTCMinutes()).slice(-2)).replace("{ss}",("0"+g.getUTCSeconds()).slice(-2))};f.timePassed=function(g,b){var e=b?new Date(Number(g+"000")):new Date;g=Math.floor(e.getTime()/1E3)-(b||g);b=Math.floor(g/
3600);return 1>b?Math.floor(g/60)+"\u5206\u949f\u524d":24>b?b+"\u5c0f\u65f6\u524d":168>b?(e=60*(60*e.getHours()+e.getMinutes())+e.getSeconds()-(g-86400*Math.floor(g/86400)),e=Math.floor((g+(0>e?86400+e:e))/86400),1===e?"\u6628\u5929":2===e?"\u524d\u5929":e+"\u5929\u524d"):5040>b?Math.floor(g/604800)+"\u5468\u524d":61320>b?Math.floor(g/2592E3)+"\u4e2a\u6708\u524d":b?Math.floor(g/31536E3)+"\u5e74\u524d":"\u65e5\u671f\u4e0d\u8be6"};f.calendar="".calendar;f.richCalendar="".richCalendar},function(){function h(b){var e=
this._q;if(1>this._pendingTaskLength){this.dismiss(b);var c=e.length;if(0<c){for(b=0;b<c;b++)this.dismiss(e[b]);e.length=0;clearTimeout(this.tid)}}else e.push(b),c=e.length,1===c?this.tid=setTimeout(g,this.patience,this):e.length>this.max&&this.expel(b)}function p(b){var e=this._pendingTask[b];this._pendingTaskLength++;e||(this._pendingTask[b]=!0);return e}function t(b){var e;this._pendingTask[b]=!1;if(1>--this._pendingTaskLength){b=this._q;var c=b.length;for(e=0;e<c;e++)this.dismiss(b[e]);b.length=
0;clearTimeout(this.tid)}}function g(b){for(var e=0,c=b._q,a=b._q.length;e<a;e++)b.expel(c[e]);c.length=0}f.queue=function(){return{_q:[],_tid:0,_pendingTaskLength:0,_pendingTask:{},max:10,patience:3E4,moreTask:p,lessTask:t,add:h,dismiss:f.nullFunc,expel:f.nullFunc}}},function(){function h(g){for(var b="",e=p;0<g;)b=e[g%62]+b,g=Math.floor(g/62);return b||String(g)}var p="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),t=[,48,29,87];f.int62=h.encode=h;h.decode=function(g){for(var b=
String(g),e=0,c=0,a=b.charCodeAt(0);a;)e=62*e+a-t[a>>5],a=b.charCodeAt(++c);return g?e||NaN:NaN}},function(){var h=/MSIE ([^;]+)/;f.isSmartBrowser=function(b){return h.test("object"===typeof b?b["user-agent"]:b)?10>Number(RegExp.$1):!0};var p=/mobile|android|ucweb|fennec|iphone|blackberry|symbian|windows phone/i;f.isPhone=function(b){return p.test("object"===typeof b?b["user-agent"]:b)};f.long2ip=function(b){b=Number(b);return 12>String(b).length&&Math.floor(b)===b&&0<b?(b>>24&255)+"."+(b>>16&255)+
"."+(b>>8&255)+"."+(b&255):""};var t=/^[0-9]+$/;f.ip2long=function(b){b=String(b).split(".").filter(Boolean);return 4===b.length&&t.test(b.join(""))&&0<b[0]&&-1<b[1]&&-1<b[2]&&-1<b[3]&&256>b[0]&&256>b[1]&&256>b[2]&&256>b[3]?16777216*b[0]+65536*b[1]+256*b[2]+Number(b[3]):0};f.isIp4InCidrs=function(b,e){var c=f.ip2long;return Array.isArray(e)&&e.length&&e.some(function(a){var d=a.indexOf("/"),q=~(Math.pow(2,32-a.substr(d+1))-1);return~d?(c(b)&q)===(c(a.substr(0,d))&q):!1})||!1};f.ip4internals=[["10.0.0.0/8",
"172.16.0.0/12","192.168.0.0/16"],"0.0.0.0/8 100.64.0.0/10 127.0.0.0/8 169.254.0.0/16 192.0.0.0/24 192.0.2.0/24 198.18.0.0/15 198.51.100.0/24 203.0.113.0/24 255.255.255.255/32".split(" ")];f.forInArray=function(b,e){var c=b.length;b=Math.floor(c/8);var a=c%8;c=0;if(0<a)for(;0<a;a--)e(c++);for(a=b;0<a;a--)e(c++),e(c++),e(c++),e(c++),e(c++),e(c++),e(c++),e(c++)};var g=[/^\S+@(\S+)$/,/^(?:[A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/];f.isEmail=function(b){var e=String(b).trim();return b===e&&255>b.length&&g[0].test(b)&&
g[1].test(RegExp.$1)};f.random=function(b,e){var c="",a=Math.random;if(!b)return"";for(;;){var d=a().toString(36).substr(2);if(c.length+d.length>b){c+=d.substr(0,b-c.length);break}c+=d}if(e){e=Math.round;for(var q="",l=0;l<b;l++)d=c.charAt(l),q+=isNaN(Number(d))&&(e(a())?d.toUpperCase():d.toLowerCase())||d;return q}return c};f.hot=function(b){return{h:{},l:0,c:Number(b)||500,cache:function(e,c){var a;if(void 0===c||void 0===e)return e?this.h[e]:void 0;if(this.l>this.c){var d={};var q=0;for(a in this.h)void 0===
this.h[a]||++q&&(d[a]=this.h[a]);if(q===this.c)return;this.h=d;this.l=q}this.h[e]||this.l++;return this.h[e]=c},delete:function(e){return e&&(this.h[e]=void 0)}}}}];var Ba=[function(){var h=f.nullFunc,p=require("node:fs"),t=require("node:buffer").Buffer;f.write=function(g,b,e,c){c?p.writeFile(g,"string"===typeof b?t.from(b,c):b,function(a){var d="object"===typeof e;try{if(d)e[0](a?!1:!0,a);else e(a?!1:!0,a)}catch(q){(a=d&&e.r)?a.error("[file-callback-func-crit]\n"+(q.stack||q),500):f.log("[file-callback-func-crit]\n"+
(q.stack||q))}}):e?"object"===typeof e&&e[0]?p.writeFile(g,"string"===typeof b?t.from(b):b,function(a){try{e[0](a?!1:!0,a)}catch(d){e.r?e.r.error("[file-callback-func-crit]\n"+(d.stack||d),500):f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):"function"===typeof e?p.writeFile(g,"string"===typeof b?t.from(b):b,function(a){try{e(a?!1:!0,a)}catch(d){f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):p.writeFile(g,"string"===typeof b?t.from(b,e):b,h):p.writeFile(g,"string"===typeof b?t.from(b):
b,h)};f.read=function(g,b,e){p.readFile(g,function(c,a){var d="object"===typeof b;try{if(d)b[0](c?void 0:e?a.toString(e):a,c);else b(c?void 0:e?a.toString(e):a,c)}catch(q){(c=d&&b.r)&&c.error("[file-callback-func-crit]\n"+(q.stack||q),500)}})};f.writeMore=function(g,b,e,c){c?p.appendFile(g,"string"===typeof b?t.from(b,c):b,function(a){var d="object"===typeof e;try{if(d)e[0](a?!1:!0,a);else e(a?!1:!0,a)}catch(q){(a=d&&e.r)?a.error("[file-callback-func-crit]\n"+(q.stack||q),500):f.log("[file-callback-func-crit]\n"+
(q.stack||q))}}):e?"object"===typeof e&&e[0]?p.appendFile(g,"string"===typeof b?t.from(b):b,function(a){try{e[0](a?!1:!0,a)}catch(d){e.r?e.r.error("[file-callback-func-crit]\n"+(d.stack||d),500):f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):"function"===typeof e?p.appendFile(g,"string"===typeof b?t.from(b):b,function(a){try{e(a?!1:!0,a)}catch(d){f.log("[file-callback-func-crit]\n"+(d.stack||d))}}):p.appendFile(g,"string"===typeof b?t.from(b,e):b,h):p.appendFile(g,"string"===typeof b?t.from(b):
b,h)};f.delete=function(g,b){p.unlink(g,function(e){var c="object"===typeof b;try{if(c)b[0](e?!1:!0,e);else"function"===typeof b&&b(e?!1:!0,e)}catch(a){(e=c&&b.r)?e.error("[file-callback-func-crit]\n"+(a.stack||a),500):f.log("[file-callback-func-crit]\n"+(a.stack||a))}})}},function(){function h(d,q,l,k){var n=!1,m,w,x,A;if(this[0]===h){var D=this[1];D.hostname=d;d=D;q=this[2];l=this[3];k=this[4]}D="https"===d.protocol.substr(0,5)?g:t;var G=(A=q&&"function"===typeof q[0])||"function"===typeof q;var C=
d.host;var r=C.indexOf(":");C=~r?C.substr(0,r):C;d.path||(d.path=d.pathname+(d.search||""));d.host=d.hostname;d.hostname=C;G?(r="object"===typeof l,k||!r&&(k=l),l=r&&l||f.passAgentHeaders()):l="object"===typeof q&&q||f.passAgentHeaders();G&&"identity"!==l["accept-encoding"]&&(l["accept-encoding"]="gzip, deflate");l.host||(l.host=C);d.headers=l;d=D.request(d,function(y){var E=y;if(m)if(z)if(200!=y.statusCode)z(404);else{E=m;var I=w;var L=x,J=L[2],M="1.1"===J,K=y.headers,U=I.hasOwnProperty("charset"),
O=K["content-type"].split(";"),N=K["content-length"],Q=(new Date).toUTCString();I._mtime=f.UTC(Q);I.hasOwnProperty("contentType")||(I.contentType=O[0].trim());!U&&O[1]&&(I.charset=O[1].trim());I.hasOwnProperty("status")||(I.status=200);try{E.write("HTTP/"+J+" "+I.status+"\r\nDate: "+Q+"\r\nContent-Type: "+I.contentType+(U?"; charset="+I.charset:"")+(N?"\r\nContent-Length: "+K["content-length"]:"")+"\r\nAccept-Ranges: none\r\nCache-Control: max-age=864000\r\nExpires: "+f.getGMT(864E3)+"\r\nLast-Modified: "+
Q+"\r\nServer: "+f.server+L[1]+"\r\nConnection: "+(M&&"keep-alive"||"close")+"\r\n\r\n")}catch(R){console.log("suki.get: proxyCache error\n"+(R.stack||R))}z("length",Number(y.headers["content-length"]));y.on("data",B);y.on("end",z)}else p(y,m,w,x),y.on("data",B);else G&&("gzip"===y.headers["content-encoding"]?(I=e.createGunzip(),I.on("error",u),y.pipe(I),y=I):"deflate"===y.headers["content-encoding"]&&(I=e.createInflate(),I.on("error",u),y.pipe(I),y=I),k&&y.setEncoding(k),y.on("data",B)),z&&(z.res=
E,y.on("end",z))});var u=function(y){var E;if(n)m&&(z?(z(404),console.log(y)):(y=w,y._r=x,y.error("proxy: destination network unreachable.",404)));else try{if(A)q[0](void 0,y.stack||y);else q(void 0,y.stack||y)}catch(I){(E=A&&q.r)?E.error("[get-_callback-func-crit]\n"+(I.stack||I),500):f.log("[get-_callback-func-crit]\n"+(I.stack||I),"e")}n=!0};d.on("error",u);if(G){var v="";var z=function(){if(!n){var y=z.res;y[200==y.statusCode?"data":"errorData"]=v;try{if(A)q[0](y);else q(y)}catch(E){(y=A&&q.r)?
y.error("[get-_callback-func-crit]\n"+(E.stack||E),500):f.log("[get-_callback-func-crit]\n"+(E.stack||E),"e")}}n=!0};var B=function(y){"string"===typeof y?v+=y:v=v?a.concat([v,y]):y}}else{var F=function(y){m=y._r[0];w=y;x=y._r;B=F.ed;y._file&&(z=F.ee);return!0};n=!0}d.end();return F}function p(d,q,l,k){var n=k[2],m="1.1"===n,w=d.headers,x=l.hasOwnProperty("charset"),A=w["content-type"].split(";"),D=w["content-length"],G=!D,C=w["set-cookie"],r=w.location,u=w["content-encoding"],v=w["cache-control:"],
z=w.etag,B=w.expires;l.hasOwnProperty("contentType")||(l.contentType=A[0].trim());!x&&A[1]&&(l.charset=A[1].trim());l.hasOwnProperty("status")||(l.status=d.statusCode);if(G)d.on("end",function(){q.end()});try{q.write("HTTP/"+n+" "+l.status+"\r\nDate: "+(w.date||(new Date).toUTCString())+"\r\nContent-Type: "+l.contentType+(x?"; charset="+l.charset:"")+(G?"":"\r\nContent-Length: "+D)+(r?"\r\nLocation: "+r:"")+(u?"\r\nContent-Encoding: "+u:"")+(C?"\r\nSet-Cookie: "+(Array.isArray(C)?C.join(""):C):"")+
(v||"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache")+(z?z:"")+(B?B:"")+"\r\nServer: "+(w.server||f.server)+k[1]+"\r\nConnection: "+(m&&"keep-alive"||"close")+"\r\n\r\n")}catch(F){console.log("suki.get: proxy error\n"+(F.stack||F))}}var t=require("node:http"),g=require("node:https"),b=require("node:url"),e=require("node:zlib"),c,a=require("node:buffer").Buffer;t.globalAgent&&(t.globalAgent.maxSockets=g.globalAgent.maxSockets=Infinity,g.globalAgent.options.rejectUnauthorized=
!1);f.get=c=function(d,q,l,k){var n=b.parse(d);d=String(n.hostname||n.host&&n.host.split(":")[0]||"");var m,w;if(!d)throw"suki.get: invalid hostname";if(/^[0-9.]+$/.test(d)||~d.indexOf("["))return h(n,q,l,k);if((w=(m=f.dnsCache[d])&&m[0])&&f.dnsTTL>(new Date).getTime()-m[1])return n.hostname=w,h(n,q,l,k);q=f.next(h,n,q,l,k);f.dnsLookup4(d,q);return q};c.async=function(d,q,l){c(d,l,q)}},function(){function h(k,n,m,w,x){this[0]===h&&(n=this[1],n.hostname=k,k=n,n=this[2],m=this[3],w=this[4],x=this[5]);
n||="__=";var A="https"===k.protocol.substr(0,5),D=m&&"function"===typeof m[0],G=D||"function"===typeof m;A=A?g:t;var C=!1,r="object"===typeof n,u=r&&"------WebKitFormBoundary"+f.random(16),v=u?u+"--\r\n":"",z=k.host;var B=z.indexOf(":");z=~B?z.substr(0,B):z;k.path||(k.path=k.pathname+(k.search||""));k.host=k.hostname;k.hostname=z;G?(B="object"===typeof w,x||!B&&(x=w),w=B&&w||f.passAgentHeaders()):w="object"===typeof m&&m||f.passAgentHeaders();w["content-type"]=r?"multipart/form-data; boundary="+
u.substr(2):"{"===n.charAt(0)||"["===n.charAt(0)?"application/json":"application/x-www-form-urlencoded";w.host||(w.host=z);if(r){var F="",y=0,E=[],I=[];B=null;var L=0,J,M=function(H){"isBuffer"===H?K.write(E[L]):E[L].unpipe(K);++L<E.length?(K.write("\r\n"+I[L]),l.isBuffer(E[L])?M("isBuffer"):E[L].pipe(K,a)):K.end("\r\n"+v)};for(J in n)z=n[J],"string"===typeof z?F+=u+'\r\nContent-Disposition: form-data; name="'+J+'"\r\n\r\n'+z+"\r\n":Array.isArray(z)?F+=u+'\r\nContent-Disposition: form-data; name="'+
J+'[]"\r\n\r\n'+z.join("\r\n"+u+'\r\nContent-Disposition: form-data; name="'+J+'[]"\r\n\r\n')+"\r\n":"object"===typeof z&&(l.isBuffer(z.raw)?(E.push(z.raw),B=u+'\r\nContent-Disposition: form-data; name="'+J+'"; filename="'+(z.name||J)+'"\r\n\r\n',I.push(B),y+=l.byteLength(B)+z.raw.byteLength+1):z.tmp_name&&(B=b.createReadStream(z.tmp_name,d),B.on("end",M),E.push(B),B=u+'\r\nContent-Disposition: form-data; name="'+J+'"; filename="'+(z.name||J)+'"\r\n\r\n',I.push(B),y+=l.byteLength(B)+z.size+1));y+=
l.byteLength(F)+v.length}w["content-length"]=r?y:l.byteLength(n);G&&"identity"!==w["accept-encoding"]&&(w["accept-encoding"]="gzip, deflate");k.headers=w;k.method="POST";var K=A.request(k,function(H){var S=H;if(R)N?N(404):(p(H,R,P,V),H.on("data",Q));else{if(G){if("gzip"===H.headers["content-encoding"]){var X=c.createGunzip();X.on("error",U);H.pipe(X);H=X}else"deflate"===H.headers["content-encoding"]&&(X=c.createInflate(),X.on("error",U),H.pipe(X),H=X);x&&H.setEncoding(x);H.on("data",Q)}N&&(N.res=
S,H.on("end",N))}});var U=function(H){if(C)R&&(N?N(404):(H=P,H._r=V,H.error("proxy: destination network unreachable.",404)));else try{if(D)m[0](void 0,H.stack||H);else m(void 0,H.stack||H)}catch(S){(H=D&&m.r)?H.error("[post-_callback-func-crit]\n"+(S.stack||S),500):f.log("[post-_callback-func-crit]\n"+(S.stack||S),"e")}C=!0};K.on("error",U);if(G){var O="";var N=function(){if(!C){var H=N.res;H[200==H.statusCode?"data":"errorData"]=O;try{if(D)m[0](H);else m(H)}catch(S){(H=D&&m.r)?H.error("[post-_callback-func-crit]\n"+
(S.stack||S),500):f.log("[post-_callback-func-crit]\n"+(S.stack||S),"e")}}C=!0};var Q=function(H){"string"===typeof H?O+=H:O=O?l.concat([O,H]):H}}else{var R,P,V,ea=function(H){H._file?(H=ea,Q=H.ed,N=H.ee,R=!0):(R=H._r[0],P=H,V=H._r,Q=ea.ed);return!0};C=!0}if(r)return K.write(F),E.length?(K.write(I[0]),l.isBuffer(E[0])?M("isBuffer"):E[0].pipe(K,a)):K.end(v),ea;K.write(n);K.end();return ea}function p(k,n,m,w){var x=w[2],A="1.1"===x,D=k.headers,G=m.hasOwnProperty("charset"),C=D["content-type"].split(";"),
r=D["content-length"],u=!r,v=D["set-cookie"],z=D.location,B=D["content-encoding"];m.hasOwnProperty("contentType")||(m.contentType=C[0].trim());!G&&C[1]&&(m.charset=C[1].trim());m.hasOwnProperty("status")||(m.status=k.statusCode);if(!m._file){if(u)k.on("end",function(){n.end()});try{n.write("HTTP/"+x+" "+m.status+"\r\nDate: "+(D.date||(new Date).toUTCString())+"\r\nContent-Type: "+m.contentType+(G?"; charset="+m.charset:"")+(u?"":"\r\nContent-Length: "+r)+(z?"\r\nLocation: "+z:"")+(B?"\r\nContent-Encoding: "+
B:"")+(v?"\r\nSet-Cookie: "+(Array.isArray(v)?v.join(""):v):"")+"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache\r\nServer: "+(D.server||"Node.js")+w[1]+"\r\nConnection: "+(A&&"keep-alive"||"close")+"\r\n\r\n")}catch(F){console.log("suki.get: proxy error\n"+(F.stack||F))}}}var t=require("node:http"),g=require("node:https"),b=require("node:fs"),e=require("node:url"),c=require("node:zlib"),a={end:!1},d={flags:"r",encoding:null,fd:null,mode:438},q,l=require("node:buffer").Buffer;
t.globalAgent&&(t.globalAgent.maxSockets=g.globalAgent.maxSockets=Infinity,g.globalAgent.options.rejectUnauthorized=!1);f.post=q=function(k,n,m,w,x){var A=e.parse(k);k=String(A.hostname||A.host&&A.host.split(":")[0]||"");var D,G;if(!k)throw"suki.get: invalid hostname";if(/^[0-9.]+$/.test(k)||~k.indexOf("["))return h(A,n,m,w,x);if((G=(D=f.dnsCache[k])&&D[0])&&f.dnsTTL>(new Date).getTime()-D[1])return A.hostname=G,h(A,n,m,w,x);if(k)return n=f.next(h,A,n,m,w,x),f.dnsLookup4(k,n),n};q.async=function(k,
n,m,w){q(k,n,w,m)}},function(){f.binaryToHex=function(h){var p=h.length,t="",g=0;try{if(8<p){var b=Math.floor(p/8);var e=p%8;var c=0;if(0<e)for(;0<e;e--)t+=("0"+h.charCodeAt(c++).toString(16)).slice(-2);for(;0<b;b--)t+=("0"+h.charCodeAt(c).toString(16)).slice(-2)+("0"+h.charCodeAt(c+1).toString(16)).slice(-2)+("0"+h.charCodeAt(c+2).toString(16)).slice(-2)+("0"+h.charCodeAt(c+3).toString(16)).slice(-2)+("0"+h.charCodeAt(c+4).toString(16)).slice(-2)+("0"+h.charCodeAt(c+5).toString(16)).slice(-2)+("0"+
h.charCodeAt(c+6).toString(16)).slice(-2)+("0"+h.charCodeAt(c+7).toString(16)).slice(-2),c+=8}else for(;g<p;g++)t+=("0"+h.charCodeAt(g).toString(16)).slice(-2);return t}catch{}}},function(){f.binaryToUTF8=function(h){var p="",t=0,g=0,b=h.length,e=String.fromCharCode,c=0;try{for(;c<b;++c){var a=h.charCodeAt(c);128==(a&192)?0<g&&(t=t<<6|a&63,--g):(0==g&&(p+=e(t)),128>a?(t=a,g=0):192==(a&224)?(t=a&31,g=1):224==(a&240)?(t=a&15,g=2):240==(a&248)&&(t=a&7,g=3))}0==g&&(p+=e(t));return p.substring(1)}catch{}}},
function(){f.bufferToBinary=function(h){h=h.length;var p="",t=String.fromCharCode,g=0;try{if(8<h){var b=Math.floor(h/8);var e=h%8;var c=0;if(0<e)for(;0<e;e--)p+=t(data[c++]);for(;0<b;b--)p+=t(data[c],data[c+1],data[c+2],data[c+3],data[c+4],data[c+5],data[c+6],data[c+7]),c+=8}else for(;g<h;g++)p+=t(data[g]);return p}catch{}}}]})(suki,node_modules);
