var suki=module.exports={},node_modules={fs:require("node:fs"),url_utils:require("node:url"),querystring:require("node:querystring"),os:require("node:os"),path:require("node:path")};
(function(e,Y){async function qa(r,u,v,h,d,p,c,a){var b;try{var n=await Deno.open(v);var k=await n.stat()}catch(f){n=k=null}if(b=k&&k.isFile&&k.size){r[1][r[2]]&&(r[1][r[2]]=null);r=v.substr(v.lastIndexOf(".")+1);v=d["if-modified-since"];d=e.mime.types[r]||e.mime.defaultType;r=v&&(new Date(v)).getTime();v="1.1"===h;p=(new Date).toUTCString();c=k.mtime;if(r===c.getTime())u[v?"write":"end"]("HTTP/"+h+" 304 Not Modified\r\nDate: "+p+"\r\nServer: "+e.server+"\r\nCache-Control: max-age=864000\r\nLast-Modified: "+
c.toUTCString()+"\r\nConnection: "+(v?"keep-alive":"close")+"\r\n\r\n");else u.write("HTTP/"+h+" 200\r\nDate: "+p+"\r\nContent-Type: "+d+"\r\nContent-Length: "+k.size+"\r\nAccept-Ranges: none\r\nServer: "+e.server+"\r\nCache-Control: max-age=864000\r\nLast-Modified: "+c.toUTCString()+"\r\nConnection: "+(v?"keep-alive":"close")+"\r\n\r\n").streamFrom(n);return!0}0===b&&n.close();if(a)return r[0](),!0;try{n=await Deno.open(v+p),k=await n.stat()}catch(f){n=k=null}if(b=k&&k.isFile&&k.size)return r[0](n,
k,!1),!0;0===b&&n.close();try{n=await Deno.open(v+c),k=await n.stat()}catch(f){n=k=null}if(b=k&&k.isFile&&k.size)return r[0](n,k,!0),!0;0===b&&n.close();r[6].error("No such file(1).",404);return!0}async function ra(r,u,v){var h=this[3],d=this[1],p=this[2],c=this[6],a=this[5],b=this[7],n=d[4],k=n[p],f;if(!r)try{r=await Deno.open(p+h),u=await r.stat()}catch(g){r=u=null}if(!v){var m=u&&u.isFile&&u.size?u.mtime.getTime():0;if(k&&m===k.ts[0])return k.ck=!1,k.ts[1]=(new Date).getTime(),a(k,c),r&&r.close(),
!0;if(m){try{await r.read(f=new Uint8Array(u.size)),k=n[p]=this[8](Z.decode(f),b,aa(p+h)),k.ts=[m,(new Date).getTime()],c._r[6]=!1,a(k,c)}catch(g){c.error("Updating script failed(1).",500)}r.close();return!0}}r&&r.close();k=n[p]={cs:d[16]};k.ts=[m,(new Date).getTime()];c._r[6]=!1;c.flush();return!0}async function sa(){var r=this[3],u=this[1],v=this[2],h=this[6],d=this[5],p=this[7],c=u[4],a=c[v];try{var b=await fetch(v+r)}catch(n){return h.error("NCS network error.")}if(r=b.ok&&(b.headers.get("Last-Modified")||
1)||0){if(a&&r===a.ts[0])a.ck=!1,a.ts[1]=(new Date).getTime(),d(a,h);else try{a=c[v]=this[8](await b.text(),p),a.ts=[r,(new Date).getTime()],h._r[6]=!1,d(a,h)}catch(n){h.error("Updating script failed(2).",500)}return!0}this[0]=ha;d=await this[0]();d.fn?(a=c[v]={cs:u[16]},a.ts=[r,(new Date).getTime()],h._r[6]=!1,h.flush()):d.error?h.error("View renderring error.\n"+d.error,500):h.error("View file not exists.",404);return!0}async function ta(r,u){var v=this[1],h=this[6];r=r||h._r[5];h=v[18];var d,p;
try{var c=await Deno.open(r);var a=await c.stat()}catch(n){c=a=null}var b=a&&a.isFile&&a.size?a.mtime.getTime():0;if((d=h[r])&&b===d.mtime)return c.close(),u&&("function"===typeof u?u(d):u[0](d)),d;if(b){d={mtime:b};try{await c.read(p=new Uint8Array(a.size)),d.fn=v[19](Z.decode(p)),h[r]=d}catch(n){d.error=n.stack}}else d={};c&&c.close();u&&("function"===typeof u?u(d):u[0](d));return d}async function ha(r,u){var v=this[1],h=this[6];r=r||h._r[5];var d=v[18];try{var p=await fetch(r.replace("#","%23"))}catch(a){return h.error("NCS network error(view).")}var c=
p.ok&&(p.headers.get("Last-Modified")||1)||0;if((h=d[r])&&c===h.mtime)return u&&("function"===typeof u?u(h):u[0](h)),!0;if(c){h={mtime:c};try{h.fn=v[19](await p.text()),d[r]=h}catch(a){h.error=a.stack}}else h={};u&&("function"===typeof u?u(h):u[0](h));return!0}function ua(){function r(l,q,t,y){var B=x,F=B[0],w=q[1],D=w.indexOf("?"),H=~D&&w.substr(D+1);w=~D&&w.substr(0,D)||w;D=t.host||"*";var L;if(!(L=B[9][D])){L=D.indexOf(":");var J=~L&&D.substr(0,L)||D;L=J.substr(0,J.indexOf("."));J=x[9][J]||x[9][J.replace(L,
"*")]||x[9]["*"];~J.indexOf("*")&&(J=J.replace(I,L));E===A?(A=0,x[9]={},x[9][D]=J):E>A++&&(x[9][D]=J);L=J}D=L;var M=D.indexOf(" ");L=0===M?"":D.substring(M+1);J=B[15];var K=J.length,U=B[1],O=(new Date).getTime(),N=q[2].substr(5);D=0===M?D.trimLeft():D.substring(0,M);this._args=[q,t,y];if(~w.indexOf("%"))try{w=decodeURIComponent(w)}catch(V){return this._r=C(l,"",N),this.error("Invalid unicode character in URL.",400)}"/"===w.charAt(w.length-1)&&(w=w+"index"+J);q=w.slice(-K);if(B[2]&&F._defend(F.getIP(t),
B[2]))return this._r=C(l,"",N),this.error("Block settings taking effect to prevent insecurity access.",404);K=(q=J===q)?w.substr(0,w.length-K):w;M=D+K;if(H){t.querystring=H;try{var Q=B[5](H,"&")}catch(V){e.log("HTTP QUERYSTRING parsing error: \n"+H+"\n"+V.stack,"e"),Q=B[10]}}if(t.cookie)try{var R=B[5](t.cookie,"; ")}catch(V){e.log("HTTP COOKIE parsing error: \n"+t.cookie+"\n"+V.stack,"e"),R=B[10]}if(y&&fa(y))if(t["content-type"]&&~t["content-type"].indexOf("application/dns-message"))var P={dns:y};
else try{P=Z.decode(y),P="{"===P.charAt(0)||"["===P.charAt(0)?JSON.parse(P):B[5](P)}catch(V){P=y}y=[Q||B[10],R||B[10],P||B[10],t];this._r=[l,"",N,O,K,M+B[1],!0,{suki:F,_server:t,_get:y[0],_post:y[2],_cookie:y[1]},!1,!0,!0,[null,B,M,J,U,u,this,L||D,g]];if(F=B[4][M]){y=F.ts;if(F.ck||B[3]>O-y[1]){u(F,this);return}F.ck=!0}this._r[9]=!1;if("/"===w.slice(-1)||~w.replace("\\","..").indexOf("..")||~w.indexOf(".sjs."))this.error("Please examine the config of WebServer to prevent this issue of security(1).",
404);else if(F=this._r[11],~F[7].indexOf("://")&&(F[7]=""),(y=~D.indexOf("://"))?(D=L,F[0]=sa):F[0]=ra,q)F[0]();else if(B[1]===w.slice(-J.length-5)||B[17]===w.slice(-B[17].length)||B[11].test(w))this.error("Please examine the config of WebServer to prevent this issue of security(2).",404);else if(D)qa(F,l,D+w,N,t,J,U,y);else F[0]()}function u(l,q){var t=q._r[7];l.cs(q,t,t._get,t._post,t._cookie,t._server)}function v(l,q){var t=z;void 0!==this.skid||(this.skid=t[0].id?"-"+t[0].id:"-suki");if(void 0===
l||l)p(this,l,[h,this]);else if(fa(q)){l=this._r;t=z;var y=new Date;var B=l[2];var F="1.1"===B;var w=this.contentType;var D=y.getTime()-l[3];try{l[0].write("HTTP/"+B+" "+this.status+"\r\nDate: "+y.toUTCString()+(l[10]?"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache":"")+"\r\nContent-Type: "+w+(this.hasOwnProperty("charset")?"; charset="+this.charset:"text"===w.substr(0,4)&&"; charset="+this.charset||"")+"\r\nContent-Length: "+q.byteLength+"\r\nServer: "+t[0].server+
l[1]+(this.sendET&&isNaN(D)&&"\r\nX"+this.skid+": N/A"||"\r\nX"+this.skid+": "+D)+(l[6]&&", 1"||", -1")+"\r\nConnection: "+(F?"keep-alive":"close")+"\r\n\r\n",this.encoding),l[0][F&&"write"||"end"](q),this._r=null}catch(H){e.log("Socket Writing Error.\n"+(H.stack||H),"e")}}else d("string"===typeof q?q:q&&String(q)||"",!0,this)}function h(l){var q=this[1];l.fn?d(l,!0,q):q.error("view file not exists.(1)",404)}function d(l,q,t){var y=t._r,B=z,F=new Date;try{var w="string"===typeof l?l:l.fn(y[7])}catch(K){return t.error("[template renderring error]\n"+
(K.stack||K),500)}l=y[2];var D="1.1"===l;if("string"===typeof w){var H=t.contentType;var L=""!==w&&t.eid;var J=t.json;var M=F.getTime()-y[3];L&&"text/javascript"!==H&&(H="text/javascript",J.html=~w.indexOf("\n")?w.replace(B[9],""):w,w='window["'+L+'"]='+JSON.stringify(J)+";");try{y[0][D&&"write"||"end"]("HTTP/"+l+" "+t.status+"\r\nDate: "+F.toUTCString()+(y[10]?"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache":"")+"\r\nContent-Type: "+H+(t.hasOwnProperty("charset")?
"; charset="+t.charset:"text"===H.substr(0,4)&&"; charset="+t.charset||"")+"\r\nContent-Length: "+ba.encode(w).length+"\r\nServer: "+B[0].server+y[1]+(t.sendET&&isNaN(M)&&"\r\nX"+t.skid+": N/A"||"\r\nX"+t.skid+": "+M)+(q&&y[6]&&", 1"||(q?", -1":", -2"))+"\r\nConnection: "+(D?"keep-alive":"close")+"\r\n\r\n"+w,t.encoding),t._r=null}catch(K){console.log("Socket Writing Error.\n"+(K.stack||K))}return t}return t.error("template rendering error",500)}function p(l,q,t){var y=l._r;if(void 0===q)l=y[5];else if("string"===
typeof q)l=~q.indexOf("://")?q:q.isAbs()?ia(y[5],q):y[5].replace(l.tpE,"#"+q+l.tpE);else return t[1].error("Invalid template branch: "+String(q)+", omit or set to {undefined} for main template rendering.");if(f[l]&&y[9])t[0](f[l]);else y=y[11],y[0]=~l.indexOf("://")?ha:ta,y[0](l,t)}function c(l){if(l.error)this[1].error(l.error);else{a:{try{var q=l.fn(this[1]._r[7])}catch(t){l=[void 0,"template rendering error"+(t.stack||t)];break a}l=[q,null]}l[0]?"function"===typeof this[2]?this[2](l[0],this[1]):
this[2][0](l[0],this[1]):this[1].error(l[1])}}function a(){return""}var b=r.prototype,n=ja,k=1E4,f={},m=ka,g;da=r;W=function(l,q){var t=la;l&&("aliasHostHeader"===l?(t.preferAliasHost=!0,t.aliasHostHeader=String(q).trim().toLowerCase()):"checkInterval"===l?k=x[3]=q:"csBuilder"===l?g=q:(b[l]=q,"_f"===l&&(x[2]=q)));return da};b.tpE=e.init[2];b.csE=e.init[3];b.status="200";b.charset="UTF-8";b.encoding="utf8";b.contentType="text/html";b.sendET=b._g=b._f=!1;b.eso="";b.proxy="";b.cacheProxy=b.proxyCache=
"";b.error="";b.proxySendFile=!1;b.sendFileDir="";b.sendFileHeader="X-Accel-Redirect";b.buffer="";b.getTplVals=function(){return this._r[7]};b.setContentType=function(l){this.contentType=l;return this};b.flush=v;b.header=function(l){var q=this._r;q[1]+="\r\n"+l;q[10]&&(~l.indexOf("xpires:")||~l.indexOf("ontrol:"))&&(q[10]=!1);return this};b.redirect=function(l,q){var t=this.eid;this._r[1]+="\r\nLocation: "+(t?l+(~l.indexOf("?")?"&":"?")+"__eso="+t.substr(1):l);this.status=q||"302";return this.flush(!1)};
b.setCookie=function(l){if(this.eid){var q=this.json;var t=q.cookie;l=e.creatCookieHeader(l);t?"string"===typeof t?q.cookie=[t,l]:t.push(l):q.cookie=l}else this._r[1]+="\r\n"+e.creatCookieHeader(l);return this};b.deleteCookie=function(l,q){l="Set-Cookie: "+l+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT"+(q?"; domain="+q:"");var t;this.eid?(q=this.json,(t=q.cookie)?"string"===typeof t?q.cookie=[t,l]:t.push(l):q.cookie=l):this._r[1]+="\r\n"+l;return this};b.deleteCookies=function(l,q){var t="Set-Cookie: "+
l+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT"+(q?"; domain="+q:"");l="Set-Cookie: "+l+"=deleted; expires=Thu, 09 May 1990 09:17:25 GMT; path=/"+(q?"; domain="+q:"");var y;this.eid?(q=this.json,(y=q.cookie)?"string"===typeof y?q.cookie=[y,t,l]:y.push(t,l):q.cookie=[t,l]):this._r[1]+="\r\n"+t+"\r\n"+l;return this};b.next=function(){arguments.R=arguments.r=this;return arguments};b.session=function(l,q){var t;if(this.eid)return this;q||=!0===l;(t=this._r[7]._cookie.SJSSESSIONID)?this.session=t:
(t=this.session=e.MD5(this._r[3]+Math.random().toString()),this.setCookie({name:"SJSSESSIONID",value:t,hours:!0!==l&&0<l&&l,secure:q,http:!0}));return this};b.sendFile=function(l,q){var t=this._r,y=new Date,B=t[2],F="1.1"===B;if(!t)return void 0===t?this.error("flush(): invalid 'this'."):this;if(l.isAbs()&&m(l)){q||="application/force-download";if(!~q.indexOf("/")){var w=q;q="application/force-download"}t[0][F&&"write"||"end"]("HTTP/"+B+" 200\r\nDate: "+y.toUTCString()+"\r\nContent-Type: "+q+"\r\nContent-Length: "+
fs.statSync(l).size+("application/force-download"===q?"\r\nContent-Disposition: attachment; filename="+(w||path.basename(l)):"")+"\r\nServer: "+e.server+t[1]+(this.sendET?"\r\nX-SR: "+(y-t[3]):"\r\nX-SR: N/A")+(t[6]?", 1":", -1")+"\r\nConnection: "+(F?"keep-alive":"closed")+"\r\n\r\n",this.encoding);fs.createReadStream(l).pipe(t[0]);this._r=null}else return this.error("No such file : "+l,404);return this};var x=[e,b.tpE,b._f,k,{},ma,null,v,e.init[0],e.init[1],e.nullObj,RegExp("\\.\\.|\\\\|\\/\\/|\\/_suki"),
m,null,RegExp("\\/","g"),b.csE,function(l){l.flush()},e.moduleExtention,f,n],z=Array(9);z[0]=e;z[9]=/[\f\n\r\t\v]/g;b.getFlush=function(l,q){void 0===q?p(this,q,[c,this,l]):p(this,l,[c,this,q]);return this};e.getRender=function(l){try{var q=z[6](l)}catch(t){q=a}return q};e.render=function(l,q){try{var t=q(l)}catch(y){t=""}return t};var A=0,E=3E3,I=RegExp("\\*","g");try{var C=new Function("...a","return a")}catch(l){C=function(){return arguments}}}function va(){function r(a){var b=a.length,n=1,k;this.got=
[!1,null,0,[],0,0,!1];for(this.post={};n<b;n++){var f=a[n].indexOf("\r\n\r\n");if(!~f){this.got[0]=!0;break}var m=a[n].substring(0,f);f=a[n].substr(f+4);this.got[2]++;var g=m.indexOf("name=")+6;var x=m.indexOf('"',g);g=m.substring(g,x);var z=m.indexOf("filename=");x=~z;var A=this.post;(k="[]"===g.slice(-2))&&(g=g.slice(0,-2));if(x){this.got[4]++;var E=m.indexOf('"',z+10);m=m.substring(z+10,E);m={name:m,size:f.length-2,error:!1,purge:v};m.tmpName=path.normalize(c+"/sukijs_"+g+"."+e.random(10)+"."+
(new Date).getTime());c&&f?(m._fs=fs.createWriteStream(m.tmpName,p),u(m,this.got),this.got[3].push(m._fs),"\r\n"===f.slice(-2)?(f=f.slice(0,-2),m._fs.end(f,"binary")):m._fs.write(f,"binary")):(m.tmpName="",m.error=!0);f=m}else f=f.slice(0,-2),f=65537>f.length&&this.binaryToUTF8(f)||"";k?(A[g]||(A[g]=[]),A[g].push(f)):A[g]=f;n===b-1&&(this.last=[g,x])}}function u(a,b){setTimeout(function(){a._finished?fs.unlink(a.tmpName,d):(a.error=!0,a.tmpName="",a.size=0,a._fs.end())},3E4);a._fs.on("error",function(){a.error||
(a.error=!0,a.tmpName="",a.size=0,a._fs.end())});a._fs.on("finish",function(){a._finished=!0;a.error&&(b[6]=!0,fs.unlink(a.tmpName,d));++b[5]===b[4]&&b[0]&&(b[3].length=0,b[1]&&b[1](),b.length=0)})}function v(){fs.unlink(this.tmpName,d)}var h=na={},d=e.nullFunc,p={mode:438,flag:"r+"},c=e.init[4];h.initPost=function(a,b,n,k,f,m,g,x){var z=Number(f["content-length"]),A=f["content-type"]||"",E;A=(0===A.indexOf("application/x-www-form-urlencoded")||0===A.indexOf("application/json")||0===A.indexOf("application/dns-message"))&&
0<z||"multipart/form-data"===A.substr(0,19)&&(E=A.split("="))&&2===E.length&&E[1];m=x-(m.length||0);g=g-m-4;m=-1<g&&b.slice(m+4);g=z===g;if(A&&z)if(!0===A&&g)a._b=0,new n(a,k,f,m);else if(g){var I=new r(b.toString("binary").split("--"+A));a._b=0;I.got[1]=function(){new n(a,k,f,I.post)}}else a.raw=m,a._p=[k,f],E?(a.maxUploadSize=104857600,a.__b=A,a._b=65537):a._b=z;else a._b=-1,a.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : Not support for This so called 'HTTP-POST'..."),e.log("Net socket denied.(Not support for This so called 'HTTP-POST'...)",
"n")};h.post=function(a,b,n,k){var f=a.raw,m=f.length,g=e.creatBuffer(b.length+m);if(void 0!==f.length&&0<k&&65537>k)f.copy(g,0,0),b.copy(g,m,0),k===g.length?(a._b=0,new n(a,a._p[0],a._p[1],g)):a.raw=g;else if(65537===k)h._upload(a,b,n);else{a.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : BAD POSTING REQUEST.");try{b.length=0,a.destroy()}catch{}}};h._upload=function(a,b,n){var k=a._uploader;if(k)if(100<k.got[2]||a._uploaderL>a.maxUploadSize)a._b=-1,a.end("HTTP POST too Large!"),k.got[1]=null,console.log("HTTP POST too Large!\nForbidden for ever on this actived socket.");
else{var f=b.toString("binary");k.add(f.split("--"+a.__b),b);k.got[0]?(a._b=0,a._uploader=null,k.got[4]?k.got[1]=function(){new n(a,a._p[0],a._p[1],k.post)}:new n(a,a._p[0],a._p[1],k.post)):a._uploaderL+=b.length}else{var m=a.raw;var g=m.length;f=e.creatBuffer(b.length+g);m.copy(f,0,0);b.copy(f,g,0);b=a.__b;m=f.toString("binary");k=new r(m.split("--"+b));k.got[0]?(a._b=0,k.got[4]?k.got[1]=function(){new n(a,a._p[0],a._p[1],k.post)}:new n(a,a._p[0],a._p[1],k.post)):(a._uploaderL=f.length,a._uploader=
k)}};r.prototype.add=function(a,b){var n=a.length,k=this.last[0],f;if(1<n){if(this.last[1]&&a[0]){var m=this.post[k];Array.isArray(m)&&(m=m[m.length-1]);m.size+=a[0].length;c&&("\r\n"===a[0].slice(-2)&&(a[0]=a[0].slice(0,-2)),m._fs.end(a[0],"binary"))}for(k=1;k<n;k++){b=a[k].indexOf("\r\n\r\n");if(!~b){this.got[0]=!0;break}m=a[k].substring(0,b);b=a[k].substr(b+4);this.got[2]++;var g=m.indexOf("name=")+6;var x=m.indexOf('"',g);g=m.substring(g,x);var z=m.indexOf("filename=");x=~z;var A=this.post;(f=
"[]"===g.slice(-2))&&(g=g.slice(0,-2));if(x){this.got[4]++;var E=m.indexOf('"',z+10);m=m.substring(z+10,E);m={name:m,size:b.length-2,error:!1,purge:v};m.tmpName=path.normalize(c+"/sukijs_"+g+"."+e.random(10)+"."+(new Date).getTime());c&&b?(m._fs=fs.createWriteStream(m.tmpName,p),u(m,this.got),this.got[3].push(m._fs),"\r\n"===b.slice(-2)?(b=b.slice(0,-2),m._fs.end(b,"binary")):m._fs.write(b,"binary")):(m.tmpName="",m.error=!0);b=m}else b=b.slice(0,-2),b=65537>b.length&&this.binaryToUTF8(b)||"";f?(A[g]||
(A[g]=[]),A[g].push(b)):A[g]=b;k===n-1&&(this.last=[g,x])}}else m=this.post[k],this.last[1]?(Array.isArray(m)&&(m=m[m.length-1]),m.size+=b.length,c&&m._fs.write(b)):(a=m+a[0],this.post[k]=65537>a.length&&this.binaryToUTF8(a)||"")};r.prototype.binaryToUTF8=e.binaryToUTF8}function wa(){var r=la={},u={GET:!0,POST:!0};oa=function(v,h){var d=h._b,p=1,c=da,a=na,b,n;if(Number(d))a.post(h,v,c,d);else{var k=v.length;var f=(d||"")+Z.decode(v);var m=f.indexOf("\r\n\r\n");var g=f.substring(0,4).trim();var x=
e.rewriteRules;if(u[g])if(~m){var z=f.substring(0,m).trim();var A=ba.encode(z).length;var E=z.length===A;var I=z.split("\r\n");var C=I.length;if((n=1<C&&I[0].trim().split(" "))&&3===n.length){for(f={};p<C;p++){var l=I[p];var q=l.indexOf(":");if(~q)f[l.substring(0,q).trim().toLowerCase()]=l.substring(q+1).trim();else{f=null;break}}r.preferAliasHost&&f[r.aliasHostHeader]&&(f["x-real-host"]=f.host)&&(f.host=f[r.aliasHostHeader]);x&&(n[1]=e.rewriteURL(n[1]))}else f=null;f&&E||f.referer&&z.length-f.referer.length===
A-(b=ba.encode(f.referer).length)?(f["remote-addr"]=h.remoteAddr,f.url=n[1],f.method=g,b&&b!==f.referer.length&&(f.referer=encodeURIComponent(f.referer)),"GET"===g?(h._b=0,new c(h,n,f,null)):a.initPost(h,v,c,n,f,d,k,m)):_reInit(h,f&&n[2],f&&n[1],!E)}else 8192<f.length?(h._b=-1,h.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : HTTP header too long! limited "+f.length+"."),console.log("HTTP header too long!"+f.length+"\nForbidden for ever on this actived socket.")):h._b=f;else h._b=-1,h.end("HTTP/1.0 400\r\n\r\nILLEGAL PROTOCOL : Not support for this method.\r\nSituation is logged."),
console.log("\r\nNot support for this method ("+g+").\r\n"+h.remoteAddr.hostname+"\r\n",f)}}}function xa(){var r=e.less,u=r?new r.Parser:!1,v={};r=d=>{v[d]=!0};var h=[/[\s;]*$/,/\/\*.*?\*\/|'[^']*'|"[^"]*"|\.[\$\w]+/g,/[^\$\w\d]+/,/^\d/,/[\f\n\r\t\v]/g,/<(script.*?>)([\s\S]*?)<\/(script)/gi,RegExp("\x3c!--.*?--\x3e","g"),/(`\{|\{)[\s]*?\[[\s]*?#[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})(.*)(\1)[\s]*?\[[\s]*?\/[\s]*?(\2)[\s]*?\][\s]*?(\3)/g,/(`\{|\{)[\s]*?\[[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})/g,/\\'/g,/s\+='s\+=/g,
/(`\{|\{)[\s]*?\[[\s]*?(\.|this)[\s]*?\][\s]*?(\}`|\})/g,/(`\{|\{)[\s]*?\[[\s]*?(.*?)[\s]*?\][\s]*?(\}`|\})/g,/<(style[^>]+?less|style)(.*?)<\/style>/gi,/\/\/.*/g,RegExp("\\/\\*[\\s\\S]*?\\*\\/","g"),function(d,p,c,a){d=h;c=c.replace(d[19],"</scri_pt>>").replace(d[20],"<<scri_pt>");return"<"+p+c.replace(d[24],":\\/\\/").replace(d[14],"").replace(d[15],"").replace(d[25],d[28])+"</"+a},function(d,p,c,a){var b=c.indexOf(">");d=h;c=c.replace(h[23],"");if(u&&~p.toLowerCase().indexOf("less")&&~b){var n=
c.substr(b+1);p=p.replace(" less","");u.parse(n,function(k,f){c=c.substr(0,b)+">"+(k?n:f.toCSS({compress:!0}))})}return"<"+p+c.replace(d[25],d[28])+"</style>"},function(d,p,c,a,b){return"';var i=0,l=o."+c+".length,d=o."+c+";for(;i<l;i++){s+='"+b.replace(h[11],"'+d[i]+'").replace(h[12],"'+(d[i]['$1']||('undefined'===typeof $1?'':$1))+'")+"'}s+='"},RegExp("\x3c!--","g"),/--\x3e/g,/<\/scri_pt>>/g,/<<scri_pt>/g,RegExp("\\/\\*.*?\\*\\/","g"),RegExp(":\\/\\/","g"),/([^\\])\\([^\\])/g,/<style|<less/i,/<script/i,
function(d,p,c){return p+"\\\\"+c},/^[a-zA-Z0-9_$]+$/,/s\+='';/g,/^[\s]*?=[\s]*?/];"Math JSON encodeURI encodeURIComponent decodeURI decodeURIComponent escape unescape eval isNaN isFinite parseInt parseFloat null undefined NaN Infinity Object Array Function Boolean String Number Date RegExp Error".split(" ").forEach(r);"break case catch continue debugger default delete do else false finally for function if in instanceof new return switch this throw true try typeof var void while with const".split(" ").forEach(r);
"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile arguments let yield".split(" ").forEach(r);ja=function(d){d=d.replace(/\\/g,"\\\\");var p={},c="",a=h,b=function(k){if(k&&!v[k]&&!a[3].test(k)&&!p[k]){if("s"===k||"o"===k)throw"There must not be '"+k+"' in template as it is taken internally.";p[k]=!0;c+=","+k+"=o."+k+"||(0===o."+k+"?'0':'')"}},
n=a[27].exec(d);(n&&=d.indexOf(n[0]))&&(d=d.substr(0,n)+d.substr(n).replace(a[5],a[16]));d=d.replace(a[4],"");(n=a[26].exec(d))&&(n=d.indexOf(n[0]))&&(d=d.substr(0,n)+d.substr(n).replace(a[13],a[17]));n=d.indexOf("\x3c!--");~n&&(d=d.substr(0,n)+d.substr(n).replace(a[6],"").replace(a[21],"\x3c!--").replace(a[22],"--\x3e"));d=d.split("'").join("\\'").replace(a[7],a[18]).replace(a[8],function(k,f,m){f=m.replace(a[9],"'");f=f.trim();k="="===f.charAt(0)||a[29].test(f)?"';s+="+f.replace(a[31],"").replace(a[0],
"")+";s+='":"';"+f+";s+='";f=f.replace(a[1],"");f.split(a[2]).forEach(b);return k})+"';return s;";d="var s=''"+c+";"+("s+='"+d).replace(a[10],"s+=");return new Function("o",d.replace(a[30],""))}}function ya(){var r={500:["500 Internal Server Error","Current service is temporarily unavailable."],502:["502 Bad gateway","Networking is temporarily unavailable."],503:["503 Service Unavailable","Server is busy, pleas try again later."],400:["400 Bad Request","Invalid HTTP request."],403:["403 Forbidden",
"Access Denied."],404:["404 Not Found","The requested URL is not found on this server."]};da.prototype.error=function(u,v){var h=this._r;if(h&&h.length){this.status=v||"500";this.contentType="text/html";v=this.flush;u=String(u||"");var d=String(this.status),p=r[d];u=p&&"<!DOCTYPE HTML><html><head><title>"+(p&&p[0]||d)+'</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><style>html, body{margin:0 16px;padding:0;font-family:Varela Round,Helvetica,Arial,sans-serif;font-size:16px;line-height:26px}body{background:#fff;color:#222}h1{color:#205080;font-size:20px;font-weight:100;letter-spacing:0.2ex;text-shadow:#d0e0ea 0 1px;line-height:40px;border-bottom:2px solid #c0d0e0}h1:before{content:"";content:"\\203a\\2002"}div{font-size:12px;background:#cccccc;padding:5px;padding-left:10px}</style></head><body><h1>'+
(p&&p[0]||d)+"</h1><p>"+(p&&p[1]||"")+"</p><div><p><strong>Detail:</strong></p><p>"+u.replace("<","&lt;").replace(">","&gt;").replace(/\n|\r\n/g,"<br>")+"</p><div></body></html>"||u;v.call(this,null,u);h.length=0}else u=String(u).replace(/<br>/gi,"\r\n"),e.log("a sync error occured after REST.flush() SO it would not display on webpage: \r\n"+u,"c");return this}}var ca=class{static parse=null;static listen(r,u){ca._connLoop(Deno.listen({port:r,hostname:u,transport:"tcp"}))}static async _connLoop(r){for await(let u of r)ca._packetLoop(u)}static async _packetLoop(r){var u=
new za(r);for await(let v of r.readable)ca.parse(v,u)}};var za=class{_sock=null;_textEncoder=ba;remoteAddr="";_b=0;constructor(r){this._sock=r;this.remoteAddr=r.remoteAddr.hostname}write(r){"string"===typeof r?this._sock.write(this._textEncoder.encode(r)):this._sock.write(r);return this}async end(r){r&&await ("string"===typeof r?this._sock.write(this._textEncoder.encode(r)):this._sock.write(r));this._sock.close()}streamFrom(r){r.readable.pipeTo(this._sock.writable,{preventClose:!0})}};var aa,ka,ma,
fa,ia,Z,ba,pa,T;!async function(){if("undefined"===typeof require){var r=(await MODULE).createRequire;T=r(IMU)}else T=require;r=Y.fs;var u=Y.url_utils,v=Y.querystring,h=Y.os;aa=Y.path.normalize;ka=r.existsSync;ma=v.parse;ia=u.resolve;pa=h.tmpdir();fa=ArrayBuffer.isView;Z=new TextDecoder;ba=new TextEncoder;!0;"function"===typeof e.init&&e.init()}();e.MIME=e.mime={types:{html:"text/html",htm:"text/html",shtml:"text/html",css:"text/css",xml:"text/xml",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",
js:"application/javascript",atom:"application/atom+xml",rss:"application/rss+xml",mml:"text/mathml",txt:"text/plain",jad:"text/vnd.sun.j2me.app-descriptor",wml:"text/vnd.wap.wml",htc:"text/x-component",png:"image/png",tif:"image/tiff",tiff:"image/tiff",wbmp:"image/vnd.wap.wbmp",ico:"image/x-icon",jng:"image/x-jng",bmp:"image/x-ms-bmp",svg:"image/svg+xml",svgz:"image/svg+xml",webp:"image/webp",woff:"application/font-woff",jar:"application/java-archive",war:"application/java-archive",ear:"application/java-archive",
json:"application/json",hqx:"application/mac-binhex40",doc:"application/msword",pdf:"application/pdf",ps:"application/postscript",eps:"application/postscript",ai:"application/postscript",rtf:"application/rtf",m3u8:"application/vnd.apple.mpegurl",xls:"application/vnd.ms-excel",eot:"application/vnd.ms-fontobject",ppt:"application/vnd.ms-powerpoint",wmlc:"application/vnd.wap.wmlc",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz","7z":"application/x-7z-compressed",cco:"application/x-cocoa",
jardiff:"application/x-java-archive-diff",jnlp:"application/x-java-jnlp-file",run:"application/x-makeself",pl:"application/x-perl",pm:"application/x-perl",prc:"application/x-pilot",pdb:"application/x-pilot",rar:"application/x-rar-compressed",rpm:"application/x-redhat-package-manager",sea:"application/x-sea",swf:"application/x-shockwave-flash",sit:"application/x-stuffit",tcl:"application/x-tcl",tk:"application/x-tcl",der:"application/x-x509-ca-cert",pem:"application/x-x509-ca-cert",crt:"application/x-x509-ca-cert",
xpi:"application/x-xpinstall",xhtml:"application/xhtml+xml",xspf:"application/xspf+xml",zip:"application/zip",msi:"application/octet-stream",msp:"application/octet-stream",msm:"application/octet-stream",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",mid:"audio/midi",midi:"audio/midi",kar:"audio/midi",mp3:"audio/mpeg",
ogg:"audio/ogg",m4a:"audio/x-m4a",ra:"audio/x-realaudio","3gpp":"video/3gpp","3gp":"video/3gpp",ts:"video/mp2t",mp4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",mov:"video/quicktime",webm:"video/webm",flv:"video/x-flv",m4v:"video/x-m4v",mng:"video/x-mng",asx:"video/x-ms-asf",asf:"video/x-ms-asf",wmv:"video/x-ms-wmv",avi:"video/x-msvideo"},defaultType:"application/octet-stream"};var da,W,na,oa,la,ja;e.server="suki";e.extention=".sjs";e.moduleExtention=".sjs.js";e.nullObj=Object.freeze({});e.nullFunc=
function(){}.bind(e.nullObj);(function(){function r(g){g=g||{};var x=Number(g.ports||g.port),z=x&&"port"||"",A=e.root=g.webRoot?v(g.webRoot):{"*":"*"},E=e.extention+".html",I;var C=0;var l=[!1,["127.0.0.1","10.8.*.*"]];if(c)return a.log("Duplicated initialization ignored."),this;c=!0;e.version||(e.version="");e.password="public-defualt-8NJzmhSCpQutF7EY6E6WdxrRy9txtN93";e.salt="8NJzmhSCpQutF7EY6E6WdxrRy9txtN93";C=Math.floor(Number(C));e.timeZoneString=-12<C&&12>C?("+0"+String(C)).replace("0-","-0").replace("00",
"0").replace("010","10").replace("011","11").replace("+-","-")+":00":"+00:00";e.timeZoneOffset=0<C<12?3600*C||0:0;if(z&&null===e.root)e.log("Invalid webRoot config.","e");else{e.unlocked=!0;e._locker=0;if(!A["*"]){C=Object.keys(A)[0];var q=A[C];if(q)A["*"]=q,a.log("no [*] sets, specify "+q+" (which hosts "+C+") as default webRoot.");else return e.log("Invalid config on webRoot.","c"),this}e.init=["",A,E,e.extention,g.tmp&&aa(g.tmp)||pa,null];e.tmpdir=e.init[4];e.logfile=e.init[5]=g.logfile&&path.normalize(g.logfile)||
null;for(t of Aa)t();l[0]&&e.nextTick(function(){e.allow(l[1]);a.log("built-in firewall initialized;")});for(I of Ba)I();va();wa();xa();ua();ya();W("sendET",!0);W("csBuilder",h);g._sendFileDir&&W("sendFileDir",g._sendFileDir);g._sendFileHeader&&W("sendFileHeader",g._sendFileHeader);g._proxySendFile&&W("proxySendFile",g._proxySendFile);var t=g._hotCodeDelaySeconds;"number"===typeof t&&(Infinity===t||/^[0-9]+$/.test(t.toString()))&&W("checkInterval",1E3*t);g._aliasHostHeader&&W("aliasHostHeader",g._aliasHostHeader);
e.version||(e.version="suki.js_v11.0.16");"port"===z&&(ca.listen(x,g.bind||"::"),ca.parse=oa,e.log(e.dateFormat(new Date)+" UTC\ndeno_v"+Deno.version.deno.replace("v","")+"\n"+e.version+" Javascript Application Server (HTTP listening on "+(g.bind||"::")+":"+x+")  \r\n"));return u}}function u(g){g(e)}function v(g){function x(I){var C="",l="",q="undefined"===typeof fetch;Array.isArray(I)&&("string"===typeof I[0]&&(C=I[0]),"string"===typeof I[1]&&(l=I[1]));"string"===typeof I&&(C=I);if("http://"===C.substring(0,
7)||"https://"===C.substring(0,8)){if(q)return e.log("Invalid remote webRoot: "+C+" (runtime has no fetch api so networking webRoot could not be used)","e"),null;"/"===C.slice(-1)&&(C=C.slice(0,-1));if(~C.indexOf(" "))return e.log("Invalid remote webRoot: "+C,"e"),null;l&&=aa(l);return C+" "+l}if(C)return C=aa(C)," "+C;e.log("Invalid webRoot: "+C,"e");return null}var z=g,A,E=!0;if("string"===typeof g||Array.isArray(g))z={"*":g};for(A in z)z[A]=x(z[A]),E&&z[A]&&(E=!1);return E?null:z}function h(g,
x,z){g=g.trim();var A={},E=k[0].test(g),I={app:function(F){return F&&"string"===typeof F?this.app=e._setAC(F,{_name:F}):null}},C=/\\/g;z="var __filename='"+(z||"").replace(C,"\\\\")+"',__dirname='"+(x||"").replace(C,"\\\\")+"';";var l;try{if(E){var q=g.match(k[1]);var t=q.length;var y=q.join("").replace(k[2],"");for(l=0;l<t;l++)g=g.replace(q[l],"");var B=z+"try{"+y+"\n}catch(e){return function (R){return R.error('CS AREA A HAS AN ERROR.\\n'+(e.stack||e),'500');};}return "+n+"function (R,tplVals,_get,_post,_cookie,_server){if(!suki.unlocked){return R.error('Server is too busy due to [Critical Error: uncaughtException(see logs)].','500.13');}try{"+
g+"\n}catch(e){R.error('CS AREA B HAS AN ERRROR.\\n'+(e.stack||e),500)};};"}else B=z+"return "+n+"function (R,tplVals,_get,_post,_cookie,_server){if(!suki.unlocked){return R.error('Server is too busy due to [Critical Error: uncaughtException(see logs)].','500.13');}try{"+g+"\n}catch(e){return R.error('CS AREA B HAS AN ERROR.\\n'+(e.stack||e),500);}};";A.cs=(new b("require,suki",B)).bind(I)(d(x),e)}catch(F){A.cs=function(w){w.error("["+e.extention.substring(1)+" init error] "+(F.stack||F),500)}}return A}
function d(g){function x(z){var A=!String(z).isAbs()&&!~z.indexOf("node:")&&(~z.indexOf("/")||~z.indexOf("\\"));return p(A?g+"/"+z:z,T)||p(g+"/"+z,T)}x.cache=T.cache;x.extensions=T.extensions;x.resolve=function(z){var A=!String(z).isAbs()&&!~z.indexOf("node:")&&(~z.indexOf("/")||~z.indexOf("\\"));try{var E=T.resolve(A?g+"/"+z:z)}catch(I){E=""}return E||T.resolve(g+"/"+z)};return x}function p(g,x){x||=T;try{var z=x(g)}catch(A){if(g.isAbs()||~g.indexOf("node:"))e.log("'libExists()' Pre Loading Failed: "+
g,"w"),console.log(A.stack||A)}return z}var c=!1,a={log:function(g){console.log(g)}},b=Object.getPrototypeOf(function(){}).constructor,n="async ";try{eval("(async function(){})")}catch(g){n=""}var k=[RegExp("\\/\\/\\<\\!\\-\\-([\\s\\S]*?)\\/\\/\\-\\-\\>"),RegExp("\\/\\/\\<\\!\\-\\-[\\s\\S]*?\\/\\/\\-\\-\\>","g"),RegExp("\\/\\/\\<\\!\\-\\-|\\/\\/\\-\\-\\>","g")],f,m=[];e.init=function(g){var x;g&&void 0===f&&(f=g);setTimeout(function(){if(T&&f){r(f);f=null;for(x of m)x(e);m.length=0}},0);return function(z){"function"===
typeof z&&m.push(z)}}})();(function(){String.prototype.isAbs=function(){return"/"===this.charAt(0)||"\\"===this.charAt(0)||":"===this.charAt(1)};String.prototype.toContextString=function(){return JSON.stringify([this]).slice(1,-1)};var r=function(u){return"\\"+u};String.prototype.escapeMarkdown=function(u){var v="[\\.\\`\\*\\_\\{\\}\\[\\]\\<\\>\\(\\)\\#\\+\\-\\!\\|\\\\]",h;if(u){u=u.split("");var d=u.length;for(h=0;h<d;h++)v=v.replace("\\"+u[h],"")}return this.replace(new RegExp(v,"g"),r)}})();(function(){function r(c,
a,b){var n=a.replace(/set-cookie/g,"Set-Cookie"),k=encodeURIComponent(c)+"=",f=n.indexOf(k);if(~f){f+=k.length;var m=n.indexOf(";",f);~m||(m=n.length);a=n.substr(m);if(~a.indexOf(k))return r(c,a);try{var g=decodeURIComponent(n.substring(f,m))}catch{return}if(!0===b){m=n.indexOf("Set-Cookie",f);m=~m?m:n.length;a=n.substring(f+g.length,m);c={name:c,value:g};b=a.split(";");g=b.length;for(a=0;a<g;a++)n=b[a].trim(),""!==n&&(k=n.indexOf("="),~k?c[n.substr(0,k)]=n.substr(k+1):c[n]=!0);return c}return g}}
function u(c,a){return"~"+a.toUpperCase()+":"}function v(c,a){return"object"===typeof c?a?c:JSON.stringify(c,h,"\t"):"^"+typeof c+":\\{: "+String(c)}function h(c,a){return v(a,Array.isArray(a)?"^array:\\{: ":"^"+typeof a+":\\{: ")}e.objectToArray=function(c){return Array.prototype.slice.call(c,0)};e.next=new Function("...a","return a");var d=[/\\|%5c/gi,/&(?!\w+;)/g,/</g,/>/g,/"/g,/'/g,/%26/g,/%3c/gi,/%3e/gi,/&#37;22/g,/%/g];e.clean=function(c){if(!c)return 0===c?"0":"";c=String(c).replace(d[0],"").replace(d[1],
"&amp;").replace(d[2],"&lt;").replace(d[3],"&gt;").replace(d[4],"&quot;").replace(d[5],"&#39;");try{var a=decodeURIComponent(c)}catch{return c.replace(d[0],"&#37;5C").replace(d[6],"&#37;26").replace(d[7],"&#37;3C").replace(d[8],"&#37;3E").replace(d[9],"&#37;22")}return c===a?c:c.replace(d[10],"&#37;")};e.passAgentHeaders=function(c){return{accept:"text/html, application/xhtml+xml, */*","accept-language":"zh-CN,zh;q=0.8,en;q=0.6","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87."+
(c?Math.random().toFixed(4):"2883")+".87 Safari/537.36","cache-control":"max-age=0",dnt:"1",connection:"keep-alive"}};e.randomArray=function(c,a,b){return c instanceof Array?(a=a&&b?Math.floor(Math.random()*(b-a+1)+a):Math.floor(Math.random()*c.length),c[a]):null};e.parseCookieHeader=r;e.creatCookieHeader=function(c){var a,b=c.hours;(a=c.expires)?a="; expires="+a:b&&(a=new Date,a.setTime(a.getTime()+Math.floor(36E5*b)),a=a.toUTCString(),a="; expires="+a);return"Set-Cookie: "+c.name+"="+encodeURIComponent(c.value)+
(a||"")+(c.domain&&"; domain="+c.domain||"")+(c.path&&"; path="+c.path||"")+(c.secure&&"; secure"||"")+(c.http&&"; HttpOnly"||"")};e.getIP=function(c,a){var b;if("object"!==typeof c)return"";switch(a){case "real":return c["x-real-ip"]||c["remote-addr"]||"";case "user":return a=(c["x-forwarded-for"]||"").split(","),(b=a.length)?a[b-1].trim():c["remote-addr"]||"";case "proxy":return a=(c["x-forwarded-for"]||"").split(","),a[0]?a[0].trim():c["remote-addr"]||"";default:return c["remote-addr"]||""}};e.log=
function(c,a){switch(a){case "n":e.logfile?e.writeMore(e.logfile,"\r\n[NOTE]"+c+"\r\n"):console.log("\r\n[NOTE]"+c+"\r\n");break;case "w":e.logfile?e.writeMore(e.logfile,"\r\n[WARN]"+c+"\r\n"):console.log("\r\n[WARN]"+c+"\r\n");break;case "e":e.logfile?e.writeMore(e.logfile,"\r\n[ERRO]"+c+"\r\n"):console.log("\r\n[ERRO]"+c+"\r\n");break;case "c":e.logfile?e.writeMore(e.logfile,"\r\n[CRIT]"+c+"\r\n"):console.log("\r\n[CRIT]"+c+"\r\n");break;default:e.logfile?e.writeMore(e.logfile,"\r\n"+c+"\r\n"):
console.log("\r\n"+c+"\r\n")}};var p=[/: "\^([a-z]+):\\\\{:/g,/"(,?)$/gm];e.obj2str=function(c){try{var a="object"===typeof c?v(c).replace(p[0],u).replace(p[1],"$1"):"^"+(typeof c).toUpperCase()+": "+String(c)}catch{return util.inspect(c)}return a};e.parseJSON=function(c,a){try{return JSON.parse(c)}catch{return a||null}};e.signature=function(c,a){var b=(c=String(c)).substr(0,c.indexOf("."));a=a||"";if(64===b.length){var n=c.substr(65);return b===e.sha256(n+e.salt+a)?c:e.sha256(c+e.salt+a)+"."+c}return e.sha256(c+
e.salt+a)+"."+c};e.rewriteURL=function(c){var a=0,b=e.rewriteRules,n=b.length,k=c.indexOf("?"),f=~k?c.substr(k+1):"";for(f&&(c=c.substr(0,k));a<n;a++)if(k=b[a],k=c.replace(k[0],k[1]),k!==c)return k.substr(1)+(f?(~k.indexOf("?")?"&":"?")+f:"");return f?c+"?"+f:c}})();(function(){var r=require("node:fs"),u=require("node:dns");e.dnsTTL=3E5;e.dnsCache={_length:0};e.dnsHosts={};e.dnsInitHosts=function(v){v=Array.isArray(v)?v:r.readFileSync(v).toString("utf8").replace(/[\r\t]/g," ").replace(/[ ]+/g," ").split("\n");
var h=v.length,d=0,p,c,a;if(0<h)for(p=this.dnsHosts={};d<h;d++)if((c=v[d].trim())&&"#"!==c.charAt(0)){c=c.replace(/[ ]+?#.*/g,"").split(" ");var b=c.length;if(1<b)for(a=1;a<b;a++)p[c[a]]=c[0]}return this};e.dnsPurgeCache=function(){this.dnsCache={_length:0};return this};e.dnsLookup4=function(v,h){var d=this.dnsCache,p=this.dnsHosts,c="object"===typeof h;1E3<d._length&&this.dnsPurgeCache();if(p=p[v]||p["*"])if(c)h[0](p);else h(p);else if((p=d[v])&&this.dnsTTL>(new Date).getTime()-p[1])if(c)h[0](p);
else h(p);else u.resolve4(v,function(a,b){a?a=v:(a=b[0],d._length++,d[v]=[a,(new Date).getTime()]);if(c)h[0](a);else h(a)})}})();var Aa=[function(){try{e.sync=new Function("object","methed","next","return (...args)=>new Promise((resolve,reject)=>{var callback=(r,e,E)=>e&&undefined===r?reject(E||e):resolve(r);next&&(next.callback=callback);return 'string'===typeof methed?object[methed](...args,next?undefined:callback):(methed?methed.call(object,...args,next?undefined:callback):object(...args,next?undefined:callback))})"),
e.sync.mute=new Function("object","methed","next","return (...args)=>new Promise(resolve=>{var callback=r=>resolve(r);next&&(next.callback=callback);return 'string'===typeof methed?object[methed](...args,next?undefined:callback):(methed?methed.call(object,...args,next?undefined:callback):object(...args,next?undefined:callback))})")}catch(r){e.sync=null}},function(){var r=e.timeZoneOffset,u=e.timeZoneString,v=/[+\-][0-9]{2}:00$/;e.time=function(){return Math.floor((new Date).getTime()/1E3)+r};e.GMT=
e.UTC=function(h){return void 0===h||-12<h&&12>h?Math.floor((new Date).getTime()/1E3)+3600*(h||0):Date.parse(v.test(String(h).trimRight())?h:h+u)/1E3||0};e.getGMT=e.getUTC=function(h){var d=new Date;h&&d.setTime(d.getTime()+1E3*(Number(h)||0));return d.toUTCString()};e.dateFormat=function(h,d){h||="{YYYY}-{MM}-{dd} {hh}:{mm}:{ss}";d||"string"!==typeof h?("object"===typeof h||(h=new Date(1E3*h)),d||="{YYYY}-{MM}-{dd} {hh}:{mm}:{ss}"):(d=h,h=new Date,h.setTime(h.getTime()+1E3*r));return d.replace("{YYYY}",
h.getUTCFullYear()).replace("{MM}",h.getUTCMonth()+1).replace("{dd}",h.getUTCDate()).replace("{hh}",("0"+h.getUTCHours()).slice(-2)).replace("{mm}",("0"+h.getUTCMinutes()).slice(-2)).replace("{ss}",("0"+h.getUTCSeconds()).slice(-2))};e.timePassed=function(h,d){var p=d?new Date(Number(h+"000")):new Date;h=Math.floor(p.getTime()/1E3)-(d||h);d=Math.floor(h/3600);return 1>d?Math.floor(h/60)+"\u5206\u949f\u524d":24>d?d+"\u5c0f\u65f6\u524d":168>d?(p=60*(60*p.getHours()+p.getMinutes())+p.getSeconds()-(h-
86400*Math.floor(h/86400)),p=Math.floor((h+(0>p?86400+p:p))/86400),1===p?"\u6628\u5929":2===p?"\u524d\u5929":p+"\u5929\u524d"):5040>d?Math.floor(h/604800)+"\u5468\u524d":61320>d?Math.floor(h/2592E3)+"\u4e2a\u6708\u524d":d?Math.floor(h/31536E3)+"\u5e74\u524d":"\u65e5\u671f\u4e0d\u8be6"};e.calendar="".calendar;e.richCalendar="".richCalendar}],Ba=[function(){var r=e.nullFunc,u=require("node:fs"),v=require("node:buffer").Buffer;e.write=function(h,d,p,c){c?u.writeFile(h,"string"===typeof d?v.from(d,c):
d,function(a){var b="object"===typeof p;try{if(b)p[0](a?!1:!0,a);else p(a?!1:!0,a)}catch(n){(a=b&&p.r)?a.error("[file-callback-func-crit]\n"+(n.stack||n),500):e.log("[file-callback-func-crit]\n"+(n.stack||n))}}):p?"object"===typeof p&&p[0]?u.writeFile(h,"string"===typeof d?v.from(d):d,function(a){try{p[0](a?!1:!0,a)}catch(b){p.r?p.r.error("[file-callback-func-crit]\n"+(b.stack||b),500):e.log("[file-callback-func-crit]\n"+(b.stack||b))}}):"function"===typeof p?u.writeFile(h,"string"===typeof d?v.from(d):
d,function(a){try{p(a?!1:!0,a)}catch(b){e.log("[file-callback-func-crit]\n"+(b.stack||b))}}):u.writeFile(h,"string"===typeof d?v.from(d,p):d,r):u.writeFile(h,"string"===typeof d?v.from(d):d,r)};e.read=function(h,d,p){u.readFile(h,function(c,a){var b="object"===typeof d;try{if(b)d[0](c?void 0:p?a.toString(p):a,c);else d(c?void 0:p?a.toString(p):a,c)}catch(n){(c=b&&d.r)&&c.error("[file-callback-func-crit]\n"+(n.stack||n),500)}})};e.writeMore=function(h,d,p,c){c?u.appendFile(h,"string"===typeof d?v.from(d,
c):d,function(a){var b="object"===typeof p;try{if(b)p[0](a?!1:!0,a);else p(a?!1:!0,a)}catch(n){(a=b&&p.r)?a.error("[file-callback-func-crit]\n"+(n.stack||n),500):e.log("[file-callback-func-crit]\n"+(n.stack||n))}}):p?"object"===typeof p&&p[0]?u.appendFile(h,"string"===typeof d?v.from(d):d,function(a){try{p[0](a?!1:!0,a)}catch(b){p.r?p.r.error("[file-callback-func-crit]\n"+(b.stack||b),500):e.log("[file-callback-func-crit]\n"+(b.stack||b))}}):"function"===typeof p?u.appendFile(h,"string"===typeof d?
v.from(d):d,function(a){try{p(a?!1:!0,a)}catch(b){e.log("[file-callback-func-crit]\n"+(b.stack||b))}}):u.appendFile(h,"string"===typeof d?v.from(d,p):d,r):u.appendFile(h,"string"===typeof d?v.from(d):d,r)};e.delete=function(h,d){u.unlink(h,function(p){var c="object"===typeof d;try{if(c)d[0](p?!1:!0,p);else"function"===typeof d&&d(p?!1:!0,p)}catch(a){(p=c&&d.r)?p.error("[file-callback-func-crit]\n"+(a.stack||a),500):e.log("[file-callback-func-crit]\n"+(a.stack||a))}})}},function(){function r(b,n,k,
f){var m=!1,g,x,z,A;if(this[0]===r){var E=this[1];E.hostname=b;b=E;n=this[2];k=this[3];f=this[4]}E="https"===b.protocol.substr(0,5)?h:v;var I=(A=n&&"function"===typeof n[0])||"function"===typeof n;var C=b.host;var l=C.indexOf(":");C=~l?C.substr(0,l):C;b.path||(b.path=b.pathname+(b.search||""));b.host=b.hostname;b.hostname=C;I?(l="object"===typeof k,f||!l&&(f=k),k=l&&k||e.passAgentHeaders()):k="object"===typeof n&&n||e.passAgentHeaders();I&&"identity"!==k["accept-encoding"]&&(k["accept-encoding"]=
"gzip, deflate");k.host||(k.host=C);b.headers=k;b=E.request(b,function(w){var D=w;if(g)if(y)if(200!=w.statusCode)y(404);else{D=g;var H=x;var L=z,J=L[2],M="1.1"===J,K=w.headers,U=H.hasOwnProperty("charset"),O=K["content-type"].split(";"),N=K["content-length"],Q=(new Date).toUTCString();H._mtime=e.UTC(Q);H.hasOwnProperty("contentType")||(H.contentType=O[0].trim());!U&&O[1]&&(H.charset=O[1].trim());H.hasOwnProperty("status")||(H.status=200);try{D.write("HTTP/"+J+" "+H.status+"\r\nDate: "+Q+"\r\nContent-Type: "+
H.contentType+(U?"; charset="+H.charset:"")+(N?"\r\nContent-Length: "+K["content-length"]:"")+"\r\nAccept-Ranges: none\r\nCache-Control: max-age=864000\r\nExpires: "+e.getGMT(864E3)+"\r\nLast-Modified: "+Q+"\r\nServer: "+e.server+L[1]+"\r\nConnection: "+(M&&"keep-alive"||"close")+"\r\n\r\n")}catch(R){console.log("suki.get: proxyCache error\n"+(R.stack||R))}y("length",Number(w.headers["content-length"]));w.on("data",B);w.on("end",y)}else u(w,g,x,z),w.on("data",B);else I&&("gzip"===w.headers["content-encoding"]?
(H=p.createGunzip(),H.on("error",q),w.pipe(H),w=H):"deflate"===w.headers["content-encoding"]&&(H=p.createInflate(),H.on("error",q),w.pipe(H),w=H),f&&w.setEncoding(f),w.on("data",B)),y&&(y.res=D,w.on("end",y))});var q=function(w){var D;if(m)g&&(y?(y(404),console.log(w)):(w=x,w._r=z,w.error("proxy: destination network unreachable.",404)));else try{if(A)n[0](void 0,w.stack||w);else n(void 0,w.stack||w)}catch(H){(D=A&&n.r)?D.error("[get-_callback-func-crit]\n"+(H.stack||H),500):e.log("[get-_callback-func-crit]\n"+
(H.stack||H),"e")}m=!0};b.on("error",q);if(I){var t="";var y=function(){if(!m){var w=y.res;w[200==w.statusCode?"data":"errorData"]=t;try{if(A)n[0](w);else n(w)}catch(D){(w=A&&n.r)?w.error("[get-_callback-func-crit]\n"+(D.stack||D),500):e.log("[get-_callback-func-crit]\n"+(D.stack||D),"e")}}m=!0};var B=function(w){"string"===typeof w?t+=w:t=t?a.concat([t,w]):w}}else{var F=function(w){g=w._r[0];x=w;z=w._r;B=F.ed;w._file&&(y=F.ee);return!0};m=!0}b.end();return F}function u(b,n,k,f){var m=f[2],g="1.1"===
m,x=b.headers,z=k.hasOwnProperty("charset"),A=x["content-type"].split(";"),E=x["content-length"],I=!E,C=x["set-cookie"],l=x.location,q=x["content-encoding"],t=x["cache-control:"],y=x.etag,B=x.expires;k.hasOwnProperty("contentType")||(k.contentType=A[0].trim());!z&&A[1]&&(k.charset=A[1].trim());k.hasOwnProperty("status")||(k.status=b.statusCode);if(I)b.on("end",function(){n.end()});try{n.write("HTTP/"+m+" "+k.status+"\r\nDate: "+(x.date||(new Date).toUTCString())+"\r\nContent-Type: "+k.contentType+
(z?"; charset="+k.charset:"")+(I?"":"\r\nContent-Length: "+E)+(l?"\r\nLocation: "+l:"")+(q?"\r\nContent-Encoding: "+q:"")+(C?"\r\nSet-Cookie: "+(Array.isArray(C)?C.join(""):C):"")+(t||"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache")+(y?y:"")+(B?B:"")+"\r\nServer: "+(x.server||e.server)+f[1]+"\r\nConnection: "+(g&&"keep-alive"||"close")+"\r\n\r\n")}catch(F){console.log("suki.get: proxy error\n"+(F.stack||F))}}var v=require("node:http"),h=require("node:https"),
d=require("node:url"),p=require("node:zlib"),c,a=require("node:buffer").Buffer;v.globalAgent&&(v.globalAgent.maxSockets=h.globalAgent.maxSockets=Infinity,h.globalAgent.options.rejectUnauthorized=!1);e.get=c=function(b,n,k,f){var m=d.parse(b);b=String(m.hostname||m.host&&m.host.split(":")[0]||"");var g,x;if(!b)throw"suki.get: invalid hostname";if(/^[0-9.]+$/.test(b)||~b.indexOf("["))return r(m,n,k,f);if((x=(g=e.dnsCache[b])&&g[0])&&e.dnsTTL>(new Date).getTime()-g[1])return m.hostname=x,r(m,n,k,f);
n=e.next(r,m,n,k,f);e.dnsLookup4(b,n);return n};c.async=function(b,n,k){c(b,k,n)}},function(){function r(f,m,g,x,z){this[0]===r&&(m=this[1],m.hostname=f,f=m,m=this[2],g=this[3],x=this[4],z=this[5]);m||="__=";var A="https"===f.protocol.substr(0,5),E=g&&"function"===typeof g[0],I=E||"function"===typeof g;A=A?h:v;var C=!1,l="object"===typeof m,q=l&&"------WebKitFormBoundary"+e.random(16),t=q?q+"--\r\n":"",y=f.host;var B=y.indexOf(":");y=~B?y.substr(0,B):y;f.path||(f.path=f.pathname+(f.search||""));f.host=
f.hostname;f.hostname=y;I?(B="object"===typeof x,z||!B&&(z=x),x=B&&x||e.passAgentHeaders()):x="object"===typeof g&&g||e.passAgentHeaders();x["content-type"]=l?"multipart/form-data; boundary="+q.substr(2):"{"===m.charAt(0)||"["===m.charAt(0)?"application/json":"application/x-www-form-urlencoded";x.host||(x.host=y);if(l){var F="",w=0,D=[],H=[];B=null;var L=0,J,M=function(G){"isBuffer"===G?K.write(D[L]):D[L].unpipe(K);++L<D.length?(K.write("\r\n"+H[L]),k.isBuffer(D[L])?M("isBuffer"):D[L].pipe(K,a)):
K.end("\r\n"+t)};for(J in m)y=m[J],"string"===typeof y?F+=q+'\r\nContent-Disposition: form-data; name="'+J+'"\r\n\r\n'+y+"\r\n":Array.isArray(y)?F+=q+'\r\nContent-Disposition: form-data; name="'+J+'[]"\r\n\r\n'+y.join("\r\n"+q+'\r\nContent-Disposition: form-data; name="'+J+'[]"\r\n\r\n')+"\r\n":"object"===typeof y&&(k.isBuffer(y.raw)?(D.push(y.raw),B=q+'\r\nContent-Disposition: form-data; name="'+J+'"; filename="'+(y.name||J)+'"\r\n\r\n',H.push(B),w+=k.byteLength(B)+y.raw.byteLength+1):y.tmp_name&&
(B=d.createReadStream(y.tmp_name,b),B.on("end",M),D.push(B),B=q+'\r\nContent-Disposition: form-data; name="'+J+'"; filename="'+(y.name||J)+'"\r\n\r\n',H.push(B),w+=k.byteLength(B)+y.size+1));w+=k.byteLength(F)+t.length}x["content-length"]=l?w:k.byteLength(m);I&&"identity"!==x["accept-encoding"]&&(x["accept-encoding"]="gzip, deflate");f.headers=x;f.method="POST";var K=A.request(f,function(G){var S=G;if(R)N?N(404):(u(G,R,P,V),G.on("data",Q));else{if(I){if("gzip"===G.headers["content-encoding"]){var X=
c.createGunzip();X.on("error",U);G.pipe(X);G=X}else"deflate"===G.headers["content-encoding"]&&(X=c.createInflate(),X.on("error",U),G.pipe(X),G=X);z&&G.setEncoding(z);G.on("data",Q)}N&&(N.res=S,G.on("end",N))}});var U=function(G){if(C)R&&(N?N(404):(G=P,G._r=V,G.error("proxy: destination network unreachable.",404)));else try{if(E)g[0](void 0,G.stack||G);else g(void 0,G.stack||G)}catch(S){(G=E&&g.r)?G.error("[post-_callback-func-crit]\n"+(S.stack||S),500):e.log("[post-_callback-func-crit]\n"+(S.stack||
S),"e")}C=!0};K.on("error",U);if(I){var O="";var N=function(){if(!C){var G=N.res;G[200==G.statusCode?"data":"errorData"]=O;try{if(E)g[0](G);else g(G)}catch(S){(G=E&&g.r)?G.error("[post-_callback-func-crit]\n"+(S.stack||S),500):e.log("[post-_callback-func-crit]\n"+(S.stack||S),"e")}}C=!0};var Q=function(G){"string"===typeof G?O+=G:O=O?k.concat([O,G]):G}}else{var R,P,V,ea=function(G){G._file?(G=ea,Q=G.ed,N=G.ee,R=!0):(R=G._r[0],P=G,V=G._r,Q=ea.ed);return!0};C=!0}if(l)return K.write(F),D.length?(K.write(H[0]),
k.isBuffer(D[0])?M("isBuffer"):D[0].pipe(K,a)):K.end(t),ea;K.write(m);K.end();return ea}function u(f,m,g,x){var z=x[2],A="1.1"===z,E=f.headers,I=g.hasOwnProperty("charset"),C=E["content-type"].split(";"),l=E["content-length"],q=!l,t=E["set-cookie"],y=E.location,B=E["content-encoding"];g.hasOwnProperty("contentType")||(g.contentType=C[0].trim());!I&&C[1]&&(g.charset=C[1].trim());g.hasOwnProperty("status")||(g.status=f.statusCode);if(!g._file){if(q)f.on("end",function(){m.end()});try{m.write("HTTP/"+
z+" "+g.status+"\r\nDate: "+(E.date||(new Date).toUTCString())+"\r\nContent-Type: "+g.contentType+(I?"; charset="+g.charset:"")+(q?"":"\r\nContent-Length: "+l)+(y?"\r\nLocation: "+y:"")+(B?"\r\nContent-Encoding: "+B:"")+(t?"\r\nSet-Cookie: "+(Array.isArray(t)?t.join(""):t):"")+"\r\nCache-Control: must-revalidate, no-cache, private\r\nExpires: -1\r\nPragma: no-cache\r\nServer: "+(E.server||"Node.js")+x[1]+"\r\nConnection: "+(A&&"keep-alive"||"close")+"\r\n\r\n")}catch(F){console.log("suki.get: proxy error\n"+
(F.stack||F))}}}var v=require("node:http"),h=require("node:https"),d=require("node:fs"),p=require("node:url"),c=require("node:zlib"),a={end:!1},b={flags:"r",encoding:null,fd:null,mode:438},n,k=require("node:buffer").Buffer;v.globalAgent&&(v.globalAgent.maxSockets=h.globalAgent.maxSockets=Infinity,h.globalAgent.options.rejectUnauthorized=!1);e.post=n=function(f,m,g,x,z){var A=p.parse(f);f=String(A.hostname||A.host&&A.host.split(":")[0]||"");var E,I;if(!f)throw"suki.get: invalid hostname";if(/^[0-9.]+$/.test(f)||
~f.indexOf("["))return r(A,m,g,x,z);if((I=(E=e.dnsCache[f])&&E[0])&&e.dnsTTL>(new Date).getTime()-E[1])return A.hostname=I,r(A,m,g,x,z);if(f)return m=e.next(r,A,m,g,x,z),e.dnsLookup4(f,m),m};n.async=function(f,m,g,x){n(f,m,x,g)}}]})(suki,node_modules);
